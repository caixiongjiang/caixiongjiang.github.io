<!DOCTYPE html>
<html><head>
<title>Docker快速入门</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="目前因为虚拟机的高消耗资源的特性，然后VM Fusion还不太适配M1系列的芯片，所以入门一下容器技术，用来平替。">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="Docker快速入门" />
<meta property="og:description" content="目前因为虚拟机的高消耗资源的特性，然后VM Fusion还不太适配M1系列的芯片，所以入门一下容器技术，用来平替。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://caixiongjiang.github.io/blog/2022/docker%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2022-06-24T18:18:05+08:00" />
<meta property="article:modified_time" content="2022-06-24T18:19:06+08:00" />











<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">
<script src="/vendor/js/vue.min.js" ></script>


  




<link rel="icon" href="https://blog-1311257248.cos.ap-nanjing.myqcloud.com/imgs/avater.jfif">



<link rel="stylesheet" href="https://caixiongjiang.github.io/scss/journal.min.3f72a5fc8f5b5dd732a4b476aced0eece2156958d9d414316494ddb10593ddf7.css" integrity="sha256-P3Kl/I9bXdcypLR2rO0O7OIVaVjZ1BQxZJTdsQWT3fc=" media="screen">



<link rel="stylesheet" href="https://caixiongjiang.github.io/scss/dark-mode.min.c0082f0b082177f6fb3768ff91439a097de49689bd26f4d49f76d94ebb81e02d.css" integrity="sha256-wAgvCwghd/b7N2j/kUOaCX3klom9JvTUn3bZTruB4C0=" media="screen">


<script src="/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");
</script>


  
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script"
async
src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style>





  
    <script src="/js/toc.js"></script>
  











<script src="https://cdn.jsdelivr.net/npm/twikoo@1.5.11/dist/twikoo.all.min.js"></script>




</head>
<body>
    	<div id="app"><div ref="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://caixiongjiang.github.io/">
    
        <div class="nav-title">
            🌀Jarson Cai&#39;s Blog
        </div>
        
        <div class="nav-subtitle">
            头脑是日用品，不是装饰品
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/blog">
                文章📖
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                分类📌
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                标签🏷️
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/series">
                系列📚
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/archive">
                归档📃
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/about">
                关于👋
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/friends">
                友链🔗
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                RSS📢
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
<a href="https://github.com/caixiongjiang">
    GitHub
</a>
<br>

<a href="mailto:nau_cxj@163.com">
    Email
</a>
<br>

<a href="https://leetcode-cn.com/u/cai-xiong-jiang/">
    Leetcode
</a>
<br>

        <hr>
        
魔改自 <a href="https://github.com/riba2534/hugo-blog">Riba2534</a> by <a href="https://caixiongjiang.github.io">Jarson Cai</a>
<br>

&copy;
	
	2024 🌀Jarson Cai&#39;s Blog
	
    </div>
    
</div><div ref="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#docker%e4%b8%80%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8" onclick="onNavClick(`#docker一小时快速入门-nav`)" id="docker一小时快速入门-nav">
									Docker一小时快速入门
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#docker%e7%ae%80%e4%bb%8b%e5%92%8c%e5%ae%89%e8%a3%85" onclick="onNavClick(`#docker简介和安装-nav`)" id="docker简介和安装-nav">
									Docker简介和安装
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#docker-%e5%bc%80%e5%8f%91%e9%83%a8%e7%bd%b2%e6%b5%81%e7%a8%8b" onclick="onNavClick(`#docker-开发部署流程-nav`)" id="docker-开发部署流程-nav">
									Docker 开发部署流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#docker%e9%80%9a%e5%b8%b8%e6%9d%a5%e5%81%9a%e4%bb%80%e4%b9%88" onclick="onNavClick(`#docker通常来做什么-nav`)" id="docker通常来做什么-nav">
									Docker通常来做什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e9%87%8d%e8%a6%81%e6%a6%82%e5%bf%b5%e9%95%9c%e5%83%8f%e5%ae%b9%e5%99%a8" onclick="onNavClick(`#重要概念镜像容器-nav`)" id="重要概念镜像容器-nav">
									重要概念：镜像、容器
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85" onclick="onNavClick(`#安装-nav`)" id="安装-nav">
									安装
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e9%95%9c%e5%83%8f%e5%8a%a0%e9%80%9f%e6%ba%90" onclick="onNavClick(`#镜像加速源-nav`)" id="镜像加速源-nav">
									镜像加速源
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#docker%e5%bf%ab%e9%80%9f%e5%ae%89%e8%a3%85%e8%bd%af%e4%bb%b6" onclick="onNavClick(`#docker快速安装软件-nav`)" id="docker快速安装软件-nav">
									Docker快速安装软件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#docker%e5%ae%89%e8%a3%85%e7%9a%84%e4%bc%98%e7%82%b9" onclick="onNavClick(`#docker安装的优点-nav`)" id="docker安装的优点-nav">
									Docker安装的优点
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%bc%94%e7%a4%badocker%e5%ae%89%e8%a3%85redis" onclick="onNavClick(`#演示docker安装redis-nav`)" id="演示docker安装redis-nav">
									演示Docker安装Redis
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%88%b6%e4%bd%9c%e8%87%aa%e5%b7%b1%e7%9a%84%e9%95%9c%e5%83%8f" onclick="onNavClick(`#制作自己的镜像-nav`)" id="制作自己的镜像-nav">
									制作自己的镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8bweb%e9%a1%b9%e7%9b%ae%e6%9e%84%e5%bb%ba%e9%95%9c%e5%83%8f" onclick="onNavClick(`#使用示例web项目构建镜像-nav`)" id="使用示例web项目构建镜像-nav">
									使用示例Web项目构建镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bc%96%e5%86%99dockerfile" onclick="onNavClick(`#编写dockerfile-nav`)" id="编写dockerfile-nav">
									编写Dockerfile
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#build%e4%b8%ba%e9%95%9c%e5%83%8f%e5%ae%89%e8%a3%85%e5%8c%85%e5%92%8c%e8%bf%90%e8%a1%8c" onclick="onNavClick(`#build为镜像安装包和运行-nav`)" id="build为镜像安装包和运行-nav">
									Build为镜像（安装包）和运行
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%9b%b4%e5%a4%9a%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4" onclick="onNavClick(`#更多相关命令-nav`)" id="更多相关命令-nav">
									更多相关命令
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%9b%ae%e5%bd%95%e6%8c%82%e8%bd%bd" onclick="onNavClick(`#目录挂载-nav`)" id="目录挂载-nav">
									目录挂载
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%8e%b0%e5%ad%98%e9%97%ae%e9%a2%98" onclick="onNavClick(`#现存问题-nav`)" id="现存问题-nav">
									现存问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%87%a0%e7%a7%8d%e6%8c%82%e8%bd%bd%e6%96%b9%e5%bc%8f" onclick="onNavClick(`#几种挂载方式-nav`)" id="几种挂载方式-nav">
									几种挂载方式
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%8c%82%e8%bd%bd%e6%bc%94%e7%a4%ba" onclick="onNavClick(`#挂载演示-nav`)" id="挂载演示-nav">
									挂载演示
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%a4%9a%e5%ae%b9%e5%99%a8%e9%80%9a%e4%bf%a1" onclick="onNavClick(`#多容器通信-nav`)" id="多容器通信-nav">
									多容器通信
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ad%a6%e4%b9%a0%e7%9b%ae%e6%a0%87" onclick="onNavClick(`#学习目标-nav`)" id="学习目标-nav">
									学习目标
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%9b%e5%bb%ba%e8%99%9a%e6%8b%9f%e7%bd%91%e7%bb%9c" onclick="onNavClick(`#创建虚拟网络-nav`)" id="创建虚拟网络-nav">
									创建虚拟网络
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%bc%94%e7%a4%ba" onclick="onNavClick(`#演示-nav`)" id="演示-nav">
									演示
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#docker-compose" onclick="onNavClick(`#docker-compose-nav`)" id="docker-compose-nav">
									Docker-Compose
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%8e%b0%e5%ad%98%e9%97%ae%e9%a2%98-1" onclick="onNavClick(`#现存问题-1-nav`)" id="现存问题-1-nav">
									现存问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85docker-compose" onclick="onNavClick(`#安装docker-compose-nav`)" id="安装docker-compose-nav">
									安装Docker Compose
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bc%96%e5%86%99%e8%84%9a%e6%9c%ac" onclick="onNavClick(`#编写脚本-nav`)" id="编写脚本-nav">
									编写脚本
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#run" onclick="onNavClick(`#run-nav`)" id="run-nav">
									RUN
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%8f%91%e5%b8%83%e5%92%8c%e9%83%a8%e7%bd%b2" onclick="onNavClick(`#发布和部署-nav`)" id="发布和部署-nav">
									发布和部署
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e9%95%9c%e5%83%8f%e4%bb%93%e5%ba%93%e4%bb%8b%e7%bb%8d" onclick="onNavClick(`#镜像仓库介绍-nav`)" id="镜像仓库介绍-nav">
									镜像仓库介绍
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%b8%8a%e4%bc%a0%e9%95%9c%e5%83%8f" onclick="onNavClick(`#上传镜像-nav`)" id="上传镜像-nav">
									上传镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%a4%87%e4%bb%bd%e5%92%8c%e8%bf%81%e7%a7%bb" onclick="onNavClick(`#备份和迁移-nav`)" id="备份和迁移-nav">
									备份和迁移
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%a4%87%e4%bb%bd%e5%92%8c%e5%af%bc%e5%85%a5-volume-%e7%9a%84%e6%b5%81%e7%a8%8b" onclick="onNavClick(`#备份和导入-volume-的流程-nav`)" id="备份和导入-volume-的流程-nav">
									备份和导入 Volume 的流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%a4%87%e4%bb%bd-mongodb-%e6%95%b0%e6%8d%ae%e6%bc%94%e7%a4%ba" onclick="onNavClick(`#备份-mongodb-数据演示-nav`)" id="备份-mongodb-数据演示-nav">
									备份 MongoDB 数据演示
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%81%a2%e5%a4%8d-volume-%e6%95%b0%e6%8d%ae%e6%bc%94%e7%a4%ba" onclick="onNavClick(`#恢复-volume-数据演示-nav`)" id="恢复-volume-数据演示-nav">
									恢复 Volume 数据演示
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a class="pagination-action" v-on:click="toggleDarkMode">
            <i class="material-icons pagination-action-icon" v-if="isDarkMode">
                brightness_4
            </i>
            <i class="material-icons pagination-action-icon" v-else="isDarkMode">
                brightness_7
            </i>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/blog">
                    文章📖
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    分类📌
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    标签🏷️
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/series">
                    系列📚
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/archive">
                    归档📃
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/about">
                    关于👋
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/friends">
                    友链🔗
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    RSS📢
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#docker%e4%b8%80%e5%b0%8f%e6%97%b6%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8" onclick="onNavClick(`#docker一小时快速入门-nav`)" id="docker一小时快速入门-nav">
									Docker一小时快速入门
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#docker%e7%ae%80%e4%bb%8b%e5%92%8c%e5%ae%89%e8%a3%85" onclick="onNavClick(`#docker简介和安装-nav`)" id="docker简介和安装-nav">
									Docker简介和安装
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#docker-%e5%bc%80%e5%8f%91%e9%83%a8%e7%bd%b2%e6%b5%81%e7%a8%8b" onclick="onNavClick(`#docker-开发部署流程-nav`)" id="docker-开发部署流程-nav">
									Docker 开发部署流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#docker%e9%80%9a%e5%b8%b8%e6%9d%a5%e5%81%9a%e4%bb%80%e4%b9%88" onclick="onNavClick(`#docker通常来做什么-nav`)" id="docker通常来做什么-nav">
									Docker通常来做什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e9%87%8d%e8%a6%81%e6%a6%82%e5%bf%b5%e9%95%9c%e5%83%8f%e5%ae%b9%e5%99%a8" onclick="onNavClick(`#重要概念镜像容器-nav`)" id="重要概念镜像容器-nav">
									重要概念：镜像、容器
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85" onclick="onNavClick(`#安装-nav`)" id="安装-nav">
									安装
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e9%95%9c%e5%83%8f%e5%8a%a0%e9%80%9f%e6%ba%90" onclick="onNavClick(`#镜像加速源-nav`)" id="镜像加速源-nav">
									镜像加速源
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#docker%e5%bf%ab%e9%80%9f%e5%ae%89%e8%a3%85%e8%bd%af%e4%bb%b6" onclick="onNavClick(`#docker快速安装软件-nav`)" id="docker快速安装软件-nav">
									Docker快速安装软件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#docker%e5%ae%89%e8%a3%85%e7%9a%84%e4%bc%98%e7%82%b9" onclick="onNavClick(`#docker安装的优点-nav`)" id="docker安装的优点-nav">
									Docker安装的优点
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%bc%94%e7%a4%badocker%e5%ae%89%e8%a3%85redis" onclick="onNavClick(`#演示docker安装redis-nav`)" id="演示docker安装redis-nav">
									演示Docker安装Redis
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%88%b6%e4%bd%9c%e8%87%aa%e5%b7%b1%e7%9a%84%e9%95%9c%e5%83%8f" onclick="onNavClick(`#制作自己的镜像-nav`)" id="制作自己的镜像-nav">
									制作自己的镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8bweb%e9%a1%b9%e7%9b%ae%e6%9e%84%e5%bb%ba%e9%95%9c%e5%83%8f" onclick="onNavClick(`#使用示例web项目构建镜像-nav`)" id="使用示例web项目构建镜像-nav">
									使用示例Web项目构建镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bc%96%e5%86%99dockerfile" onclick="onNavClick(`#编写dockerfile-nav`)" id="编写dockerfile-nav">
									编写Dockerfile
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#build%e4%b8%ba%e9%95%9c%e5%83%8f%e5%ae%89%e8%a3%85%e5%8c%85%e5%92%8c%e8%bf%90%e8%a1%8c" onclick="onNavClick(`#build为镜像安装包和运行-nav`)" id="build为镜像安装包和运行-nav">
									Build为镜像（安装包）和运行
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%9b%b4%e5%a4%9a%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4" onclick="onNavClick(`#更多相关命令-nav`)" id="更多相关命令-nav">
									更多相关命令
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%9b%ae%e5%bd%95%e6%8c%82%e8%bd%bd" onclick="onNavClick(`#目录挂载-nav`)" id="目录挂载-nav">
									目录挂载
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%8e%b0%e5%ad%98%e9%97%ae%e9%a2%98" onclick="onNavClick(`#现存问题-nav`)" id="现存问题-nav">
									现存问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%87%a0%e7%a7%8d%e6%8c%82%e8%bd%bd%e6%96%b9%e5%bc%8f" onclick="onNavClick(`#几种挂载方式-nav`)" id="几种挂载方式-nav">
									几种挂载方式
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%8c%82%e8%bd%bd%e6%bc%94%e7%a4%ba" onclick="onNavClick(`#挂载演示-nav`)" id="挂载演示-nav">
									挂载演示
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%a4%9a%e5%ae%b9%e5%99%a8%e9%80%9a%e4%bf%a1" onclick="onNavClick(`#多容器通信-nav`)" id="多容器通信-nav">
									多容器通信
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ad%a6%e4%b9%a0%e7%9b%ae%e6%a0%87" onclick="onNavClick(`#学习目标-nav`)" id="学习目标-nav">
									学习目标
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%9b%e5%bb%ba%e8%99%9a%e6%8b%9f%e7%bd%91%e7%bb%9c" onclick="onNavClick(`#创建虚拟网络-nav`)" id="创建虚拟网络-nav">
									创建虚拟网络
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%bc%94%e7%a4%ba" onclick="onNavClick(`#演示-nav`)" id="演示-nav">
									演示
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#docker-compose" onclick="onNavClick(`#docker-compose-nav`)" id="docker-compose-nav">
									Docker-Compose
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%8e%b0%e5%ad%98%e9%97%ae%e9%a2%98-1" onclick="onNavClick(`#现存问题-1-nav`)" id="现存问题-1-nav">
									现存问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%85docker-compose" onclick="onNavClick(`#安装docker-compose-nav`)" id="安装docker-compose-nav">
									安装Docker Compose
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bc%96%e5%86%99%e8%84%9a%e6%9c%ac" onclick="onNavClick(`#编写脚本-nav`)" id="编写脚本-nav">
									编写脚本
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#run" onclick="onNavClick(`#run-nav`)" id="run-nav">
									RUN
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%8f%91%e5%b8%83%e5%92%8c%e9%83%a8%e7%bd%b2" onclick="onNavClick(`#发布和部署-nav`)" id="发布和部署-nav">
									发布和部署
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e9%95%9c%e5%83%8f%e4%bb%93%e5%ba%93%e4%bb%8b%e7%bb%8d" onclick="onNavClick(`#镜像仓库介绍-nav`)" id="镜像仓库介绍-nav">
									镜像仓库介绍
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%b8%8a%e4%bc%a0%e9%95%9c%e5%83%8f" onclick="onNavClick(`#上传镜像-nav`)" id="上传镜像-nav">
									上传镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%a4%87%e4%bb%bd%e5%92%8c%e8%bf%81%e7%a7%bb" onclick="onNavClick(`#备份和迁移-nav`)" id="备份和迁移-nav">
									备份和迁移
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%a4%87%e4%bb%bd%e5%92%8c%e5%af%bc%e5%85%a5-volume-%e7%9a%84%e6%b5%81%e7%a8%8b" onclick="onNavClick(`#备份和导入-volume-的流程-nav`)" id="备份和导入-volume-的流程-nav">
									备份和导入 Volume 的流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%a4%87%e4%bb%bd-mongodb-%e6%95%b0%e6%8d%ae%e6%bc%94%e7%a4%ba" onclick="onNavClick(`#备份-mongodb-数据演示-nav`)" id="备份-mongodb-数据演示-nav">
									备份 MongoDB 数据演示
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%81%a2%e5%a4%8d-volume-%e6%95%b0%e6%8d%ae%e6%bc%94%e7%a4%ba" onclick="onNavClick(`#恢复-volume-数据演示-nav`)" id="恢复-volume-数据演示-nav">
									恢复 Volume 数据演示
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="https://caixiongjiang.github.io/">
            🌀Jarson Cai&#39;s Blog
        </a>
        
        <button type="button" class="nav-darkmode-toggle" v-on:click="toggleDarkMode">
            <i class="material-icons" v-if="isDarkMode">
                brightness_4
            </i>
            <i class="material-icons" v-else="isDarkMode">
                brightness_7
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://caixiongjiang.github.io/">
        <div class="single-column-header-title">🌀Jarson Cai&#39;s Blog</div>
        
        <div class="single-column-header-subtitle">头脑是日用品，不是装饰品</div>
        

    </a>
</div>

            <div id="content">
<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://blog-1311257248.cos.ap-nanjing.myqcloud.com/imgs/docker/img_title.jpg')"
                    
                
            >
                <div class="post-title">
                    Docker快速入门
                    
                    <div class="post-subtitle">
                        目前因为虚拟机的高消耗资源的特性，然后VM Fusion还不太适配M1系列的芯片，所以入门一下容器技术，用来平替。
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2022-06-24 18:18
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/">[容器技术]</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/docker">Docker</a>
                                &nbsp;
                            
                        
                        
                            <i class="material-icons" style="">schedule</i>
                            

                            
                            

                            
                            18 min
                            
                            9 s.
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h2 id="docker一小时快速入门">Docker一小时快速入门</h2>
<h3 id="docker简介和安装">Docker简介和安装</h3>
<h4 id="docker-开发部署流程">Docker 开发部署流程</h4>
<p>自己在 Windows/Mac 上开发、测试 &ndash;&gt; 打包为 Docker 镜像（可以理解为软件安装包） &ndash;&gt; 各种服务器上只需要一个命令部署好。</p>
<blockquote>
<p>优点:确保了不同机器上跑起来都是一致的运行环境，不会出现不同机器之间切换出现bug的问题。</p>
</blockquote>
<h4 id="docker通常来做什么">Docker通常来做什么</h4>
<ul>
<li>应用分发、部署，方便传播给他人安装。特别是开源软件和提供私有部署的应用</li>
<li>快速安装测试/学习软件，用完就丢（类似小程序），不把时间浪费在安装软件上。例如 Redis / MongoDB / ElasticSearch / ELK</li>
<li>多个版本软件共存，不污染系统，例如 Python2、Python3，Redis4.0，Redis5.0</li>
<li>Windows/mac上体验/学习各种 Linux 系统</li>
</ul>
<h4 id="重要概念镜像容器">重要概念：镜像、容器</h4>
<p>镜像：可以理解为软件安装包，可以方便进行传播和安装</p>
<p>容器：软件安装后的状态，每个软件运行环境都是独立的、隔离的、称之为容器</p>
<h4 id="安装">安装</h4>
<p>桌面版：<a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a></p>
<p>mac版安装无障碍，Windows版安装还挺麻烦的，可以看一下这个<a href="https://docker.easydoc.net/doc/81170005/cCewZWoN/lTKfePfP#nav_6">在线文档</a></p>
<p>服务器版：<a href="https://docs.docker.com/engine/install/#server">https://docs.docker.com/engine/install/#server</a></p>
<h4 id="镜像加速源">镜像加速源</h4>
<table>
<thead>
<tr>
<th>镜像加速源</th>
<th>镜像加速器地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>Docker 中国官方镜像</td>
<td><a href="https://registry.docker-cn.com">https://registry.docker-cn.com</a></td>
</tr>
<tr>
<td>DaoCloud 镜像站</td>
<td><a href="http://f1361db2.m.daocloud.io">http://f1361db2.m.daocloud.io</a></td>
</tr>
<tr>
<td>Azure 中国镜像</td>
<td><a href="https://dockerhub.azk8s.cn">https://dockerhub.azk8s.cn</a></td>
</tr>
<tr>
<td>科大镜像站</td>
<td><a href="https://docker.mirrors.ustc.edu.cn">https://docker.mirrors.ustc.edu.cn</a></td>
</tr>
<tr>
<td>阿里云</td>
<td>https://&lt;your_code&gt;.mirror.aliyuncs.com</td>
</tr>
<tr>
<td>七牛云</td>
<td><a href="https://reg-mirror.qiniu.com">https://reg-mirror.qiniu.com</a></td>
</tr>
<tr>
<td>网易云</td>
<td><a href="https://hub-mirror.c.163.com">https://hub-mirror.c.163.com</a></td>
</tr>
<tr>
<td>腾讯云</td>
<td><a href="https://mirror.ccs.tencentyun.com">https://mirror.ccs.tencentyun.com</a></td>
</tr>
</tbody>
</table>
<blockquote>
<p>我配置的是阿里云的镜像源，不过阿里云的镜像源需要自己配置一个账号，也可以配置其他的镜像源。</p>
</blockquote>
<p>配置方法如下，在<code>Docker Desktop</code>中点击设置，找到<code>Docker Engine</code>中，在<code>registry-mirrors</code>字段中加上镜像源restart即可。</p>
<h3 id="docker快速安装软件">Docker快速安装软件</h3>
<h4 id="docker安装的优点">Docker安装的优点</h4>
<ul>
<li>一个命令就可以安装好，快速方便</li>
<li>有大量的镜像，可直接使用</li>
<li>没有系统兼容问题，Linux 专享软件也照样跑</li>
<li>支持软件多版本共存</li>
<li>用完就丢，不拖慢电脑速度</li>
<li>不同系统和硬件，只要安装好 Docker 其他都一样了，一个命令搞定所有</li>
</ul>
<h4 id="演示docker安装redis">演示Docker安装Redis</h4>
<p>首先，Docker官方镜像仓库查找Redis：<a href="https://hub.docker.com">https://hub.docker.com</a></p>
<p>查看文档之后，使用一个命令跑Redis,在<code>terminal</code>输入：</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#228b22"># -d： 表示在后台运行 </span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># -p：表示把容器的端口暴露到宿主机 </span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># --name：容器的命名</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># redis：后面加的是版本号</span>
</span></span><span style="display:flex;"><span>$ docker run -d -p 6379:6379 --name redis redis:6.0
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后查看<code>Docker Desktop</code>就可以看到redis在容器里运行了。</p>
<p>Docker命令参考：<a href="https://docs.docker.com/engine/reference/commandline/run">https://docs.docker.com/engine/reference/commandline/run</a></p>
<h3 id="制作自己的镜像">制作自己的镜像</h3>
<h4 id="使用示例web项目构建镜像">使用示例Web项目构建镜像</h4>
<p>项目示例代码：<a href="https://github.com/gzyunke/test-docker">https://github.com/gzyunke/test-docker</a></p>
<p>这是一个Nodejs + + Koa2 写的 Web 项目，提供了简单的两个演示页面。
软件依赖：<a href="https://nodejs.org/zh-cn/">nodejs</a>
项目依赖库：koa、log4js、koa-router</p>
<h4 id="编写dockerfile">编写Dockerfile</h4>
<p>项目所需要的环境配置，依赖，软件写成一个dockerfile：</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> node:11</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">MAINTAINER</span><span style="color:#cd5555"> easydoc.net</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 复制代码</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">ADD</span> . /app<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 设置容器启动后的默认运行目录</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">WORKDIR</span><span style="color:#cd5555"> /app</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 运行命令，安装依赖</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># RUN 命令可以有多个，但是可以用 &amp;&amp; 连接多个命令来减少层级。</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 例如 RUN npm install &amp;&amp; cd /app &amp;&amp; mkdir logs</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> npm install --registry=https://registry.npm.taobao.org<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># CMD 指令只能一个，是容器启动后执行的命令，算是程序的入口。</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 如果还需要运行其他命令可以用 &amp;&amp; 连接，也可以写成一个shell脚本去执行。</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 例如 CMD cd /app &amp;&amp; ./start.sh</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">CMD</span> node app.js<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="build为镜像安装包和运行">Build为镜像（安装包）和运行</h4>
<p>编译<code>docker build -t test:v1 .</code></p>
<blockquote>
<p><code>-t</code>设置镜像名称和版本号</p>
</blockquote>
<p>运行<code>docker run -p 8080:8080 --name test-hello test:v1</code></p>
<blockquote>
<p><code>-p</code>映射容器内端口到主机</p>
<p><code>--name</code>容器名字</p>
<p><code>-d</code>后台运行</p>
</blockquote>
<h4 id="更多相关命令">更多相关命令</h4>
<p><code>docker ps</code> 查看当前运行中的容器
<code>docker images</code> 查看镜像列表d
<code>docker rm container-id</code> 删除指定 id 的容器
<code>docker stop/start container-id</code> 停止/启动指定 id 的容器
<code>docker rmi image-id</code> 删除指定 id 的镜像
<code>docker volume ls</code> 查看 volume 列表
<code>docker network ls</code> 查看网络列表</p>
<h3 id="目录挂载">目录挂载</h3>
<h4 id="现存问题">现存问题</h4>
<ul>
<li>使用 Docker 运行后，我们改了项目代码不会立刻生效，需要重新<code>build</code>和<code>run</code>，很是麻烦。</li>
<li>容器里面产生的数据，例如 log 文件，数据库备份文件，容器删除后就丢失了。</li>
</ul>
<blockquote>
<p>目录挂载解决以上问题</p>
</blockquote>
<h4 id="几种挂载方式">几种挂载方式</h4>
<ul>
<li><code>bind mount</code> 直接把宿主机目录映射到容器内，适合挂代码目录和配置文件。可挂到多个容器上</li>
<li><code>volume</code> 由容器创建和管理，创建在宿主机，所以删除容器不会丢失，官方推荐，更高效，Linux 文件系统，适合存储数据库数据。可挂到多个容器上</li>
<li><code>tmpfs mount</code> 适合存储临时文件，存宿主机内存中。不可多容器共享</li>
</ul>
<p>挂载示意图：</p>
<p><img src="https://sjwx.easydoc.xyz/46901064/files/kv96dc4q.png" alt=""></p>
<h4 id="挂载演示">挂载演示</h4>
<p><code>bind mount</code>方式用绝对路径<code>-v D:/code:/app</code>
<code>volume</code> 方式，只需要一个名字<code>-v db-data:/app</code></p>
<p>示例：</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#228b22"># 注意： D：/code是你的程序文件的绝对地址，需要更改</span>
</span></span><span style="display:flex;"><span>$ docker run -p 8080:8080 --name test-hello -v D:/code:/app -d test:v1
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>  使用这种方式，如果本地的代码进行改变，容器里的代码也会进行实时改变。运行的项目需要在容器重启之后生效，从而发生变化。</p>
</blockquote>
<h3 id="多容器通信">多容器通信</h3>
<h4 id="学习目标">学习目标</h4>
<p>项目往往都不是独立运行的，需要数据库，缓存这些东西配合运作。</p>
<p>我们将前面的Web项目增加一个Redis依赖，多跑一个Redis容器，演示如何进行多容器之间的通信。</p>
<h4 id="创建虚拟网络">创建虚拟网络</h4>
<p>要想多容器之间互通，从 Web 容器访问 Redis 容器，我们只需要把他们放到同个网络中就可以了。</p>
<p>文档参考：<a href="https://docs.docker.com/engine/reference/commandline/network/">https://docs.docker.com/engine/reference/commandline/network/</a></p>
<h4 id="演示">演示</h4>
<p>创建一个名为<code>test-net</code>的网络</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ docker network create test-net
</span></span></code></pre></td></tr></table>
</div>
</div><p>运行Redis在<code>test-net</code>网络中，别名为<code>redis</code>：</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#228b22"># --network:制定网络的名字</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># --network-alias:起一个网络别名</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 最后是镜像来源版本号</span>
</span></span><span style="display:flex;"><span>docker run -d --name redis --network test-net --network-alias redis redis:6.0
</span></span></code></pre></td></tr></table>
</div>
</div><p>修改代码中访问<code>redis</code>的地址为网络别名</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">const</span> redis = require(<span style="color:#cd5555">&#39;redis&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">let</span> rds = redis.createClient({url: <span style="color:#cd5555">&#34;redis://redis:6379&#34;</span>}); <span style="color:#228b22">// 这里的路径上需要写上上面写的网络别名
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>rds.on(<span style="color:#cd5555">&#39;connect&#39;</span>, ()=&gt; console.log(<span style="color:#cd5555">&#39;redis connect ok&#39;</span>))
</span></span><span style="display:flex;"><span>rds.connect();
</span></span></code></pre></td></tr></table>
</div>
</div><p>运行 Web 项目，使用同个网络</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#228b22"># 这里还是用本地目录挂载，我就直接把我mac电脑上的目录写进去了</span>
</span></span><span style="display:flex;"><span><span style="color:#228b22"># 这里最后的test：v1是代表使用之前已经部署好的镜像（安装包）</span>
</span></span><span style="display:flex;"><span>$ docker run -p 8080:8080 --name <span style="color:#658b00">test</span> -v /Users/caixiongjiang/github仓库/test-docker:/app --network test-net -d test:v1
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看数据</p>
<p><code>http://localhost:8080/redis</code>
容器终端查看数据是否一致</p>
<h3 id="docker-compose">Docker-Compose</h3>
<h4 id="现存问题-1">现存问题</h4>
<p>在上节，我们运行了两个容器：Web 项目 + Redis
如果项目依赖更多的第三方软件，我们需要管理的容器就更加多，每个都要单独配置运行，指定网络。
这节，我们使用 docker-compose 把项目的多个服务集合到一起，一键运行。</p>
<h4 id="安装docker-compose">安装Docker Compose</h4>
<ul>
<li>如果你是安装的桌面版 Docker，不需要额外安装，已经包含了。</li>
<li>如果是没图形界面的服务器版 Docker，你需要单独安装 <a href="https://docs.docker.com/compose/install/#install-compose-on-linux-systems">安装文档</a></li>
<li>运行<code>docker-compose</code>检查是否安装成功</li>
</ul>
<h4 id="编写脚本">编写脚本</h4>
<p>要把项目依赖的多个服务集合到一起，我们需要编写一个<code>docker-compose.yml</code>文件，描述依赖哪些服务
参考文档：https://docs.docker.com/compose/</p>
<pre tabindex="0"><code>version: &#34;3.7&#34;

services:
  app:
    build: ./
    ports:
      - 80:8080
    volumes:
      - ./:/app
    environment:
      - TZ=Asia/Shanghai
  redis:
    image: redis:5.0.13
    volumes:
      - redis:/data
    environment:
      - TZ=Asia/Shanghai

volumes:
  redis:
  
</code></pre><blockquote>
<p>容器默认时间不是北京时间，增加TZ=Aisa/Shanghai可以改为北京时间</p>
</blockquote>
<h4 id="run">RUN</h4>
<p>在<code>docker-compose.yml</code>文件所在目录，执行<code>docker-compose up</code>就可以运行起来了。</p>
<p>命令参考：https://docs.docker.com/compose/reference/up/</p>
<blockquote>
<p>这里执行<code>docker-compose up</code>相当于批量执行配置，包括前面的依赖，目录挂载，环境配置等。</p>
<p>这里没有指定网络是因为，docker会默认给所有的东西指定同一个网络，可以直接互相通信。</p>
</blockquote>
<p>在后台运行只需要加一个 -d 参数<code>docker-compose up -d</code>
查看运行状态：<code>docker-compose ps</code>
停止运行：<code>docker-compose stop</code>
重启：<code>docker-compose restart</code>
重启单个服务：<code>docker-compose restart service-name</code>
进入容器命令行：<code>docker-compose exec service-name sh</code>
查看容器运行log：<code>docker-compose logs [service-name]</code></p>
<h3 id="发布和部署">发布和部署</h3>
<h4 id="镜像仓库介绍">镜像仓库介绍</h4>
<p>镜像仓库用来存储我们 build 出来的“安装包”，Docker 官方提供了一个 <a href="https://hub.docker.com/">镜像库</a>，里面包含了大量镜像，基本各种软件所需依赖都有，要什么直接上去搜索。</p>
<p>我们也可以把自己 build 出来的镜像上传到 docker 提供的镜像库中，方便传播（跟项目发布到github是一个道理）。
当然你也可以搭建自己的私有镜像库，或者使用国内各种大厂提供的镜像托管服务，例如：阿里云、腾讯云</p>
<h4 id="上传镜像">上传镜像</h4>
<ul>
<li>首先你要先 <a href="https://hub.docker.com/">注册一个账号</a></li>
<li>创建一个镜像库</li>
</ul>
<p><img src="https://blog-1311257248.cos.ap-nanjing.myqcloud.com/imgs/docker/img1.png" alt=""></p>
<ul>
<li>命令行登录账号：
<code>docker login -u username</code></li>
<li>新建一个tag，名字必须跟你注册账号一样
<code>docker tag test:v1 username/test:v1</code></li>
<li>推上去
<code>docker push username/test:v1</code></li>
<li>部署试下
<code>docker run -dp 8080:8080 username/test:v1</code></li>
</ul>
<p>docker-compose 中也可以直接用这个镜像了</p>
<pre tabindex="0"><code>version: &#34;3.7&#34;

services:
  app:
#    build: ./
    image: jarsoncai/test:v1
    ports:
      - 80:8080
    volumes:
      - ./:/app
    environment:
      - TZ=Asia/Shanghai
  redis:
    image: redis:5.0.13
    volumes:
      - redis:/data
    environment:
      - TZ=Asia/Shanghai

volumes:
  redis:
</code></pre><h3 id="备份和迁移">备份和迁移</h3>
<p>容器中的数据，如果没有用挂载目录，删除容器后就会丢失数据。
前面已经了解了如何 <a href="doc:kze7f0ZR">挂载目录</a>
如果你是用<code>bind mount</code>直接把宿主机的目录挂进去容器，那迁移数据很方便，直接复制目录就好了
如果你是用<code>volume</code>方式挂载的，由于数据是由容器创建和管理的，需要用特殊的方式把数据弄出来。</p>
<h4 id="备份和导入-volume-的流程">备份和导入 Volume 的流程</h4>
<p>备份：</p>
<ul>
<li>运行一个 ubuntu 的容器，挂载需要备份的 volume 到容器，并且挂载宿主机目录到容器里的备份目录。</li>
<li>运行 tar 命令把数据压缩为一个文件</li>
<li>把备份文件复制到需要导入的机器</li>
</ul>
<p>导入：</p>
<ul>
<li>运行 ubuntu 容器，挂载容器的 volume，并且挂载宿主机备份文件所在目录到容器里</li>
<li>运行 tar 命令解压备份文件到指定目录</li>
</ul>
<h3 id="备份-mongodb-数据演示">备份 MongoDB 数据演示</h3>
<ul>
<li>运行一个 mongodb，创建一个名叫<code>mongo-data</code>的 volume 指向容器的 /data 目录
<code>docker run -p 27018:27017 --name mongo -v mongo-data:/data -d mongo:4.4</code></li>
<li>运行一个 Ubuntu 的容器，挂载<code>mongo</code>容器的所有 volume，映射宿主机的 backup 目录到容器里面的 /backup 目录，然后运行 tar 命令把数据压缩打包
<code>docker run --rm --volumes-from mongo -v d:/backup:/backup ubuntu tar cvf /backup/backup.tar /data/</code></li>
</ul>
<p>最后你就可以拿着这个 backup.tar 文件去其他地方导入了。</p>
<h3 id="恢复-volume-数据演示">恢复 Volume 数据演示</h3>
<ul>
<li>运行一个 ubuntu 容器，挂载 mongo 容器的所有 volumes，然后读取 /backup 目录中的备份文件，解压到 /data/ 目录
<code>docker run --rm --volumes-from mongo -v d:/backup:/backup ubuntu bash -c &quot;cd /data/ &amp;&amp; tar xvf /backup/backup.tar --strip 1&quot;</code></li>
</ul>

                    
                    <HR width="100%" id="EOF">
		            <p style="color:#777;">最后修改于 2022-06-24</p>
                    
                    
                    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://image-1252109614.cos.ap-beijing.myqcloud.com/img/20210508215939.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://caixiongjiang.github.io/blog/2022/%E9%9A%8F%E7%AC%94/%E7%A8%8B%E5%BA%8F%E5%91%98%E8%B6%81%E6%89%8B%E7%9A%84%E6%9C%BA%E5%99%A8/">
			下回<br>程序员趁手的机器
                </a>
                
                
                
                <a class="older-posts" href="https://caixiongjiang.github.io/blog/2022/git%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/">
			上回<br>Git：版本管理工具
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                








<div id="tcomment"></div>



            </div>
        </div>
    </div>
</div>

            </div><div id="single-column-footer">
魔改自 <a href="https://github.com/riba2534/hugo-blog">Riba2534</a> by <a href="https://caixiongjiang.github.io">Jarson Cai</a>
<br>

&copy;
	
	2024 🌀Jarson Cai&#39;s Blog
	</div>
            </div>
    <script>
let app;

app = new Vue({
    el: '#app',
    data: {
        scrollY: 0,
        navOpacity: 0,
        isDrawerOpen: false,
        mounted: false,
        isDarkMode: false
    },
    methods: {
            sgn(t, x) {
                let k = 1. / (1. - 2 * t);
                if (x <= t) return 0;
                else if (x >= 1 - t) return 1;
                else {
                    return k * (x - t);
                }
            },
            handleScroll() {
                this.scrollY = window.scrollY;
                this.navOpacity = this.sgn(.0, Math.min(1, Math.max(0, window.scrollY / (this.pageHeadHeight() - this.navBarHeight() * 0.8))));
                const {navBar, navBackground, navTitle, extraContainer, streamContainer} = this.$refs;

                if (this.navOpacity >= 1) {
                    navBackground.style.opacity = 1;
                    navTitle.style.opacity = 1;
                } else {
                    navBackground.style.opacity = 0;
                    navTitle.style.opacity = 0;
                }
            },
            handleResize() {
                const {navBar, navBackground, navTitle, extraContainer, streamContainer} = this.$refs;
                extraContainer.style.left = (streamContainer.offsetWidth - extraContainer.offsetWidth) + 'px';
            },
            navBarHeight() {
                return this.$refs.navBar.offsetHeight;
            },
            pageHeadHeight() {
                return this.$refs.pageHead.offsetHeight;
            },
            toggleDrawer() {
                this.isDrawerOpen = !this.isDrawerOpen;
                document.getElementsByTagName('html')[0].style.overflow = this.isDrawerOpen ? 'hidden' : 'unset';
            },
            closeDrawer() {
                this.isDrawerOpen = false;
                document.getElementsByTagName('html')[0].style.overflow = this.isDrawerOpen ? 'hidden' : 'unset';
            },
            toggleDarkMode() {
                this.isDarkMode = !this.isDarkMode;
                if (this.isDarkMode==true){
                    document.cookie = "night=1;path=/";
                    document.body.classList.add("night");
                } else {
                    document.cookie = "night=0;path=/";
                    document.body.classList.remove("night");
                }
            },
            debounce(func, wait, options) {
                let lastArgs,
                    lastThis,
                    maxWait,
                    result,
                    timerId,
                    lastCallTime

                let lastInvokeTime = 0
                let leading = false
                let maxing = false
                let trailing = true

                
                const useRAF = (!wait && wait !== 0 && typeof root.requestAnimationFrame === 'function')

                if (typeof func !== 'function') {
                    throw new TypeError('Expected a function')
                }
                function isObject(value) {
                    const type = typeof value
                    return value != null && (type === 'object' || type === 'function')
                }

                wait = +wait || 0
                if (isObject(options)) {
                    leading = !!options.leading
                    maxing = 'maxWait' in options
                    maxWait = maxing ? Math.max(+options.maxWait || 0, wait) : maxWait
                    trailing = 'trailing' in options ? !!options.trailing : trailing
                }

                function invokeFunc(time) {
                    const args = lastArgs
                    const thisArg = lastThis

                    lastArgs = lastThis = undefined
                    lastInvokeTime = time
                    result = func.apply(thisArg, args)
                    return result
                }

                function startTimer(pendingFunc, wait) {
                    if (useRAF) {
                    root.cancelAnimationFrame(timerId)
                    return root.requestAnimationFrame(pendingFunc)
                    }
                    return setTimeout(pendingFunc, wait)
                }

                function cancelTimer(id) {
                    if (useRAF) {
                    return root.cancelAnimationFrame(id)
                    }
                    clearTimeout(id)
                }

                function leadingEdge(time) {
                    
                    lastInvokeTime = time
                    
                    timerId = startTimer(timerExpired, wait)
                    
                    return leading ? invokeFunc(time) : result
                }

                function remainingWait(time) {
                    const timeSinceLastCall = time - lastCallTime
                    const timeSinceLastInvoke = time - lastInvokeTime
                    const timeWaiting = wait - timeSinceLastCall

                    return maxing
                    ? Math.min(timeWaiting, maxWait - timeSinceLastInvoke)
                    : timeWaiting
                }

                function shouldInvoke(time) {
                    const timeSinceLastCall = time - lastCallTime
                    const timeSinceLastInvoke = time - lastInvokeTime

                    
                    
                    
                    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||
                    (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait))
                }

                function timerExpired() {
                    const time = Date.now()
                    if (shouldInvoke(time)) {
                    return trailingEdge(time)
                    }
                    
                    timerId = startTimer(timerExpired, remainingWait(time))
                }

                function trailingEdge(time) {
                    timerId = undefined

                    
                    
                    if (trailing && lastArgs) {
                    return invokeFunc(time)
                    }
                    lastArgs = lastThis = undefined
                    return result
                }

                function cancel() {
                    if (timerId !== undefined) {
                    cancelTimer(timerId)
                    }
                    lastInvokeTime = 0
                    lastArgs = lastCallTime = lastThis = timerId = undefined
                }

                function flush() {
                    return timerId === undefined ? result : trailingEdge(Date.now())
                }

                function pending() {
                    return timerId !== undefined
                }

                function debounced(...args) {
                    const time = Date.now()
                    const isInvoking = shouldInvoke(time)

                    lastArgs = args
                    lastThis = this
                    lastCallTime = time

                    if (isInvoking) {
                    if (timerId === undefined) {
                        return leadingEdge(lastCallTime)
                    }
                    if (maxing) {
                        
                        timerId = startTimer(timerExpired, wait)
                        return invokeFunc(lastCallTime)
                    }
                    }
                    if (timerId === undefined) {
                    timerId = startTimer(timerExpired, wait)
                    }
                    return result
                }
                debounced.cancel = cancel
                debounced.flush = flush
                debounced.pending = pending
                return debounced
                }

    },
    created() {
        window.addEventListener('scroll', this.handleScroll);
        window.addEventListener('resize', this.handleResize);
        window._nonDesktop = function () {
            let check = false;
            (function (a) {
                if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true;
            })(navigator.userAgent || navigator.vendor || window.opera);
            return check;
        };
        
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1");
        if (night==""){
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                
            }
        }else{
            
            if (night=="1") {
                this.toggleDarkMode();
            }
        }
    },
    mounted() {
        this.handleScroll();
        this.handleResize();
        this.mounted = true;

        
        
        
            twikoo.init({
                envId: "https://twikoo-rho-olive.vercel.app/",
                el: '#tcomment',
                region:  null ,
            });
        

        document.querySelectorAll("table").forEach(function(elem){
            elem.classList.add("table-striped");
            elem.classList.add("table");
            elem.classList.add("table-responsive");
            elem.classList.add("table-hover");
        })

        
        spy();
        window.addEventListener('scroll', this.debounce(spy, 250, { 'maxWait': 250 }), false);
        
        
    },
    destroyed() {
        window.removeEventListener('scroll', this.handleScroll);
        window.removeEventListener('resize', this.handleResize);
    }
});



</script>
    </body>
</html>
