<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ğŸŒ€Jarson Cai&#39;s Blog</title>
    <link>https://caixiongjiang.github.io/</link>
    <description>Recent content on ğŸŒ€Jarson Cai&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sat, 31 Aug 2024 18:18:05 +0800</lastBuildDate>
    
        <atom:link href="https://caixiongjiang.github.io/index.xml" rel="self" type="application/rss+xml" />
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 12 ç«  I/O å¤ç”¨ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-12-%E7%AB%A0-i-o-%E5%A4%8D%E7%94%A8-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Sat, 02 Apr 2022 17:38:29 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-12-%E7%AB%A0-i-o-%E5%A4%8D%E7%94%A8-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-12-%E7%AB%A0-i-o-%E5%A4%8D%E7%94%A8-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-12-ç« -io-å¤ç”¨&#34;&gt;ç¬¬ 12 ç«  I/O å¤ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;121-åŸºäº-io-å¤ç”¨çš„æœåŠ¡å™¨ç«¯&#34;&gt;12.1 åŸºäº I/O å¤ç”¨çš„æœåŠ¡å™¨ç«¯&lt;/h3&gt;
&lt;h4 id=&#34;1211-å¤šè¿›ç¨‹æœåŠ¡ç«¯çš„ç¼ºç‚¹å’Œè§£å†³æ–¹æ³•&#34;&gt;12.1.1 å¤šè¿›ç¨‹æœåŠ¡ç«¯çš„ç¼ºç‚¹å’Œè§£å†³æ–¹æ³•&lt;/h4&gt;
&lt;p&gt;ä¸ºäº†æ„å»ºå¹¶å‘æœåŠ¡å™¨ï¼Œåªè¦æœ‰å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚å°±ä¼šåˆ›å»ºæ–°è¿›ç¨‹ã€‚è¿™çš„ç¡®æ˜¯å®é™…æ“ä½œä¸­é‡‡ç”¨çš„ä¸€ç§æ–¹æ¡ˆï¼Œä½†å¹¶éåå…¨åç¾ï¼Œå› ä¸ºåˆ›å»ºè¿›ç¨‹è¦ä»˜å‡ºå¾ˆå¤§çš„ä»£ä»·ã€‚è¿™éœ€è¦å¤§é‡çš„è¿ç®—å’Œå†…å­˜ç©ºé—´ï¼Œç”±äºæ¯ä¸ªè¿›ç¨‹éƒ½å…·æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥ç›¸äº’é—´çš„æ•°æ®äº¤æ¢ä¹Ÿè¦é‡‡ç”¨ç›¸å¯¹å¤æ‚çš„æ–¹æ³•ï¼ˆIPC å±äºç›¸å¯¹å¤æ‚çš„é€šä¿¡æ–¹æ³•ï¼‰&lt;/p&gt;
&lt;p&gt;I/O å¤ç”¨æŠ€æœ¯å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1212-ç†è§£å¤ç”¨&#34;&gt;12.1.2 ç†è§£å¤ç”¨&lt;/h4&gt;
&lt;p&gt;ã€Œå¤ç”¨ã€åœ¨ç”µå­åŠé€šä¿¡å·¥ç¨‹é¢†åŸŸå¾ˆå¸¸è§ï¼Œå‘è¿™äº›é¢†åŸŸçš„ä¸“å®¶è¯¢é—®å…¶æ¦‚å¿µï¼Œå¯èƒ½ä¼šå¾—åˆ°å¦‚ä¸‹ç­”å¤ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨ 1 ä¸ªé€šä¿¡é¢‘é“ä¸­ä¼ é€’å¤šä¸ªæ•°æ®ï¼ˆä¿¡å·ï¼‰çš„æŠ€æœ¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ã€Œå¤ç”¨ã€çš„å«ä¹‰ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºäº†æé«˜ç‰©ç†è®¾å¤‡çš„æ•ˆç‡ï¼Œåªç”¨æœ€å°‘çš„ç‰©ç†è¦ç´ ä¼ é€’æœ€å¤šæ•°æ®æ—¶ä½¿ç”¨çš„æŠ€æœ¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸Šè¿°ä¸¤ç§æ–¹æ³•çš„å†…å®¹å®Œå…¨ä¸€è‡´ã€‚å¯ä»¥ç”¨çº¸ç”µè¯æ¨¡å‹åšä¸€ä¸ªç±»æ¯”ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kA8H81.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾æ˜¯ä¸€ä¸ªçº¸æ¯ç”µè¯ç³»ç»Ÿï¼Œä¸ºäº†ä½¿å¾—ä¸‰äººåŒæ—¶é€šè¯ï¼Œè¯´è¯æ—¶è¦åŒäº‹å¯¹ç€ä¸¤ä¸ªçº¸æ¯ï¼Œæ¥å¬æ—¶ä¹Ÿéœ€è¦è€³æœµåŒæ—¶å¯¹å‡†ä¸¤ä¸ªçº¸æ¯ã€‚ä¸ºäº†å®Œæˆ 3 äººé€šè¯ï¼Œå¯ä»¥è¿›è¡Œå¦‚ä¸‹å›¾çš„æ”¹è¿›ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kA8bgx.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å›¾åšå‡ºæ”¹è¿›ï¼Œå°±æ˜¯å¼•å…¥äº†å¤ç”¨æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;p&gt;å¤ç”¨æŠ€æœ¯çš„ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‡å°‘è¿çº¿é•¿åº¦&lt;/li&gt;
&lt;li&gt;å‡å°‘çº¸æ¯ä¸ªæ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å³ä½¿å‡å°‘äº†è¿çº¿å’Œçº¸æ¯çš„é‡ä»ç„¶å¯ä»¥è¿›è¡Œä¸‰äººåŒæ—¶è¯´è¯ï¼Œä½†æ˜¯å¦‚æœç¢°åˆ°ä»¥ä¸‹æƒ…å†µï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ã€Œå¥½åƒä¸èƒ½åŒæ—¶è¯´è¯ï¼Ÿã€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œå› ä¸ºæ˜¯åœ¨è¿›è¡Œå¯¹è¯ï¼Œæ‰€ä»¥å¾ˆå°‘å‘ç”ŸåŒæ—¶è¯´è¯çš„æƒ…å†µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šè¿°ç³»ç»Ÿé‡‡ç”¨çš„æ˜¯**ã€Œæ—¶åˆ†å¤ç”¨ã€**æŠ€æœ¯ã€‚å› ä¸ºè¯´è¯äººå£°é¢‘ç‡ä¸åŒï¼Œå³ä½¿åœ¨åŒæ—¶è¯´è¯ä¹Ÿèƒ½è¿›è¡Œä¸€å®šç¨‹åº¦ä¸Šçš„åŒºåˆ†ï¼ˆæ‚éŸ³ä¹Ÿéšä¹‹å¢å¤šï¼‰ã€‚å› æ­¤ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ã€Œé¢‘åˆ†å¤ç”¨æŠ€æœ¯ã€ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1213-å¤ç”¨æŠ€æœ¯åœ¨æœåŠ¡å™¨ç«¯çš„åº”ç”¨&#34;&gt;12.1.3 å¤ç”¨æŠ€æœ¯åœ¨æœåŠ¡å™¨ç«¯çš„åº”ç”¨&lt;/h4&gt;
&lt;p&gt;çº¸æ¯ç”µè¯ç³»ç»Ÿå¼•å…¥å¤ç”¨æŠ€æœ¯ä¹‹åå¯ä»¥å‡å°‘çº¸æ¯æ•°é‡å’Œè¿çº¿é•¿åº¦ã€‚æœåŠ¡å™¨ç«¯å¼•å…¥å¤ç”¨æŠ€æœ¯å¯ä»¥å‡å°‘æ‰€éœ€è¿›ç¨‹æ•°ã€‚ä¸‹å›¾æ˜¯å¤šè¿›ç¨‹æœåŠ¡ç«¯çš„æ¨¡å‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kAGBM6.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯å¼•å…¥å¤ç”¨æŠ€æœ¯ä¹‹åçš„æ¨¡å‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kAGrqO.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œå¼•å…¥å¤ç”¨æŠ€æœ¯ä¹‹åï¼Œå¯ä»¥å‡å°‘è¿›ç¨‹æ•°ã€‚é‡è¦çš„æ˜¯ï¼Œæ— è®ºè¿æ¥å¤šå°‘å®¢æˆ·ç«¯ï¼Œæä¾›æœåŠ¡çš„è¿›ç¨‹åªæœ‰ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;h3 id=&#34;122-ç†è§£-select-å‡½æ•°å¹¶å®ç°æœåŠ¡ç«¯&#34;&gt;12.2 ç†è§£ select å‡½æ•°å¹¶å®ç°æœåŠ¡ç«¯&lt;/h3&gt;
&lt;p&gt;select å‡½æ•°æ˜¯æœ€å…·ä»£è¡¨æ€§çš„å®ç°å¤ç”¨æœåŠ¡å™¨çš„æ–¹æ³•ã€‚åœ¨ Windows å¹³å°ä¸‹ä¹Ÿæœ‰åŒåå‡½æ•°ï¼Œæ‰€ä»¥å…·æœ‰å¾ˆå¥½çš„ç§»æ¤æ€§ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1221-select-å‡½æ•°çš„åŠŸèƒ½å’Œè°ƒç”¨é¡ºåº&#34;&gt;12.2.1 select å‡½æ•°çš„åŠŸèƒ½å’Œè°ƒç”¨é¡ºåº&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨ select å‡½æ•°æ—¶å¯ä»¥å°†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦é›†ä¸­åˆ°ä¸€èµ·ç»Ÿä¸€ç›‘è§†ï¼Œé¡¹ç›®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¯å¦å­˜åœ¨å¥—æ¥å­—æ¥æ”¶æ•°æ®ï¼Ÿ&lt;/li&gt;
&lt;li&gt;æ— éœ€é˜»å¡ä¼ è¾“æ•°æ®çš„å¥—æ¥å­—æœ‰å“ªäº›ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å“ªäº›å¥—æ¥å­—å‘ç”Ÿäº†å¼‚å¸¸ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¯è¯­ï¼šã€Œäº‹ä»¶ã€ã€‚å½“å‘ç”Ÿç›‘è§†é¡¹å¯¹åº”æƒ…å†µæ—¶ï¼Œç§°ã€Œå‘ç”Ÿäº†äº‹ä»¶ã€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;select å‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ä¸ä¸€èˆ¬å‡½æ•°çš„åŒºåˆ«å¹¶ä¸å¤§ï¼Œæ›´å‡†ç¡®çš„è¯´ï¼Œä»–å¾ˆéš¾ä½¿ç”¨ã€‚ä½†æ˜¯ä¸ºäº†å®ç° I/O å¤ç”¨æœåŠ¡å™¨ç«¯ï¼Œæˆ‘ä»¬åº”è¯¥æŒæ¡ select å‡½æ•°ï¼Œå¹¶è¿ç”¨äºå¥—æ¥å­—ç¼–ç¨‹å½“ä¸­ã€‚è®¤ä¸ºã€Œselect å‡½æ•°æ˜¯ I/O å¤ç”¨çš„å…¨éƒ¨å†…å®¹ã€ä¹Ÿå¹¶ä¸ä¸ºè¿‡ã€‚select å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kAtdRs.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1222-è®¾ç½®æ–‡ä»¶æè¿°ç¬¦&#34;&gt;12.2.2 è®¾ç½®æ–‡ä»¶æè¿°ç¬¦&lt;/h4&gt;
&lt;p&gt;åˆ©ç”¨ select å‡½æ•°å¯ä»¥åŒæ—¶ç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚å½“ç„¶ï¼Œç›‘è§†æ–‡ä»¶æè¿°ç¬¦å¯ä»¥è§†ä¸ºç›‘è§†å¥—æ¥å­—ã€‚æ­¤æ—¶é¦–å…ˆéœ€è¦å°†è¦ç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦é›†ä¸­åœ¨ä¸€èµ·ã€‚é›†ä¸­æ—¶ä¹Ÿè¦æŒ‰ç…§ç›‘è§†é¡¹ï¼ˆæ¥æ”¶ã€ä¼ è¾“ã€å¼‚å¸¸ï¼‰è¿›è¡ŒåŒºåˆ†ï¼Œå³æŒ‰ç…§ä¸Šè¿° 3 ç§ç›‘è§†é¡¹åˆ†æˆ 3 ç±»ã€‚&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ fd_set æ•°ç»„å˜é‡æ‰§è¡Œæ­¤æ“ä½œï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œè¯¥æ•°ç»„æ˜¯å­˜æœ‰0å’Œ1çš„ä½æ•°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kAt2i4.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å›¾ä¸­æœ€å·¦ç«¯çš„ä½è¡¨ç¤ºæ–‡ä»¶æè¿°ç¬¦ 0ï¼ˆæ‰€åœ¨ä½ç½®ï¼‰ã€‚å¦‚æœè¯¥ä½è®¾ç½®ä¸º 1ï¼Œåˆ™è¡¨ç¤ºè¯¥æ–‡ä»¶æè¿°ç¬¦æ˜¯ç›‘è§†å¯¹è±¡ã€‚é‚£ä¹ˆå›¾ä¸­å“ªäº›æ–‡ä»¶æè¿°ç¬¦æ˜¯ç›‘è§†å¯¹è±¡å‘¢ï¼Ÿå¾ˆæ˜æ˜¾ï¼Œæ˜¯æè¿°ç¬¦ 1 å’Œ 3ã€‚åœ¨ fd_set å˜é‡ä¸­æ³¨å†Œæˆ–æ›´æ”¹å€¼çš„æ“ä½œéƒ½ç”±ä¸‹åˆ—å®å®Œæˆã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;FD_ZERO(fd_set *fdset)&lt;/code&gt;ï¼šå°† fd_set å˜é‡æ‰€æŒ‡çš„ä½å…¨éƒ¨åˆå§‹åŒ–æˆ0&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FD_SET(int fd,fd_set *fdset)&lt;/code&gt;ï¼šåœ¨å‚æ•° fdset æŒ‡å‘çš„å˜é‡ä¸­æ³¨å†Œæ–‡ä»¶æè¿°ç¬¦ fd çš„ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FD_SLR(int fd,fd_set *fdset)&lt;/code&gt;ï¼šä»å‚æ•° fdset æŒ‡å‘çš„å˜é‡ä¸­æ¸…é™¤æ–‡ä»¶æè¿°ç¬¦ fd çš„ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FD_ISSET(int fd,fd_set *fdset)&lt;/code&gt;ï¼šè‹¥å‚æ•° fdset æŒ‡å‘çš„å˜é‡ä¸­åŒ…å«æ–‡ä»¶æè¿°ç¬¦ fd çš„ä¿¡æ¯ï¼Œåˆ™è¿”å›ã€ŒçœŸã€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šè¿°å‡½æ•°ä¸­ï¼ŒFD_ISSET ç”¨äºéªŒè¯ select å‡½æ•°çš„è°ƒç”¨ç»“æœï¼Œé€šè¿‡ä¸‹å›¾è§£é‡Šè¿™äº›å‡½æ•°çš„åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kANR78.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1223-è®¾ç½®æ£€æŸ¥ç›‘è§†èŒƒå›´åŠè¶…æ—¶&#34;&gt;12.2.3 è®¾ç½®æ£€æŸ¥ï¼ˆç›‘è§†ï¼‰èŒƒå›´åŠè¶…æ—¶&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ select å‡½æ•°çš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/select.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/time.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;select&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; maxfd, fd_set *readset, fd_set *writeset,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           fd_set *exceptset, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; timeval *timeout);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å›å¤§äº 0 çš„å€¼ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;maxfd: ç›‘è§†å¯¹è±¡æ–‡ä»¶æè¿°ç¬¦æ•°é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;readset: å°†æ‰€æœ‰å…³æ³¨ã€Œæ˜¯å¦å­˜åœ¨å¾…è¯»å–æ•°æ®ã€çš„æ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ° fd_set å‹å˜é‡ï¼Œå¹¶ä¼ é€’å…¶åœ°å€å€¼ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;writeset: å°†æ‰€æœ‰å…³æ³¨ã€Œæ˜¯å¦å¯ä¼ è¾“æ— é˜»å¡æ•°æ®ã€çš„æ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ° fd_set å‹å˜é‡ï¼Œå¹¶ä¼ é€’å…¶åœ°å€å€¼ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;exceptset: å°†æ‰€æœ‰å…³æ³¨ã€Œæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ã€çš„æ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ° fd_set å‹å˜é‡ï¼Œå¹¶ä¼ é€’å…¶åœ°å€å€¼ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;timeout: è°ƒç”¨ select å‡½æ•°åï¼Œä¸ºé˜²æ­¢é™·å…¥æ— é™é˜»å¡çš„çŠ¶æ€ï¼Œä¼ é€’è¶…æ—¶(time-out)ä¿¡æ¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;è¿”å›å€¼: å‘ç”Ÿé”™è¯¯æ—¶è¿”å› -1,è¶…æ—¶æ—¶è¿”å›0,ã€‚å› å‘ç”Ÿå…³æ³¨çš„æ—¶é—´è¿”å›æ—¶ï¼Œè¿”å›å¤§äº0çš„å€¼ï¼Œè¯¥å€¼æ˜¯å‘ç”Ÿäº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦æ•°ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¦‚ä¸Šæ‰€è¿°ï¼Œselect å‡½æ•°ç”¨æ¥éªŒè¯ 3 ç§ç›‘è§†çš„å˜åŒ–æƒ…å†µï¼Œæ ¹æ®ç›‘è§†é¡¹å£°æ˜ 3 ä¸ª fd_set å‹å˜é‡ï¼Œåˆ†åˆ«å‘å…¶æ³¨å†Œæ–‡ä»¶æè¿°ç¬¦ä¿¡æ¯ï¼Œå¹¶æŠŠå˜é‡çš„åœ°å€å€¼ä¼ é€’åˆ°ä¸Šè¿°å‡½æ•°çš„ç¬¬äºŒåˆ°ç¬¬å››ä¸ªå‚æ•°ã€‚ä½†åœ¨æ­¤ä¹‹å‰ï¼ˆè°ƒç”¨ select å‡½æ•°ä¹‹å‰ï¼‰éœ€è¦å†³å®šä¸‹é¢ä¸¤ä»¶äº‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ–‡ä»¶æè¿°ç¬¦çš„ç›‘è§†ï¼ˆæ£€æŸ¥ï¼‰èŒƒå›´æ˜¯ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•è®¾å®š select å‡½æ•°çš„è¶…æ—¶æ—¶é—´ï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¬¬ä¸€ï¼Œæ–‡ä»¶æè¿°ç¬¦çš„ç›‘è§†èŒƒå›´å’Œ select çš„ç¬¬ä¸€ä¸ªå‚æ•°æœ‰å…³ã€‚å®é™…ä¸Šï¼Œselect å‡½æ•°è¦æ±‚é€šè¿‡ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç›‘è§†å¯¹è±¡æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡ã€‚å› æ­¤ï¼Œéœ€è¦å¾—åˆ°æ³¨å†Œåœ¨ fd_set å˜é‡ä¸­çš„æ–‡ä»¶æè¿°ç¬¦æ•°ã€‚ä½†æ¯æ¬¡æ–°å»ºæ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œå…¶å€¼å°±ä¼šå¢åŠ  1 ï¼Œæ•…åªéœ€å°†æœ€å¤§çš„æ–‡ä»¶æè¿°ç¬¦å€¼åŠ  1 å†ä¼ é€’ç»™ select å‡½æ•°å³å¯ã€‚åŠ  1 æ˜¯å› ä¸ºæ–‡ä»¶æè¿°ç¬¦çš„å€¼æ˜¯ä» 0 å¼€å§‹çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒï¼Œselect å‡½æ•°çš„è¶…æ—¶æ—¶é—´ä¸ select å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æœ‰å…³ï¼Œå…¶ä¸­ timeval ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; timeval
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;long&lt;/span&gt; tv_sec;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;long&lt;/span&gt; tv_usec;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æœ¬æ¥ select å‡½æ•°åªæœ‰åœ¨ç›‘è§†æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿå˜åŒ–æ—¶æ‰è¿”å›ã€‚å¦‚æœæœªå‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚æŒ‡å®šè¶…æ—¶æ—¶é—´å°±æ˜¯ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚é€šè¿‡ä¸Šè¿°ç»“æ„ä½“å˜é‡ï¼Œå°†ç§’æ•°å¡«å…¥ tv_sec çš„æˆå‘˜ï¼Œå°†å¾®å¦™æ•°å¡«å…¥ tv_usec çš„æˆå‘˜ï¼Œç„¶åå°†ç»“æ„ä½“çš„åœ°å€å€¼ä¼ é€’åˆ° select å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°ã€‚æ­¤æ—¶ï¼Œå³ä½¿æ–‡ä»¶æè¿°ç¬¦æœªå‘ç”Ÿå˜åŒ–ï¼Œåªè¦è¿‡äº†æŒ‡å®šæ—¶é—´ï¼Œä¹Ÿå¯ä»¥ä»å‡½æ•°ä¸­è¿”å›ã€‚ä¸è¿‡è¿™ç§æƒ…å†µä¸‹ï¼Œ select å‡½æ•°è¿”å› 0 ã€‚å› æ­¤ï¼Œå¯ä»¥é€šè¿‡è¿”å›å€¼äº†è§£åŸå› ã€‚å¦‚æœä¸å‘è®¾ç½®è¶…æ—¶ï¼Œåˆ™ä¼ é€’ NULL å‚æ•°ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1224-è°ƒç”¨-select-å‡½æ•°æŸ¥çœ‹ç»“æœ&#34;&gt;12.2.4 è°ƒç”¨ select å‡½æ•°æŸ¥çœ‹ç»“æœ&lt;/h4&gt;
&lt;p&gt;select è¿”å›æ­£æ•´æ•°æ—¶ï¼Œæ€æ ·è·çŸ¥å“ªäº›æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿäº†å˜åŒ–ï¼Ÿå‘ select å‡½æ•°çš„ç¬¬äºŒåˆ°ç¬¬å››ä¸ªå‚æ•°ä¼ é€’çš„ fd_set å˜é‡ä¸­å°†äº§ç”Ÿå¦‚å›¾æ‰€ç¤ºçš„å˜åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kA06dx.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç”±å›¾å¯çŸ¥ï¼Œselect å‡½æ•°è°ƒç”¨å®Œæˆå€™ï¼Œå‘å…¶ä¼ é€’çš„ fd_set å˜é‡å°†å‘ç”Ÿå˜åŒ–ã€‚åŸæ¥ä¸º 1 çš„æ‰€æœ‰ä½å°†å˜æˆ 0ï¼Œä½†æ˜¯å‘ç”Ÿäº†å˜åŒ–çš„æ–‡ä»¶æè¿°ç¬¦é™¤å¤–ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºå€¼ä»ä¸º 1 çš„ä½ç½®ä¸Šçš„æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿäº†å˜åŒ–ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1225-select-å‡½æ•°è°ƒç”¨ç¤ºä¾‹&#34;&gt;12.2.5 select å‡½æ•°è°ƒç”¨ç¤ºä¾‹&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ª select å‡½æ•°çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch12/select.c&#34;&gt;select.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;select&lt;/span&gt;.c -o &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;select&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./select
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kAjgW6.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœè¿è¡Œååœ¨æ ‡å‡†è¾“å…¥æµè¾“å…¥æ•°æ®ï¼Œå°±ä¼šåœ¨æ ‡å‡†è¾“å‡ºæµè¾“å‡ºæ•°æ®ï¼Œä½†æ˜¯å¦‚æœ 5 ç§’æ²¡æœ‰è¾“å…¥æ•°æ®ï¼Œå°±æç¤ºè¶…æ—¶ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1226-å®ç°-io-å¤ç”¨æœåŠ¡å™¨ç«¯&#34;&gt;12.2.6 å®ç° I/O å¤ç”¨æœåŠ¡å™¨ç«¯&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢é€šè¿‡ select å‡½æ•°å®ç° I/O å¤ç”¨æœåŠ¡å™¨ç«¯ã€‚ä¸‹é¢æ˜¯åŸºäº I/O å¤ç”¨çš„å›å£°æœåŠ¡å™¨ç«¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch12/echo_selectserv.c&#34;&gt;echo_selectserv.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc echo_selectserv.c -o selserv
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./selserv &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/23/kEkV8H.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶åªç”¨äº†ä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯å´å®ç°äº†å¯ä»¥å’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡ï¼Œè¿™éƒ½æ˜¯åˆ©ç”¨äº† select çš„ç‰¹ç‚¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;123-åŸºäº-windows-çš„å®ç°&#34;&gt;12.3 åŸºäº Windows çš„å®ç°&lt;/h3&gt;
&lt;p&gt;æš‚ç•¥&lt;/p&gt;
&lt;h3 id=&#34;124-ä¹ é¢˜&#34;&gt;12.4 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯·è§£é‡Šå¤ç”¨æŠ€æœ¯çš„é€šç”¨å«ä¹‰ï¼Œå¹¶è¯´æ˜ä½•ä¸º I/O å¤ç”¨ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šé€šç”¨å«ä¹‰ï¼šåœ¨ 1 ä¸ªé€šä¿¡é¢‘é“ä¸­ä¼ é€’å¤šä¸ªæ•°æ®ï¼ˆä¿¡å·ï¼‰çš„æŠ€æœ¯ã€‚IOå¤ç”¨å°±æ˜¯è¿›ç¨‹é¢„å…ˆå‘Šè¯‰å†…æ ¸éœ€è¦ç›‘è§†çš„IOæ¡ä»¶ï¼Œä½¿å¾—å†…æ ¸ä¸€æ—¦å‘ç°è¿›ç¨‹æŒ‡å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªIOæ¡ä»¶å°±ç»ªï¼Œå°±é€šè¿‡è¿›ç¨‹è¿›ç¨‹å¤„ç†ï¼Œä»è€Œä¸ä¼šåœ¨å•ä¸ªIOä¸Šé˜»å¡äº†ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒæ–‡ç« ï¼š&lt;a href=&#34;https://www.cnblogs.com/luoxn28/p/6220372.html&#34;&gt;Linuxç½‘ç»œç¼–ç¨‹-IOå¤ç”¨æŠ€æœ¯&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤šè¿›ç¨‹å¹¶å‘æœåŠ¡å™¨çš„ç¼ºç‚¹æœ‰å“ªäº›ï¼Ÿå¦‚ä½•åœ¨ I/O å¤ç”¨æœåŠ¡å™¨ä¸­å¼¥è¡¥ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šå¤šè¿›ç¨‹éœ€è¦è¿›è¡Œå¤§é‡çš„è¿ç®—å’Œå¤§é‡çš„å†…å­˜ç©ºé—´ã€‚åœ¨ I/O å¤ç”¨æœåŠ¡å™¨ä¸­é€šè¿‡ select å‡½æ•°ç›‘è§†æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡åˆ¤æ–­å˜åŒ–çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ¥å¾—çŸ¥å˜åŒ–çš„å¥—æ¥å­—æ˜¯å“ªä¸ªï¼Œä»è€Œå®æ—¶åº”ç­”æ¥è‡ªå¤šä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤ç”¨æœåŠ¡å™¨ç«¯éœ€è¦ select å‡½æ•°ã€‚ä¸‹åˆ—å…³äº select  å‡½æ•°ä½¿ç”¨æ–¹æ³•çš„æè¿°é”™è¯¯çš„æ˜¯ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä»¥ä¸‹åŠ ç²—çš„ä¸ºæ­£ç¡®çš„æè¿°ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è°ƒç”¨ select å‡½æ•°å‰éœ€è¦é›†ä¸­ I/O ç›‘è§†å¯¹è±¡çš„æ–‡ä»¶æè¿°ç¬¦&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‹¥å·²é€šè¿‡ select å‡½æ•°æ³¨å†Œä¸ºç›‘è§†å¯¹è±¡ï¼Œåˆ™åç»­è°ƒç”¨ select å‡½æ•°æ—¶æ— éœ€é‡å¤æ³¨å†Œ&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å¤ç”¨æœåŠ¡å™¨ç«¯åŒä¸€æ—¶é—´åªèƒ½æœåŠ¡äº 1 ä¸ªå®¢æˆ·ç«¯ï¼Œå› æ­¤ï¼Œéœ€è¦æœåŠ¡çš„å®¢æˆ·ç«¯æ¥å…¥æœåŠ¡å™¨ç«¯ååªèƒ½ç­‰å¾…&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸å¤šçº¿ç¨‹æœåŠ¡ç«¯ä¸åŒï¼ŒåŸºäº select çš„å¤ç”¨æœåŠ¡å™¨åªéœ€è¦ 1 ä¸ªè¿›ç¨‹ã€‚å› æ­¤ï¼Œå¯ä»¥å‡å°‘å› åˆ›å»ºå¤šè¿›ç¨‹äº§ç”Ÿçš„æœåŠ¡å™¨ç«¯çš„è´Ÿæ‹…&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;select å‡½æ•°çš„è§‚å¯Ÿå¯¹è±¡ä¸­åº”åŒ…å«æœåŠ¡ç«¯å¥—æ¥å­—ï¼ˆç›‘å¬å¥—æ¥å­—ï¼‰ï¼Œé‚£ä¹ˆåº”å°†å…¶åŒ…å«åˆ°å“ªä¸€ç±»ç›‘å¬å¯¹è±¡é›†åˆï¼Ÿè¯·è¯´æ˜åŸå› &lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç­”ï¼šåº”è¯¥åŒ…å«åˆ°ã€Œæ˜¯å¦å­˜åœ¨å¾…è¯»å–æ•°æ®ã€ï¼Œå› ä¸ºæœåŠ¡å™¨ç«¯éœ€è¦æŸ¥çœ‹å¥—æ¥å­—ä¸­æœ‰æ²¡æœ‰å¯ä»¥è¯»å–çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-12-%E7%AB%A0-i-o-%E5%A4%8D%E7%94%A8-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 11 ç«  è¿›ç¨‹é—´é€šä¿¡ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-11-%E7%AB%A0-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Fri, 01 Apr 2022 11:40:18 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-11-%E7%AB%A0-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-11-%E7%AB%A0-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-11-ç« -è¿›ç¨‹é—´é€šä¿¡&#34;&gt;ç¬¬ 11 ç«  è¿›ç¨‹é—´é€šä¿¡&lt;/h2&gt;
&lt;p&gt;è¿›ç¨‹é—´é€šä¿¡ï¼Œæ„å‘³ç€ä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹ä¸­å¯ä»¥äº¤æ¢æ•°æ®&lt;/p&gt;
&lt;h3 id=&#34;111-è¿›ç¨‹é—´é€šä¿¡çš„åŸºæœ¬æ¦‚å¿µ&#34;&gt;11.1 è¿›ç¨‹é—´é€šä¿¡çš„åŸºæœ¬æ¦‚å¿µ&lt;/h3&gt;
&lt;h4 id=&#34;1111-é€šè¿‡ç®¡é“å®ç°è¿›ç¨‹é—´é€šä¿¡&#34;&gt;11.1.1 é€šè¿‡ç®¡é“å®ç°è¿›ç¨‹é—´é€šä¿¡&lt;/h4&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯åŸºäºç®¡é“ï¼ˆPIPEï¼‰çš„è¿›ç¨‹é—´é€šä¿¡çš„æ¨¡å‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/22/kFlk0s.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œä¸ºäº†å®Œæˆè¿›ç¨‹é—´é€šä¿¡ï¼Œéœ€è¦åˆ›å»ºè¿›ç¨‹ã€‚ç®¡é“å¹¶éå±äºè¿›ç¨‹çš„èµ„æºï¼Œè€Œæ˜¯å’Œå¥—æ¥å­—ä¸€æ ·ï¼Œå±äºæ“ä½œç³»ç»Ÿï¼ˆä¹Ÿå°±ä¸æ˜¯ fork å‡½æ•°çš„å¤åˆ¶å¯¹è±¡ï¼‰ã€‚æ‰€ä»¥ï¼Œä¸¤ä¸ªè¿›ç¨‹é€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„å†…å­˜ç©ºé—´è¿›è¡Œé€šä¿¡ã€‚ä¸‹é¢æ˜¯åˆ›å»ºç®¡é“çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;pipe&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; filedes[&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;filedes[0]: é€šè¿‡ç®¡é“æ¥æ”¶æ•°æ®æ—¶ä½¿ç”¨çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå³ç®¡é“å‡ºå£
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;filedes[1]: é€šè¿‡ç®¡é“ä¼ è¾“æ•°æ®æ—¶ä½¿ç”¨çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå³ç®¡é“å…¥å£
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;çˆ¶è¿›ç¨‹åˆ›å»ºå‡½æ•°æ—¶å°†åˆ›å»ºç®¡é“ï¼ŒåŒæ—¶è·å–å¯¹åº”äºå‡ºå…¥å£çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ­¤æ—¶çˆ¶è¿›ç¨‹å¯ä»¥è¯»å†™åŒä¸€ç®¡é“ã€‚ä½†çˆ¶è¿›ç¨‹çš„ç›®çš„æ˜¯ä¸å­è¿›ç¨‹è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œå› æ­¤éœ€è¦å°†å…¥å£æˆ–å‡ºå£ä¸­çš„ 1 ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¼ é€’ç»™å­è¿›ç¨‹ã€‚ä¸‹é¢çš„ä¾‹å­æ˜¯å…³äºè¯¥å‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch11/pipe1.c&#34;&gt;pipe1.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#define BUF_SIZE 30
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; fds[&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; str[] = &lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Who are you?&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; buf[BUF_SIZE];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t pid;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#228b22&#34;&gt;// è°ƒç”¨  pipe å‡½æ•°åˆ›å»ºç®¡é“ï¼Œfds æ•°ç»„ä¸­ä¿å­˜ç”¨äº I/O çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    pipe(fds);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid = fork(); &lt;span style=&#34;color:#228b22&#34;&gt;//å­è¿›ç¨‹å°†åŒæ—¶æ‹¥æœ‰åˆ›å»ºç®¡é“è·å–çš„2ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå¤åˆ¶çš„å¹¶éç®¡é“ï¼Œè€Œæ˜¯æ–‡ä»¶æè¿°ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        write(fds[&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;], str, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(str));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        read(fds[&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;], buf, BUF_SIZE);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(buf);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc pipe1.c -o pipe1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./pipe1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Who are you?
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥ä»ç¨‹åºä¸­çœ‹å‡ºï¼Œé¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç®¡é“ï¼Œå­è¿›ç¨‹é€šè¿‡ fds[1] æŠŠæ•°æ®å†™å…¥ç®¡é“ï¼Œçˆ¶è¿›ç¨‹ä» fds[0] å†æŠŠæ•°æ®è¯»å‡ºæ¥ã€‚å¯ä»¥ä»ä¸‹å›¾çœ‹å‡ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/22/kF8A7d.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1112-é€šè¿‡ç®¡é“è¿›è¡Œè¿›ç¨‹é—´åŒå‘é€šä¿¡&#34;&gt;11.1.2 é€šè¿‡ç®¡é“è¿›è¡Œè¿›ç¨‹é—´åŒå‘é€šä¿¡&lt;/h4&gt;
&lt;p&gt;ä¸‹å›¾å¯ä»¥çœ‹å‡ºåŒå‘é€šä¿¡æ¨¡å‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/22/kF84De.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯åŒå‘é€šä¿¡çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch11/pipe2.c&#34;&gt;pipe2.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;25
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;26
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;27
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;28
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;29
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#define BUF_SIZE 30
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; fds[&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; str1[] = &lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Who are you?&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; str2[] = &lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Thank you for your message&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; buf[BUF_SIZE];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t pid;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pipe(fds);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid = fork();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        write(fds[&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;], str1, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(str1));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        read(fds[&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;], buf, BUF_SIZE);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child proc output: %s &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, buf);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        read(fds[&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;], buf, BUF_SIZE);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Parent proc output: %s &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, buf);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        write(fds[&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;], str2, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(str2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;3&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc pipe2.c -o pipe2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./pipe2
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Parent proc output: Who are you?
Child proc output: Thank you for your message
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿è¡Œç»“æœæ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯å¦‚æœæ³¨é‡Šæ‰ç¬¬18è¡Œçš„ä»£ç ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ï¼Œå¯¼è‡´ä¸€ç›´ç­‰å¾…ä¸‹å»ã€‚å› ä¸ºæ•°æ®è¿›å…¥ç®¡é“åå˜æˆäº†æ— ä¸»æ•°æ®ã€‚ä¹Ÿå°±æ˜¯é€šè¿‡ read å‡½æ•°å…ˆè¯»å–æ•°æ®çš„è¿›ç¨‹å°†å¾—åˆ°æ•°æ®ï¼Œå³ä½¿è¯¥è¿›ç¨‹å°†æ•°æ®ä¼ åˆ°äº†ç®¡é“ã€‚å› ä¸ºï¼Œæ³¨é‡Šç¬¬18è¡Œä¼šäº§ç”Ÿé—®é¢˜ã€‚ç¬¬19è¡Œï¼Œè‡ªå·±æˆå°†è¯»å›è‡ªå·±åœ¨ç¬¬ 17 è¡Œå‘ç®¡é“å‘é€çš„æ•°æ®ã€‚ç»“æœçˆ¶è¿›ç¨‹è°ƒç”¨ read å‡½æ•°åï¼Œæ— é™æœŸç­‰å¾…æ•°æ®è¿›å…¥ç®¡é“ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä¸€ä¸ªç®¡é“ä¸æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå°±éœ€è¦åˆ›å»ºä¸¤ä¸ªç®¡é“ï¼Œå„è‡ªè´Ÿè´£ä¸åŒçš„æ•°æ®æµåŠ¨ï¼Œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/22/kFJW0e.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢é‡‡ç”¨ä¸Šè¿°æ¨¡å‹æ”¹è¿› &lt;code&gt;pipe2.c&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch11/pipe3.c&#34;&gt;pipe3.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;25
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;26
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;27
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#define BUF_SIZE 30
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; fds1[&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;], fds2[&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; str1[] = &lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Who are you?&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; str2[] = &lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Thank you for your message&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; buf[BUF_SIZE];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t pid;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pipe(fds1), pipe(fds2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid = fork();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        write(fds1[&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;], str1, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(str1));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        read(fds2[&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;], buf, BUF_SIZE);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child proc output: %s &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, buf);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        read(fds1[&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;], buf, BUF_SIZE);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Parent proc output: %s &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, buf);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        write(fds2[&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;], str2, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(str2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸Šé¢é€šè¿‡åˆ›å»ºä¸¤ä¸ªç®¡é“å®ç°äº†åŠŸèƒ½ï¼Œæ­¤æ—¶ï¼Œä¸éœ€è¦é¢å¤–å†ä½¿ç”¨ sleep å‡½æ•°ã€‚è¿è¡Œç»“æœå’Œä¸Šé¢ä¸€æ ·ã€‚&lt;/p&gt;
&lt;h3 id=&#34;112-è¿ç”¨è¿›ç¨‹é—´é€šä¿¡&#34;&gt;11.2 è¿ç”¨è¿›ç¨‹é—´é€šä¿¡&lt;/h3&gt;
&lt;h4 id=&#34;1121-ä¿å­˜æ¶ˆæ¯çš„å›å£°æœåŠ¡å™¨&#34;&gt;11.2.1 ä¿å­˜æ¶ˆæ¯çš„å›å£°æœåŠ¡å™¨&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢å¯¹ç¬¬ 10 ç« çš„ &lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/echo_mpserv.c&#34;&gt;echo_mpserv.c&lt;/a&gt; è¿›è¡Œæ”¹è¿›ï¼Œæ·»åŠ ä¸€ä¸ªåŠŸèƒ½ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å°†å›å£°å®¢æˆ·ç«¯ä¼ è¾“çš„å­—ç¬¦ä¸²æŒ‰åºä¿å­˜åˆ°æ–‡ä»¶ä¸­&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®ç°è¯¥ä»»åŠ¡å°†åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œä»å‘å®¢æˆ·ç«¯æä¾›æœåŠ¡çš„è¿›ç¨‹è¯»å–å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œä¸‹é¢æ˜¯ä»£ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch11/echo_storeserv.c&#34;&gt;echo_storeserv.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc echo_storeserv.c -o serv
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./serv &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ­¤æœåŠ¡ç«¯é…åˆç¬¬ 10 ç« çš„å®¢æˆ·ç«¯ &lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/echo_mpclient.c&#34;&gt;echo_mpclient.c&lt;/a&gt; ä½¿ç”¨ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/22/kFUCct.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/22/kFUAHS.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒæœåŠ¡ç«¯å·²ç»ç”Ÿæˆäº†æ–‡ä»¶ï¼ŒæŠŠå®¢æˆ·ç«¯çš„æ¶ˆæ¯ä¿å­˜å¯ä¸‹æ¥ï¼Œåªä¿å­˜äº†10æ¬¡æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;113-ä¹ é¢˜&#34;&gt;11.3 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»€ä¹ˆæ˜¯è¿›ç¨‹é—´é€šä¿¡ï¼Ÿåˆ†åˆ«ä»æ¦‚å¿µå’Œå†…å­˜çš„è§’åº¦è¿›è¡Œè¯´æ˜ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šè¿›ç¨‹é—´é€šä¿¡æ„å‘³ç€ä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹é—´å¯ä»¥äº¤æ¢æ•°æ®ã€‚ä»å†…å­˜ä¸Šæ¥è¯´ï¼Œå°±æ˜¯ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€ä¸ªå†…å­˜åŒºåŸŸï¼Œç„¶åé€šè¿‡è¿™ä¸ªå†…å­˜åŒºåŸŸæ•°æ®çš„å˜åŒ–æ¥è¿›è¡Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¿›ç¨‹é—´é€šä¿¡éœ€è¦ç‰¹æ®Šçš„ IPC æœºåˆ¶ï¼Œè¿™æ˜¯ç”±äºæ“ä½œç³»ç»Ÿæä¾›çš„ã€‚è¿›ç¨‹é—´é€šä¿¡æ—¶ä¸ºä½•éœ€è¦æ“ä½œç³»ç»Ÿçš„å¸®åŠ©ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä¸ºäº†è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡ï¼Œéœ€è¦ç®¡é“çš„å¸®åŠ©ï¼Œä½†æ˜¯ç®¡é“ä¸æ˜¯è¿›ç¨‹çš„èµ„æºï¼Œå®ƒå±äºä»æ“ä½œç³»ç»Ÿï¼Œæ‰€ä»¥ï¼Œä¸¤ä¸ªè¿›ç¨‹é€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„å†…å­˜ç©ºé—´è¿›è¡Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ã€Œç®¡é“ã€æ˜¯å…¸å‹çš„ IPC æŠ€æ³•ã€‚å…³äºç®¡é“ï¼Œè¯·å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç®¡é“æ˜¯è¿›ç¨‹é—´äº¤æ¢æ•°æ®çš„è·¯å¾„ã€‚å¦‚ä½•åˆ›å»ºæ­¤è·¯å¾„ï¼Ÿç”±è°åˆ›å»ºï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä½¿ç”¨ pipe å‡½æ•°è¿›è¡Œåˆ›å»ºï¼Œç”±æ“ä½œç³»ç»Ÿåˆ›å»ºã€‚çˆ¶è¿›ç¨‹è°ƒç”¨è¯¥å‡½æ•°æ—¶å°†åˆ›å»ºç®¡é“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºäº†å®Œæˆè¿›ç¨‹é—´é€šä¿¡ã€‚2 ä¸ªè¿›ç¨‹è¦åŒæ—¶è¿æ¥ç®¡é“ã€‚é‚£2 ä¸ªè¿›ç¨‹å¦‚ä½•è¿æ¥åˆ°åŒä¸€ç®¡é“ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šæ•°ç»„ä¸­æœ‰ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œçˆ¶å­è¿›ç¨‹è°ƒç”¨ç›¸å…³å‡½æ•°æ—¶ï¼Œé€šè¿‡ fork å‡½æ•°ï¼ŒæŠŠ 1 ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¼ é€’ç»™å­è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç®¡é“å…è®¸ 2 ä¸ªè¿›ç¨‹é—´çš„åŒå‘é€šä¿¡ã€‚åŒå‘é€šä¿¡ä¸­éœ€è¦æ³¨æ„å“ªäº›å†…å®¹ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šå‘ç®¡é“ä¼ è¾“æ•°æ®æ—¶ï¼Œå…ˆè¯»çš„è¿›ç¨‹ä¼šæŠŠæ•°æ®å–èµ°ã€‚ç®€è¨€ä¹‹ï¼Œå°±æ˜¯æ•°æ®è¿›å…¥ç®¡é“å€™ä¼šå˜æˆæ— ä¸»æ•°æ®ï¼Œæ‰€ä»¥æœ‰æ—¶å€™ä¸ºäº†é˜²æ­¢é”™è¯¯ï¼Œéœ€è¦å¤šä¸ªç®¡é“æ¥è¿›ç¨‹é€šä¿¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-11-%E7%AB%A0-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€Šæ¨¡å¼è¯†åˆ«&amp;æœºå™¨å­¦ä¹ ã€‹è¯¾åä½œä¸šï¼ˆ1ï¼‰</title>
        <link>https://caixiongjiang.github.io/blog/2022/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AF%BE%E5%90%8E%E4%BD%9C%E4%B8%9A1/</link>
        <pubDate>Thu, 31 Mar 2022 18:07:05 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AF%BE%E5%90%8E%E4%BD%9C%E4%B8%9A1/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AF%BE%E5%90%8E%E4%BD%9C%E4%B8%9A1/ -&lt;h2 id=&#34;æ¨¡å¼è¯†åˆ«æœºå™¨å­¦ä¹ è¯¾åä½œä¸š&#34;&gt;ã€Šæ¨¡å¼è¯†åˆ«&amp;amp;æœºå™¨å­¦ä¹ ã€‹è¯¾åä½œä¸š&lt;/h2&gt;
&lt;h3 id=&#34;ä½œä¸šä¸€&#34;&gt;ä½œä¸šä¸€&lt;/h3&gt;
&lt;p&gt;å†™ä¸€ä¸ªæ„ŸçŸ¥å™¨ç®—æ³•ï¼Œç”¨æ¥åŒºåˆ†1åˆ°10é‡Œçš„ä»»æ„ä¸¤ä¸ªæ•°å­—ï¼Œå¹¶ä¸çœŸå®ç»“æœè¿›è¡Œæ¯”è¾ƒã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä»£ç å®ç°&#34;&gt;ä»£ç å®ç°&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Perceptron.m(ä¸»å‡½æ•°)ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;25
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;26
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;27
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;28
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;29
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;30
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;31
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;32
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;33
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;34
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;35
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;36
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;37
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;38
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;39
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;40
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;41
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;42
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;43
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;44
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;45
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;46
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;47
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;48
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;49
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;50
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;51
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;52
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;53
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;54
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;55
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;56
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;57
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;58
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;59
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;60
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;61
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;62
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;63
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;64
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;65
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;66
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;67
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;68
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;69
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;70
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;71
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;72
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;73
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;74
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;75
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;76
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;77
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-matlab&#34; data-lang=&#34;matlab&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;%Perceptron.m&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;clear variables
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;clc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% è¯»å–æ•°æ®&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;load (&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#39;test_images.mat&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;load (&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#39;test_labels.mat&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% è®¾å®šæ•°æ®é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;train_num = &lt;span style=&#34;color:#b452cd&#34;&gt;1000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;test_num =&lt;span style=&#34;color:#b452cd&#34;&gt;200&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% ä¸´æ—¶å˜é‡ä»¥åŠå„ä¸ªæ„ŸçŸ¥å™¨å‚æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#658b00&#34;&gt;j&lt;/span&gt; = &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;lr = &lt;span style=&#34;color:#b452cd&#34;&gt;0.1&lt;/span&gt;;&lt;span style=&#34;color:#228b22&#34;&gt;%å­¦ä¹ ç‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;epoch = &lt;span style=&#34;color:#b452cd&#34;&gt;70&lt;/span&gt;;&lt;span style=&#34;color:#228b22&#34;&gt;%è®¾å®šè®­ç»ƒå¤šå°‘è½®&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;number = [&lt;span style=&#34;color:#b452cd&#34;&gt;4&lt;/span&gt;,&lt;span style=&#34;color:#b452cd&#34;&gt;8&lt;/span&gt;];&lt;span style=&#34;color:#228b22&#34;&gt;%è¦å–çš„æ•°å­—ç»„åˆ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% æå–æ•°æ®ä¸­æ ‡ç­¾ä¸ºä»»æ„ç»„åˆçš„æ ·æœ¬ï¼Œå…±è®¡200ä¸ª&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% ç”±äºæ•°æ®æœ¬èº«æ‰“ä¹±è¿‡ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å–200ä¸ªè€Œä¸è€ƒè™‘æ ·æœ¬ä¸å‡è¡¡é—®é¢˜&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;%æå–æ•°å­—4å’Œ8çš„æ ·æœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#658b00&#34;&gt;i&lt;/span&gt; = &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:&lt;span style=&#34;color:#b452cd&#34;&gt;10000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; test_labels1(&lt;span style=&#34;color:#658b00&#34;&gt;i&lt;/span&gt;)==number(&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;)|| test_labels1(&lt;span style=&#34;color:#658b00&#34;&gt;i&lt;/span&gt;)==number(&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        data(:,:,&lt;span style=&#34;color:#658b00&#34;&gt;j&lt;/span&gt;) = test_images(:,:,&lt;span style=&#34;color:#658b00&#34;&gt;i&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        label(&lt;span style=&#34;color:#658b00&#34;&gt;j&lt;/span&gt;) = test_labels1(&lt;span style=&#34;color:#658b00&#34;&gt;i&lt;/span&gt;);&lt;span style=&#34;color:#228b22&#34;&gt;%å–ç›¸åº”æ ‡ç­¾&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#658b00&#34;&gt;j&lt;/span&gt;=&lt;span style=&#34;color:#658b00&#34;&gt;j&lt;/span&gt;+&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#658b00&#34;&gt;j&lt;/span&gt;&amp;gt;train_num+test_num
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% ç”±äºæ„ŸçŸ¥å™¨è¾“å‡ºç»“æœä»…ä¸º0ã€1ï¼Œå› æ­¤è¦å°†æ ‡ç­¾è¿›è¡Œè½¬æ¢&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% æœ¬ç¨‹åºä¸­ï¼Œç”±äºmatlabè®¡ç®—ä¸ç­‰å¼ç›¸å¯¹å®¹æ˜“ï¼Œå› æ­¤æ²¡æœ‰å¯¹æ ·æœ¬è¿›è¡Œè§„èŒƒåŒ–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% ç”±äºæ²¡æœ‰è¿›è¡Œè§„èŒƒåŒ–ï¼Œåé¢æ›´æ–°æƒå€¼wéœ€è¦å€ŸåŠ©æ ‡ç­¾ï¼Œå› æ­¤æ ‡ç­¾éœ€è¦ç½®-1å’Œ1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; k = &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:train_num+test_num
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; label(k)==number(&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        label(k)=-&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; label(k)==number(&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        label(k)=&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;data_ = liansuyun_mat2vector(data, train_num + test_num);&lt;span style=&#34;color:#228b22&#34;&gt;%çŸ©é˜µè½¬å‘é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;%æ•°æ®å½’ä¸€åŒ–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;%   [data_,PS]=mapminmax(data_);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;%train_data =[data_(1:train_num,:) label1(1:train_num,1)];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;test_data = [data_(train_num+&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:train_num+test_num,:),&lt;span style=&#34;color:#658b00&#34;&gt;ones&lt;/span&gt;(test_num,&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;)];&lt;span style=&#34;color:#228b22&#34;&gt;%è¿™é‡Œå¯¹æµ‹è¯•æ•°æ®ä¹Ÿè¿›è¡Œå¢å¹¿å˜æ¢&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% test_data = data_(train_num+1:train_num+test_num,:);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% è®­ç»ƒæƒå€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;w=perceptionLearn(data_(&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:train_num,:),label(&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:train_num),lr,epoch);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% æµ‹è¯•ï¼ˆé¢„æµ‹ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; k = &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:test_num
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; test_data(k,:)*w&amp;#39;&amp;gt;&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        result(k) = &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        result(k) = -&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% è¾“å‡ºé¢„æµ‹çš„å‡†ç¡®ç‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;acc = &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sum=&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sum1=&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; sample = &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:test_num
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; result(sample)==label(train_num+sample)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        acc = acc+&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        fprintf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#39;åˆ†ç±»é”™è¯¯çš„åºå·ä¸ºï¼š%d\n&amp;#39;&lt;/span&gt;,sample);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum=sum+&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sum1=test_num-sum;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fprintf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#39;åˆ†ç±»é”™è¯¯çš„ä¸ªæ•°ä¸ºï¼š%d,åˆ†ç±»æ­£ç¡®çš„ä¸ªæ•°ä¸ºï¼š%d\n&amp;#39;&lt;/span&gt;,sum,sum1);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fprintf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#39;ç²¾ç¡®åº¦ä¸ºï¼š%5.2f%%\n&amp;#39;&lt;/span&gt;,(acc/test_num)*&lt;span style=&#34;color:#b452cd&#34;&gt;100&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;perceptionLearn.mï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-matlab&#34; data-lang=&#34;matlab&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;%% perceptionLearn.m&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% å‡½æ•°è¾“å…¥ï¼šæ•°æ®ï¼ˆè¡Œå‘é‡ï¼‰ï¼Œæ ‡ç­¾ï¼Œå­¦ä¹ ç‡ï¼Œç»ˆæ­¢è½®æ¬¡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% è¾“å‡ºï¼šè®­ç»ƒå¾—åˆ°çš„æƒå€¼å‘é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% è®­ç»ƒæ–¹æ³•ï¼šå•æ ·æœ¬ä¿®æ­£ï¼Œå­¦ä¹ ç‡ï¼ˆæ­¥é•¿ï¼‰é‡‡ç”¨äº†å›ºå®šå€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color:#bbb&#34;&gt; &lt;/span&gt;[w]=&lt;span style=&#34;color:#008b45&#34;&gt;perceptionLearn&lt;/span&gt;(x,y,learningRate,maxEpoch)&lt;span style=&#34;color:#bbb&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#bbb&#34;&gt;    &lt;/span&gt;[rows,cols]=&lt;span style=&#34;color:#658b00&#34;&gt;size&lt;/span&gt;(x);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    x=[x,&lt;span style=&#34;color:#658b00&#34;&gt;ones&lt;/span&gt;(rows,&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;)];&lt;span style=&#34;color:#228b22&#34;&gt;%å¢å¹¿&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    w=&lt;span style=&#34;color:#658b00&#34;&gt;zeros&lt;/span&gt;(&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;,cols+&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;);&lt;span style=&#34;color:#228b22&#34;&gt;%åŒä¸Š&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; epoch=&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:maxEpoch&lt;span style=&#34;color:#228b22&#34;&gt;%ä¸å¯åˆ†æƒ…å†µä¸‹æ•´ä½“è¿­ä»£è½®æ¬¡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        flag=true;&lt;span style=&#34;color:#228b22&#34;&gt;%æ ‡å¿—ä½çœŸåˆ™è®­ç»ƒå®Œæ¯•&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; sample=&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;:rows
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#658b00&#34;&gt;sign&lt;/span&gt;(x(sample,:)*w&amp;#39;)~=y(sample)&lt;span style=&#34;color:#228b22&#34;&gt;%åˆ†ç±»æ˜¯å¦æ­£ç¡®ï¼Ÿé”™è¯¯åˆ™æ›´æ–°æƒå€¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                flag=false;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#228b22&#34;&gt;%è¿™é‡Œå’Œæ•™æ¡ˆç¨æœ‰ä¸åŒï¼Œä¸è¿›è¡Œè§„èŒƒåŒ–ï¼Œé‚£ä¹ˆæ›´æ–°æƒå€¼æ—¶éœ€è¦æ ‡ç­¾æ¥å……å½“æ¢¯åº¦æ–¹å‘çš„å˜é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                w=w+learningRate*y(sample)*x(sample,:);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; flag==true
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;liansuyun_mat2vector.mï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-matlab&#34; data-lang=&#34;matlab&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;%% liansuyun_mat2vector.m&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% å‡½æ•°è¾“å…¥ï¼šæ•°æ®ï¼ˆä¸‰ç»´æ•°æ®ï¼‰ï¼Œæ•°æ®ä¸ªæ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% è¾“å‡ºï¼šæ•°æ®ï¼ˆ1200ä¸ªä¸€ç»´å‘é‡ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;% åŠŸèƒ½ï¼šå°†æ¯ä¸€ä¸ªäºŒç»´çŸ©é˜µå˜ä¸º1ç»´å‘é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color:#bbb&#34;&gt; &lt;/span&gt;[w]=&lt;span style=&#34;color:#008b45&#34;&gt;liansuyun_mat2vector&lt;/span&gt;(mat, maxCnt)&lt;span style=&#34;color:#bbb&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#bbb&#34;&gt;    &lt;/span&gt;w = [];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#658b00&#34;&gt;i&lt;/span&gt; = &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt; : maxCnt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        mat1 = mat(:,:,&lt;span style=&#34;color:#658b00&#34;&gt;i&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [x, y] = &lt;span style=&#34;color:#658b00&#34;&gt;size&lt;/span&gt;(mat1);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        mat2 = mat1&amp;#39;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        mat3 = &lt;span style=&#34;color:#658b00&#34;&gt;reshape&lt;/span&gt;(mat2, &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;, x * y);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        w = [w; mat3];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;ç»“æœ&#34;&gt;ç»“æœ&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹4å’Œ8è¿›è¡Œåˆ†ç±»ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;åˆ†ç±»é”™è¯¯çš„åºå·ä¸ºï¼š166
åˆ†ç±»é”™è¯¯çš„ä¸ªæ•°ä¸ºï¼š1,åˆ†ç±»æ­£ç¡®çš„ä¸ªæ•°ä¸ºï¼š199
ç²¾ç¡®åº¦ä¸ºï¼š99.50%
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å¯¹1å’Œ9è¿›è¡Œåˆ†ç±»ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;åˆ†ç±»é”™è¯¯çš„ä¸ªæ•°ä¸ºï¼š0,åˆ†ç±»æ­£ç¡®çš„ä¸ªæ•°ä¸ºï¼š200
ç²¾ç¡®åº¦ä¸ºï¼š100.00%
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å¯¹2å’Œ6è¿›è¡Œåˆ†ç±»ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;åˆ†ç±»é”™è¯¯çš„åºå·ä¸ºï¼š188
åˆ†ç±»é”™è¯¯çš„ä¸ªæ•°ä¸ºï¼š1,åˆ†ç±»æ­£ç¡®çš„ä¸ªæ•°ä¸ºï¼š199
ç²¾ç¡®åº¦ä¸ºï¼š99.50%
&lt;/code&gt;&lt;/pre&gt;- https://caixiongjiang.github.io/blog/2022/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AF%BE%E5%90%8E%E4%BD%9C%E4%B8%9A1/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 10 ç«  å¤šè¿›ç¨‹æœåŠ¡å™¨ç«¯ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-10-%E7%AB%A0-%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Wed, 30 Mar 2022 15:59:25 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-10-%E7%AB%A0-%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-10-%E7%AB%A0-%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-10-ç« -å¤šè¿›ç¨‹æœåŠ¡å™¨ç«¯&#34;&gt;ç¬¬ 10 ç«  å¤šè¿›ç¨‹æœåŠ¡å™¨ç«¯&lt;/h2&gt;
&lt;h3 id=&#34;101-è¿›ç¨‹æ¦‚å¿µåŠåº”ç”¨&#34;&gt;10.1 è¿›ç¨‹æ¦‚å¿µåŠåº”ç”¨&lt;/h3&gt;
&lt;h4 id=&#34;1011-å¹¶å‘æœåŠ¡ç«¯çš„å®ç°æ–¹æ³•&#34;&gt;10.1.1 å¹¶å‘æœåŠ¡ç«¯çš„å®ç°æ–¹æ³•&lt;/h4&gt;
&lt;p&gt;é€šè¿‡æ”¹è¿›æœåŠ¡ç«¯ï¼Œä½¿å…¶åŒæ—¶å‘æ‰€æœ‰å‘èµ·è¯·æ±‚çš„å®¢æˆ·ç«¯æä¾›æœåŠ¡ï¼Œä»¥æé«˜å¹³å‡æ»¡æ„åº¦ã€‚è€Œä¸”ï¼Œç½‘ç»œç¨‹åºä¸­æ•°æ®é€šä¿¡æ—¶é—´æ¯” CPU è¿ç®—æ—¶é—´å æ¯”æ›´å¤§ï¼Œå› æ­¤ï¼Œå‘å¤šä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡æ˜¯ä¸€ç§æœ‰æ•ˆçš„åˆ©ç”¨ CPU çš„æ–¹å¼ã€‚æ¥ä¸‹æ¥è®¨è®ºåŒæ—¶å‘å¤šä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡çš„å¹¶å‘æœåŠ¡å™¨ç«¯ã€‚ä¸‹é¢åˆ—å‡ºçš„æ˜¯å…·æœ‰ä»£è¡¨æ€§çš„å¹¶å‘æœåŠ¡ç«¯çš„å®ç°æ¨¡å‹å’Œæ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤šè¿›ç¨‹æœåŠ¡å™¨ï¼šé€šè¿‡åˆ›å»ºå¤šä¸ªè¿›ç¨‹æä¾›æœåŠ¡&lt;/li&gt;
&lt;li&gt;å¤šè·¯å¤ç”¨æœåŠ¡å™¨ï¼šé€šè¿‡æ†ç»‘å¹¶ç»Ÿä¸€ç®¡ç† I/O å¯¹è±¡æä¾›æœåŠ¡&lt;/li&gt;
&lt;li&gt;å¤šçº¿ç¨‹æœåŠ¡å™¨ï¼šé€šè¿‡ç”Ÿæˆä¸å®¢æˆ·ç«¯ç­‰é‡çš„çº¿ç¨‹æä¾›æœåŠ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…ˆæ˜¯ç¬¬ä¸€ç§æ–¹æ³•ï¼šå¤šè¿›ç¨‹æœåŠ¡å™¨&lt;/p&gt;
&lt;h4 id=&#34;1012-ç†è§£è¿›ç¨‹&#34;&gt;10.1.2 ç†è§£è¿›ç¨‹&lt;/h4&gt;
&lt;p&gt;è¿›ç¨‹çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å ç”¨å†…å­˜ç©ºé—´çš„æ­£åœ¨è¿è¡Œçš„ç¨‹åº&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‡å¦‚ä½ ä¸‹è½½äº†ä¸€ä¸ªæ¸¸æˆåˆ°ç”µè„‘ä¸Šï¼Œæ­¤æ—¶çš„æ¸¸æˆä¸æ˜¯è¿›ç¨‹ï¼Œè€Œæ˜¯ç¨‹åºã€‚åªæœ‰å½“æ¸¸æˆè¢«åŠ è½½åˆ°ä¸»å†…å­˜å¹¶è¿›å…¥è¿è¡ŒçŠ¶æ€ï¼Œè¿™æ˜¯æ‰å¯ç§°ä¸ºè¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1013-è¿›ç¨‹-id&#34;&gt;10.1.3 è¿›ç¨‹ ID&lt;/h4&gt;
&lt;p&gt;åœ¨è¯´è¿›ç¨‹åˆ›å»ºæ–¹æ³•ä¹‹å‰ï¼Œå…ˆè¦ç®€è¦è¯´æ˜è¿›ç¨‹ IDã€‚æ— è®ºè¿›ç¨‹æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½ä¼šè¢«æ“ä½œç³»ç»Ÿåˆ†é…ä¸€ä¸ª IDã€‚æ­¤ ID è¢«ç§°ä¸ºã€Œè¿›ç¨‹IDã€ï¼Œå…¶å€¼ä¸ºå¤§äº 2 çš„è¯ä¹¦ã€‚1 è¦åˆ†é…ç»™æ“ä½œç³»ç»Ÿå¯åŠ¨åçš„ï¼ˆç”¨äºååŠ©æ“ä½œç³»ç»Ÿï¼‰é¦–ä¸ªè¿›ç¨‹ï¼Œå› æ­¤ç”¨æˆ·æ— æ³•å¾—åˆ° ID å€¼ä¸º 1 ã€‚æ¥ä¸‹æ¥è§‚å¯Ÿåœ¨ Linux ä¸­è¿è¡Œçš„è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ps au
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é€šè¿‡ä¸Šé¢çš„å‘½ä»¤å¯æŸ¥çœ‹å½“å‰è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥å‘½ä»¤åŒæ—¶åˆ—å‡ºäº† PIDï¼ˆè¿›ç¨‹IDï¼‰ã€‚å‚æ•° a å’Œ uåˆ—å‡ºäº†æ‰€æœ‰è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c43d7c1f2a8b.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1014-é€šè¿‡è°ƒç”¨-fork-å‡½æ•°åˆ›å»ºè¿›ç¨‹&#34;&gt;10.1.4 é€šè¿‡è°ƒç”¨ fork å‡½æ•°åˆ›å»ºè¿›ç¨‹&lt;/h4&gt;
&lt;p&gt;åˆ›å»ºè¿›ç¨‹çš„æ–¹å¼å¾ˆå¤šï¼Œæ­¤å¤„åªä»‹ç»ç”¨äºåˆ›å»ºå¤šè¿›ç¨‹æœåŠ¡ç«¯çš„ fork å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;pid_t &lt;span style=&#34;color:#008b45&#34;&gt;fork&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;// æˆåŠŸæ—¶è¿”å›è¿›ç¨‹ID,å¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;fork å‡½æ•°å°†åˆ›å»ºè°ƒç”¨çš„è¿›ç¨‹å‰¯æœ¬ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¹¶éæ ¹æ®å®Œå…¨ä¸åŒçš„ç¨‹åºåˆ›å»ºè¿›ç¨‹ï¼Œè€Œæ˜¯å¤åˆ¶æ­£åœ¨è¿è¡Œçš„ã€è°ƒç”¨ fork å‡½æ•°çš„è¿›ç¨‹ã€‚å¦å¤–ï¼Œä¸¤ä¸ªè¿›ç¨‹éƒ½æ‰§è¡Œ fork å‡½æ•°è°ƒç”¨åçš„è¯­å¥ï¼ˆå‡†ç¡®çš„è¯´æ˜¯åœ¨ fork å‡½æ•°è¿”å›åï¼‰ã€‚ä½†å› ä¸ºæ˜¯é€šè¿‡åŒä¸€ä¸ªè¿›ç¨‹ã€å¤åˆ¶ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼Œä¹‹åçš„ç¨‹åºæµè¦æ ¹æ® fork å‡½æ•°çš„è¿”å›å€¼åŠ ä»¥åŒºåˆ†ã€‚å³åˆ©ç”¨ fork å‡½æ•°çš„å¦‚ä¸‹ç‰¹ç‚¹åŒºåˆ†ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çˆ¶è¿›ç¨‹ï¼šfork å‡½æ•°è¿”å›å­è¿›ç¨‹ ID&lt;/li&gt;
&lt;li&gt;å­è¿›ç¨‹ï¼šfork å‡½æ•°è¿”å› 0&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ­¤å¤„ï¼Œã€Œçˆ¶è¿›ç¨‹ã€ï¼ˆParent Processï¼‰æŒ‡åŸè¿›ç¨‹ï¼Œå³è°ƒç”¨ fork å‡½æ•°çš„ä¸»ä½“ï¼Œè€Œã€Œå­è¿›ç¨‹ã€ï¼ˆChild Processï¼‰æ˜¯é€šè¿‡çˆ¶è¿›ç¨‹è°ƒç”¨ fork å‡½æ•°å¤åˆ¶å‡ºçš„è¿›ç¨‹ã€‚æ¥ä¸‹æ¥æ˜¯è°ƒç”¨ fork å‡½æ•°åçš„ç¨‹åºè¿è¡Œæµç¨‹ã€‚å¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c43da5412b90.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œçˆ¶è¿›ç¨‹è°ƒç”¨ fork å‡½æ•°çš„åŒæ—¶å¤åˆ¶å‡ºå­è¿›ç¨‹ï¼Œå¹¶åˆ†åˆ«å¾—åˆ° fork å‡½æ•°çš„è¿”å›å€¼ã€‚ä½†å¤åˆ¶å‰ï¼Œçˆ¶è¿›ç¨‹å°†å…¨å±€å˜é‡ gval å¢åŠ åˆ° 11,å°†å±€éƒ¨å˜é‡ lval çš„å€¼å¢åŠ åˆ° 25ï¼Œå› æ­¤åœ¨è¿™ç§çŠ¶æ€ä¸‹å®Œæˆè¿›ç¨‹å¤åˆ¶ã€‚å¤åˆ¶å®Œæˆåæ ¹æ® fork å‡½æ•°çš„è¿”å›ç±»å‹åŒºåˆ†çˆ¶å­è¿›ç¨‹ã€‚çˆ¶è¿›ç¨‹çš„ lval çš„å€¼å¢åŠ  1 ï¼Œä½†è¿™ä¸ä¼šå½±å“å­è¿›ç¨‹çš„ lval å€¼ã€‚åŒæ ·å­è¿›ç¨‹å°† gval çš„å€¼å¢åŠ  1 ä¹Ÿä¸ä¼šå½±å“åˆ°çˆ¶è¿›ç¨‹çš„ gval ã€‚å› ä¸º fork å‡½æ•°è°ƒç”¨ååˆ†æˆäº†å®Œå…¨ä¸åŒçš„è¿›ç¨‹ï¼Œåªæ˜¯äºŒè€…å…±äº«åŒä¸€æ®µä»£ç è€Œå·²ã€‚æ¥ä¸‹æ¥ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/fork.c&#34;&gt;fork.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; gval = &lt;span style=&#34;color:#b452cd&#34;&gt;10&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t pid;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; lval = &lt;span style=&#34;color:#b452cd&#34;&gt;20&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    gval++, lval += &lt;span style=&#34;color:#b452cd&#34;&gt;5&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid = fork();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        gval += &lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;, lval += &lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        gval -= &lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;, lval -= &lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child Proc: [%d,%d] &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, gval, lval);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Parent Proc: [%d,%d] &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, gval, lval);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc fork.c -o fork
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./fork
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c43e054e7f6f.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œå½“æ‰§è¡Œäº† fork å‡½æ•°ä¹‹åï¼Œæ­¤åå°±ç›¸å½“äºæœ‰äº†ä¸¤ä¸ªç¨‹åºåœ¨æ‰§è¡Œä»£ç ï¼Œå¯¹äºçˆ¶è¿›ç¨‹æ¥è¯´ï¼Œfork å‡½æ•°è¿”å›çš„æ˜¯å­è¿›ç¨‹çš„IDï¼Œå¯¹äºå­è¿›ç¨‹æ¥è¯´ï¼Œfork å‡½æ•°è¿”å› 0ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªå˜é‡ï¼Œçˆ¶è¿›ç¨‹è¿›è¡Œäº† +2 æ“ä½œ ï¼Œè€Œå­è¿›ç¨‹è¿›è¡Œäº† -2 æ“ä½œï¼Œæ‰€ä»¥ç»“æœæ˜¯è¿™æ ·ã€‚&lt;/p&gt;
&lt;h3 id=&#34;102-è¿›ç¨‹å’Œåƒµå°¸è¿›ç¨‹&#34;&gt;10.2 è¿›ç¨‹å’Œåƒµå°¸è¿›ç¨‹&lt;/h3&gt;
&lt;p&gt;æ–‡ä»¶æ“ä½œä¸­ï¼Œå…³é—­æ–‡ä»¶å’Œæ‰“å¼€æ–‡ä»¶åŒç­‰é‡è¦ã€‚åŒæ ·ï¼Œè¿›ç¨‹é”€æ¯å’Œè¿›ç¨‹åˆ›å»ºä¹ŸåŒç­‰é‡è¦ã€‚å¦‚æœæœªè®¤çœŸå¯¹å¾…è¿›ç¨‹é”€æ¯ï¼Œä»–ä»¬å°†å˜æˆåƒµå°¸è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1021-åƒµå°¸zombieè¿›ç¨‹&#34;&gt;10.2.1 åƒµå°¸ï¼ˆZombieï¼‰è¿›ç¨‹&lt;/h4&gt;
&lt;p&gt;è¿›ç¨‹çš„å·¥ä½œå®Œæˆåï¼ˆæ‰§è¡Œå®Œ main å‡½æ•°ä¸­çš„ç¨‹åºåï¼‰åº”è¢«é”€æ¯ï¼Œä½†æœ‰æ—¶è¿™äº›è¿›ç¨‹å°†å˜æˆåƒµå°¸è¿›ç¨‹ï¼Œå ç”¨ç³»ç»Ÿä¸­çš„é‡è¦èµ„æºã€‚è¿™ç§çŠ¶æ€ä¸‹çš„è¿›ç¨‹ç§°ä½œã€Œåƒµå°¸è¿›ç¨‹ã€ï¼Œè¿™ä¹Ÿæ˜¯ç»™ç³»ç»Ÿå¸¦æ¥è´Ÿæ‹…çš„åŸå› ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åƒµå°¸è¿›ç¨‹æ˜¯å½“å­è¿›ç¨‹æ¯”çˆ¶è¿›ç¨‹å…ˆç»“æŸï¼Œè€Œçˆ¶è¿›ç¨‹åˆæ²¡æœ‰å›æ”¶å­è¿›ç¨‹ï¼Œé‡Šæ”¾å­è¿›ç¨‹å ç”¨çš„èµ„æºï¼Œæ­¤æ—¶å­è¿›ç¨‹å°†æˆä¸ºä¸€ä¸ªåƒµå°¸è¿›ç¨‹ã€‚å¦‚æœçˆ¶è¿›ç¨‹å…ˆé€€å‡º ï¼Œå­è¿›ç¨‹è¢«initæ¥ç®¡ï¼Œå­è¿›ç¨‹é€€å‡ºåinitä¼šå›æ”¶å…¶å ç”¨çš„ç›¸å…³èµ„æº&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç»´åŸºç™¾ç§‘&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨ç±»UNIXç³»ç»Ÿä¸­ï¼Œåƒµå°¸è¿›ç¨‹æ˜¯æŒ‡å®Œæˆæ‰§è¡Œï¼ˆé€šè¿‡exitç³»ç»Ÿè°ƒç”¨ï¼Œæˆ–è¿è¡Œæ—¶å‘ç”Ÿè‡´å‘½é”™è¯¯æˆ–æ”¶åˆ°ç»ˆæ­¢ä¿¡å·æ‰€è‡´ï¼‰ä½†åœ¨æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹è¡¨ä¸­ä»ç„¶æœ‰ä¸€ä¸ªè¡¨é¡¹ï¼ˆè¿›ç¨‹æ§åˆ¶å—PCBï¼‰ï¼Œå¤„äº&amp;quot;ç»ˆæ­¢çŠ¶æ€&amp;quot;çš„è¿›ç¨‹ã€‚è¿™å‘ç”Ÿäºå­è¿›ç¨‹éœ€è¦ä¿ç•™è¡¨é¡¹ä»¥å…è®¸å…¶çˆ¶è¿›ç¨‹è¯»å–å­è¿›ç¨‹çš„exit statusï¼šä¸€æ—¦é€€å‡ºæ€é€šè¿‡waitç³»ç»Ÿè°ƒç”¨è¯»å–ï¼Œåƒµå°¸è¿›ç¨‹æ¡ç›®å°±ä»è¿›ç¨‹è¡¨ä¸­åˆ é™¤ï¼Œç§°ä¹‹ä¸º&amp;quot;å›æ”¶ï¼ˆreapedï¼‰&amp;quot;ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿›ç¨‹ç›´æ¥è¢«å…¶çˆ¶è¿›ç¨‹waitå¹¶ç”±ç³»ç»Ÿå›æ”¶ã€‚è¿›ç¨‹é•¿æ—¶é—´ä¿æŒåƒµå°¸çŠ¶æ€ä¸€èˆ¬æ˜¯é”™è¯¯çš„å¹¶å¯¼è‡´èµ„æºæ³„æ¼ã€‚&lt;/p&gt;
&lt;p&gt;è‹±æ–‡æœ¯è¯­zombie processæºè‡ªä¸§å°¸ â€” ä¸æ­»ä¹‹äººï¼Œéšå–»å­è¿›ç¨‹å·²æ­»ä½†ä»ç„¶æ²¡æœ‰è¢«æ”¶å‰²ã€‚ä¸æ­£å¸¸è¿›ç¨‹ä¸åŒï¼Œkillå‘½ä»¤å¯¹åƒµå°¸è¿›ç¨‹æ— æ•ˆã€‚å­¤å„¿è¿›ç¨‹ä¸åŒäºåƒµå°¸è¿›ç¨‹ï¼Œå…¶çˆ¶è¿›ç¨‹å·²ç»æ­»æ‰ï¼Œä½†å­¤å„¿è¿›ç¨‹ä»èƒ½æ­£å¸¸æ‰§è¡Œï¼Œä½†å¹¶ä¸ä¼šå˜ä¸ºåƒµå°¸è¿›ç¨‹ï¼Œå› ä¸ºè¢«initï¼ˆè¿›ç¨‹IDå·ä¸º1ï¼‰æ”¶å…»å¹¶waitå…¶é€€å‡ºã€‚&lt;/p&gt;
&lt;p&gt;å­è¿›ç¨‹æ­»åï¼Œç³»ç»Ÿä¼šå‘é€SIGCHLD ä¿¡å·ç»™çˆ¶è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹å¯¹å…¶é»˜è®¤å¤„ç†æ˜¯å¿½ç•¥ã€‚å¦‚æœæƒ³å“åº”è¿™ä¸ªæ¶ˆæ¯ï¼Œçˆ¶è¿›ç¨‹é€šå¸¸åœ¨SIGCHLD ä¿¡å·äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œä½¿ç”¨waitç³»ç»Ÿè°ƒç”¨æ¥å“åº”å­è¿›ç¨‹çš„ç»ˆæ­¢ã€‚&lt;/p&gt;
&lt;p&gt;åƒµå°¸è¿›ç¨‹è¢«æ”¶å‰²åï¼Œå…¶è¿›ç¨‹å·(PID)ä¸åœ¨è¿›ç¨‹è¡¨ä¸­çš„è¡¨é¡¹éƒ½å¯ä»¥è¢«ç³»ç»Ÿé‡ç”¨ã€‚ä½†å¦‚æœçˆ¶è¿›ç¨‹æ²¡æœ‰è°ƒç”¨waitï¼Œåƒµå°¸è¿›ç¨‹å°†ä¿ç•™è¿›ç¨‹è¡¨ä¸­çš„è¡¨é¡¹ï¼Œå¯¼è‡´äº†èµ„æºæ³„æ¼ã€‚æŸäº›æƒ…å†µä¸‹è¿™åå€’æ˜¯æœŸæœ›çš„ï¼šçˆ¶è¿›ç¨‹åˆ›å»ºäº†å¦å¤–ä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¹¶å¸Œæœ›å…·æœ‰ä¸åŒçš„è¿›ç¨‹å·ã€‚å¦‚æœçˆ¶è¿›ç¨‹é€šè¿‡è®¾ç½®äº‹ä»¶å¤„ç†å‡½æ•°ä¸ºSIG_IGNæ˜¾å¼å¿½ç•¥SIGCHLDä¿¡å·ï¼Œè€Œä¸æ˜¯éšå¼é»˜è®¤å¿½ç•¥è¯¥ä¿¡å·ï¼Œæˆ–è€…å…·æœ‰SA_NOCLDWAITæ ‡å¿—ï¼Œæ‰€æœ‰å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ä¿¡æ¯å°†è¢«æŠ›å¼ƒå¹¶ä¸”ç›´æ¥è¢«ç³»ç»Ÿå›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;UNIXå‘½ä»¤psåˆ—å‡ºçš„è¿›ç¨‹çš„çŠ¶æ€ï¼ˆ&amp;ldquo;STAT&amp;rdquo;ï¼‰æ æ ‡ç¤ºä¸º &amp;ldquo;Z&amp;quot;åˆ™ä¸ºåƒµå°¸è¿›ç¨‹ã€‚[1]&lt;/p&gt;
&lt;p&gt;æ”¶å‰²åƒµå°¸è¿›ç¨‹çš„æ–¹æ³•æ˜¯é€šè¿‡killå‘½ä»¤æ‰‹å·¥å‘å…¶çˆ¶è¿›ç¨‹å‘é€SIGCHLDä¿¡å·ã€‚å¦‚æœå…¶çˆ¶è¿›ç¨‹ä»ç„¶æ‹’ç»æ”¶å‰²åƒµå°¸è¿›ç¨‹ï¼Œåˆ™ç»ˆæ­¢çˆ¶è¿›ç¨‹ï¼Œä½¿å¾—initè¿›ç¨‹æ”¶å…»åƒµå°¸è¿›ç¨‹ã€‚initè¿›ç¨‹å‘¨æœŸæ‰§è¡Œwaitç³»ç»Ÿè°ƒç”¨æ”¶å‰²å…¶æ”¶å…»çš„æ‰€æœ‰åƒµå°¸è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;1022-äº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„åŸå› &#34;&gt;10.2.2 äº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„åŸå› &lt;/h4&gt;
&lt;p&gt;ä¸ºäº†é˜²æ­¢åƒµå°¸è¿›ç¨‹äº§ç”Ÿï¼Œå…ˆè§£é‡Šäº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„åŸå› ã€‚åˆ©ç”¨å¦‚ä¸‹ä¸¤ä¸ªç¤ºä¾‹å±•ç¤ºè°ƒç”¨ fork å‡½æ•°äº§ç”Ÿå­è¿›ç¨‹çš„ç»ˆæ­¢æ–¹å¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼ é€’å‚æ•°å¹¶è°ƒç”¨ exit() å‡½æ•°&lt;/li&gt;
&lt;li&gt;main å‡½æ•°ä¸­æ‰§è¡Œ return è¯­å¥å¹¶è¿”å›å€¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;**å‘ exit å‡½æ•°ä¼ é€’çš„å‚æ•°å€¼å’Œ main å‡½æ•°çš„ return è¯­å¥è¿”å›çš„å€¼éƒ½å›ä¼ é€’ç»™æ“ä½œç³»ç»Ÿã€‚è€Œæ“ä½œç³»ç»Ÿä¸ä¼šé”€æ¯å­è¿›ç¨‹ï¼Œç›´åˆ°æŠŠè¿™äº›å€¼ä¼ é€’ç»™äº§ç”Ÿè¯¥å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ã€‚å¤„åœ¨è¿™ç§çŠ¶æ€ä¸‹çš„è¿›ç¨‹å°±æ˜¯åƒµå°¸è¿›ç¨‹ã€‚**ä¹Ÿå°±æ˜¯è¯´å°†å­è¿›ç¨‹å˜æˆåƒµå°¸è¿›ç¨‹çš„æ­£æ˜¯æ“ä½œç³»ç»Ÿã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œåƒµå°¸è¿›ç¨‹ä½•æ—¶è¢«é”€æ¯å‘¢ï¼Ÿ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åº”è¯¥å‘åˆ›å»ºå­è¿›ç¨‹å†Œçˆ¶è¿›ç¨‹ä¼ é€’å­è¿›ç¨‹çš„ exit å‚æ•°å€¼æˆ– return è¯­å¥çš„è¿”å›å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚ä½•å‘çˆ¶è¿›ç¨‹ä¼ é€’è¿™äº›å€¼å‘¢ï¼Ÿæ“ä½œç³»ç»Ÿä¸ä¼šä¸»åŠ¨æŠŠè¿™äº›å€¼ä¼ é€’ç»™çˆ¶è¿›ç¨‹ã€‚åªæœ‰çˆ¶è¿›ç¨‹ä¸»åŠ¨å‘èµ·è¯·æ±‚ï¼ˆå‡½æ•°è°ƒç”¨ï¼‰çš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿæ‰ä¼šä¼ é€’è¯¥å€¼ã€‚æ¢è¨€ä¹‹ï¼Œå¦‚æœçˆ¶è¿›ç¨‹æœªä¸»åŠ¨è¦æ±‚è·å¾—å­è¿›ç¨‹ç»“æŸçŠ¶æ€å€¼ï¼Œæ“ä½œç³»ç»Ÿå°†ä¸€ç›´ä¿å­˜ï¼Œå¹¶è®©å­è¿›ç¨‹é•¿æ—¶é—´å¤„äºåƒµå°¸è¿›ç¨‹çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œçˆ¶æ¯è¦è´Ÿè´£æ”¶å›è‡ªå·±ç”Ÿçš„å­©å­ã€‚æ¥ä¸‹æ¥çš„ç¤ºä¾‹æ˜¯åˆ›å»ºåƒµå°¸è¿›ç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/zombie.c&#34;&gt;zombie.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t pid = fork();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Hi, I am a child Process&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child Process ID: %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, pid);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;30&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;End child proess&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;End parent process&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc zombie.c -o zombie
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./zombie
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c443890f1781.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºæš‚åœäº† 30 ç§’ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªæ—¶é—´å†…å¯ä»¥éªŒè¯ä¸€ä¸‹å­è¿›ç¨‹æ˜¯å¦ä¸ºåƒµå°¸è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c4439a751b11.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;ps au&lt;/code&gt; å‘½ä»¤å¯ä»¥çœ‹å‡ºï¼Œå­è¿›ç¨‹ä»ç„¶å­˜åœ¨ï¼Œå¹¶æ²¡æœ‰è¢«é”€æ¯ï¼Œåƒµå°¸è¿›ç¨‹åœ¨è¿™é‡Œæ˜¾ç¤ºä¸º &lt;code&gt;Z+&lt;/code&gt;.30ç§’åï¼Œçº¢æ¡†é‡Œé¢çš„ä¸¤ä¸ªè¿›ç¨‹ä¼šåŒæ—¶è¢«é”€æ¯ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ©ç”¨ &lt;code&gt;./zombie &amp;amp;&lt;/code&gt;å¯ä»¥ä½¿ç¨‹åºåœ¨åå°è¿è¡Œï¼Œä¸ç”¨æ‰“å¼€æ–°çš„å‘½ä»¤è¡Œçª—å£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;1023-é”€æ¯åƒµå°¸è¿›ç¨‹-1åˆ©ç”¨-wait-å‡½æ•°&#34;&gt;10.2.3 é”€æ¯åƒµå°¸è¿›ç¨‹ 1ï¼šåˆ©ç”¨ wait å‡½æ•°&lt;/h4&gt;
&lt;p&gt;å¦‚å‰æ‰€è¿°ï¼Œä¸ºäº†é”€æ¯å­è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹åº”è¯¥ä¸»åŠ¨è¯·æ±‚è·å–å­è¿›ç¨‹çš„è¿”å›å€¼ã€‚ä¸‹é¢æ˜¯å‘èµ·è¯·æ±‚çš„å…·ä½“æ–¹æ³•ã€‚æœ‰ä¸¤ç§ï¼Œä¸‹é¢çš„å‡½æ•°æ˜¯å…¶ä¸­ä¸€ç§ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/wait.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;pid_t &lt;span style=&#34;color:#008b45&#34;&gt;wait&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; *statloc);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å›ç»ˆæ­¢çš„å­è¿›ç¨‹ ID ,å¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è°ƒç”¨æ­¤å‡½æ•°æ—¶å¦‚æœå·²æœ‰å­è¿›ç¨‹ç»ˆæ­¢ï¼Œé‚£ä¹ˆå­è¿›ç¨‹ç»ˆæ­¢æ—¶ä¼ é€’çš„è¿”å›å€¼ï¼ˆexit å‡½æ•°çš„å‚æ•°è¿”å›å€¼ï¼Œmain å‡½æ•°çš„ return è¿”å›å€¼ï¼‰å°†ä¿å­˜åˆ°è¯¥å‡½æ•°çš„å‚æ•°æ‰€æŒ‡çš„å†…å­˜ç©ºé—´ã€‚ä½†å‡½æ•°å‚æ•°æŒ‡å‘çš„å•å…ƒä¸­è¿˜åŒ…å«å…¶ä»–ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦ç”¨ä¸‹åˆ—å®è¿›è¡Œåˆ†ç¦»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;WIFEXITED å­è¿›ç¨‹æ­£å¸¸ç»ˆæ­¢æ—¶è¿”å›ã€ŒçœŸã€&lt;/li&gt;
&lt;li&gt;WEXITSTATUS è¿”å›å­è¿›ç¨‹æ—¶çš„è¿”å›å€¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå‘ wait å‡½æ•°ä¼ é€’å˜é‡ status çš„åœ°å€æ—¶ï¼Œè°ƒç”¨ wait å‡½æ•°ååº”ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (WIFEXITED(status))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Normal termination&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child pass num: %d&amp;#34;&lt;/span&gt;, WEXITSTATUS(status));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ ¹æ®ä»¥ä¸Šå†…å®¹ï¼Œæœ‰å¦‚ä¸‹ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/wait.c&#34;&gt;wait.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;25
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;26
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;27
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;28
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;29
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;30
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;31
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;32
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;33
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;34
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;35
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;36
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/wait.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; status;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t pid = fork(); &lt;span style=&#34;color:#228b22&#34;&gt;//è¿™é‡Œçš„å­è¿›ç¨‹å°†åœ¨ç¬¬13è¡Œé€šè¿‡ return è¯­å¥ç»ˆæ­¢
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;3&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child PID: %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, pid);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pid = fork(); &lt;span style=&#34;color:#228b22&#34;&gt;//è¿™é‡Œçš„å­è¿›ç¨‹å°†åœ¨ 21 è¡Œé€šè¿‡ exit() å‡½æ•°ç»ˆæ­¢
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            exit(&lt;span style=&#34;color:#b452cd&#34;&gt;7&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child PID: %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, pid);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            wait(&amp;amp;status);         &lt;span style=&#34;color:#228b22&#34;&gt;//ä¹‹é—´ç»ˆæ­¢çš„å­è¿›ç¨‹ç›¸å…³ä¿¡æ¯å°†è¢«ä¿å­˜åˆ° status ä¸­ï¼ŒåŒæ—¶ç›¸å…³å­è¿›ç¨‹è¢«å®Œå…¨é”€æ¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (WIFEXITED(status)) &lt;span style=&#34;color:#228b22&#34;&gt;//é€šè¿‡ WIFEXITED æ¥éªŒè¯å­è¿›ç¨‹æ˜¯å¦æ­£å¸¸ç»ˆæ­¢ã€‚å¦‚æœæ­£å¸¸ç»ˆæ­¢ï¼Œåˆ™è°ƒç”¨ WEXITSTATUS å®è¾“å‡ºå­è¿›ç¨‹è¿”å›å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;                printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child send one: %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, WEXITSTATUS(status));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            wait(&amp;amp;status); &lt;span style=&#34;color:#228b22&#34;&gt;//å› ä¸ºä¹‹å‰åˆ›å»ºäº†ä¸¤ä¸ªè¿›ç¨‹ï¼Œæ‰€ä»¥å†æ¬¡è°ƒç”¨ wait å‡½æ•°å’Œå®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (WIFEXITED(status))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child send two: %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, WEXITSTATUS(status));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;30&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc wait.c -o &lt;span style=&#34;color:#658b00&#34;&gt;wait&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./wait
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c4441951df43.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œç³»ç»Ÿä¸­å¹¶æ²¡æœ‰ä¸Šè¿° PID å¯¹åº”çš„è¿›ç¨‹ï¼Œè¿™æ˜¯å› ä¸ºè°ƒç”¨äº† wait å‡½æ•°ï¼Œå®Œå…¨é”€æ¯äº†è¯¥å­è¿›ç¨‹ã€‚å¦å¤–ä¸¤ä¸ªå­è¿›ç¨‹è¿”å›æ—¶è¿”å›çš„ 3 å’Œ 7 ä¼ é€’åˆ°äº†çˆ¶è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯é€šè¿‡ wait å‡½æ•°æ¶ˆç­åƒµå°¸è¿›ç¨‹çš„æ–¹æ³•ï¼Œè°ƒç”¨ wait å‡½æ•°æ—¶ï¼Œå¦‚æœæ²¡æœ‰å·²ç»ç»ˆæ­¢çš„å­è¿›ç¨‹ï¼Œé‚£ä¹ˆç¨‹åºå°†é˜»å¡ï¼ˆBlockingï¼‰ç›´åˆ°æœ‰å­è¿›ç¨‹ç»ˆæ­¢ï¼Œå› æ­¤è¦è°¨æ…è°ƒç”¨è¯¥å‡½æ•°ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1024-é”€æ¯åƒµå°¸è¿›ç¨‹-2ä½¿ç”¨-waitpid-å‡½æ•°&#34;&gt;10.2.4 é”€æ¯åƒµå°¸è¿›ç¨‹ 2ï¼šä½¿ç”¨ waitpid å‡½æ•°&lt;/h4&gt;
&lt;p&gt;wait å‡½æ•°ä¼šå¼•èµ·ç¨‹åºé˜»å¡ï¼Œè¿˜å¯ä»¥è€ƒè™‘è°ƒç”¨ waitpid å‡½æ•°ã€‚è¿™æ˜¯é˜²æ­¢åƒµå°¸è¿›ç¨‹çš„ç¬¬äºŒç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯é˜²æ­¢é˜»å¡çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/wait.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;pid_t &lt;span style=&#34;color:#008b45&#34;&gt;waitpid&lt;/span&gt;(pid_t pid, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; *statloc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; options);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å›ç»ˆæ­¢çš„å­è¿›ç¨‹ID æˆ– 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;pid: ç­‰å¾…ç»ˆæ­¢çš„ç›®æ ‡å­è¿›ç¨‹çš„ID,è‹¥ä¼  -1ï¼Œåˆ™ä¸ wait å‡½æ•°ç›¸åŒï¼Œå¯ä»¥ç­‰å¾…ä»»æ„å­è¿›ç¨‹ç»ˆæ­¢
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;statloc: ä¸ wait å‡½æ•°çš„ statloc å‚æ•°å…·æœ‰ç›¸åŒå«ä¹‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;options: ä¼ é€’å¤´æ–‡ä»¶ sys/wait.h å£°æ˜çš„å¸¸é‡ WNOHANG ,å³ä½¿æ²¡æœ‰ç»ˆæ­¢çš„å­è¿›ç¨‹ä¹Ÿä¸ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è¿”å› 0 é€€å‡ºå‡½æ•°ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯ waitpid çš„ä½¿ç”¨ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/waitpid.c&#34;&gt;waitpid.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/wait.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; status;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t pid = fork();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;15&lt;/span&gt;); &lt;span style=&#34;color:#228b22&#34;&gt;//ç”¨ sleep æ¨è¿Ÿå­è¿›ç¨‹çš„æ‰§è¡Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;24&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#228b22&#34;&gt;//è°ƒç”¨waitpid ä¼ é€’å‚æ•° WNOHANG ï¼Œè¿™æ ·ä¹‹å‰æœ‰æ²¡æœ‰ç»ˆæ­¢çš„å­è¿›ç¨‹åˆ™è¿”å›0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;while&lt;/span&gt; (!waitpid(-&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;, &amp;amp;status, WNOHANG))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;3&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;sleep 3 sec.&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (WIFEXITED(status))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child send %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, WEXITSTATUS(status));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc waitpid.c -o waitpid
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./waitpid
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœ:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c444785a16ae.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨ while å¾ªç¯ä¸­æ­£å¥½æ‰§è¡Œäº† 5 æ¬¡ã€‚è¿™ä¹Ÿè¯æ˜äº† waitpid å‡½æ•°å¹¶æ²¡æœ‰é˜»å¡&lt;/p&gt;
&lt;h3 id=&#34;103-ä¿¡å·å¤„ç†&#34;&gt;10.3 ä¿¡å·å¤„ç†&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»çŸ¥é“äº†è¿›ç¨‹çš„åˆ›å»ºåŠé”€æ¯çš„åŠæ³•ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å­è¿›ç¨‹ç©¶ç«Ÿä½•æ—¶ç»ˆæ­¢ï¼Ÿè°ƒç”¨ waitpid å‡½æ•°åè¦æ— ä¼‘æ­¢çš„ç­‰å¾…å—ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;1031-å‘æ“ä½œç³»ç»Ÿæ±‚åŠ©&#34;&gt;10.3.1 å‘æ“ä½œç³»ç»Ÿæ±‚åŠ©&lt;/h4&gt;
&lt;p&gt;å­è¿›ç¨‹ç»ˆæ­¢çš„è¯†åˆ«ä¸»é¢˜æ˜¯æ“ä½œç³»ç»Ÿï¼Œå› æ­¤ï¼Œè‹¥æ“ä½œç³»ç»Ÿèƒ½æŠŠå¦‚ä¸‹ä¿¡æ¯å‘Šè¯‰æ­£å¿™äºå·¥ä½œçš„çˆ¶è¿›ç¨‹ï¼Œå°†æœ‰åŠ©äºæ„å»ºæ›´é«˜æ•ˆçš„ç¨‹åº&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å®ç°ä¸Šè¿°çš„åŠŸèƒ½ï¼Œå¼•å…¥ä¿¡å·å¤„ç†æœºåˆ¶ï¼ˆSignal Handingï¼‰ã€‚æ­¤å¤„ã€Œä¿¡å·ã€æ˜¯åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶ç”±æ“ä½œç³»ç»Ÿå‘è¿›ç¨‹å‘é€çš„æ¶ˆæ¯ã€‚å¦å¤–ï¼Œä¸ºäº†å“åº”è¯¥æ¶ˆæ¯ï¼Œæ‰§è¡Œä¸æ¶ˆæ¯ç›¸å…³çš„è‡ªå®šä¹‰æ“ä½œçš„è¿‡ç¨‹è¢«ç§°ä¸ºã€Œå¤„ç†ã€æˆ–ã€Œä¿¡å·å¤„ç†ã€ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1032-ä¿¡å·ä¸-signal-å‡½æ•°&#34;&gt;10.3.2 ä¿¡å·ä¸ signal å‡½æ•°&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢è¿›ç¨‹å’Œæ“ä½œç³»ç»Ÿçš„å¯¹è¯å¯ä»¥å¸®åŠ©ç†è§£ä¿¡å·å¤„ç†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿›ç¨‹ï¼šæ“ä½œç³»ç»Ÿï¼Œå¦‚æœæˆ‘ä¹‹å‰åˆ›å»ºçš„å­è¿›ç¨‹ç»ˆæ­¢ï¼Œå°±å¸®æˆ‘è°ƒç”¨ zombie_handler å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿï¼šå¥½çš„ï¼Œå¦‚æœä½ çš„å­è¿›ç¨‹ç»ˆæ­¢ï¼Œæˆ‘èˆ…å¸®ä½ è°ƒç”¨ zombie_handler å‡½æ•°ï¼Œä½ å…ˆæŠŠè¦å‡½æ•°è¦æ‰§è¡Œçš„è¯­å¥å†™å¥½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸Šè¿°çš„å¯¹è¯ï¼Œç›¸å½“äºã€Œæ³¨å†Œä¿¡å·ã€çš„è¿‡ç¨‹ã€‚å³è¿›ç¨‹å‘ç°è‡ªå·±çš„å­è¿›ç¨‹ç»“æŸæ—¶ï¼Œè¯·æ±‚æ“ä½œç³»ç»Ÿè°ƒç”¨çš„ç‰¹å®šå‡½æ•°ã€‚è¯¥è¯·æ±‚å¯ä»¥é€šè¿‡å¦‚ä¸‹å‡½æ•°è°ƒç”¨å®Œæˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;signal.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; (*signal(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; signo, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; (*func)(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt;)))(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;ä¸ºäº†åœ¨äº§ç”Ÿä¿¡å·æ—¶è°ƒç”¨ï¼Œè¿”å›ä¹‹å‰æ³¨å†Œçš„å‡½æ•°æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;å‡½æ•°å: signal
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;å‚æ•°ï¼šint signo,void(*func)(int)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;è¿”å›ç±»å‹ï¼šå‚æ•°ç±»å‹ä¸ºintå‹ï¼Œè¿”å› void å‹å‡½æ•°æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è°ƒç”¨ä¸Šè¿°å‡½æ•°æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç‰¹æ®Šæƒ…å†µä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºç‰¹æ®Šæƒ…å†µä¸‹å°†è¦è°ƒç”¨çš„å‡½æ•°çš„åœ°å€å€¼ï¼ˆæŒ‡é’ˆï¼‰ã€‚å‘ç”Ÿç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨çš„æƒ…å†µæ—¶ï¼Œè°ƒç”¨ç¬¬äºŒä¸ªå‚æ•°æ‰€æŒ‡çš„å‡½æ•°ã€‚ä¸‹é¢ç»™å‡ºå¯ä»¥åœ¨ signal å‡½æ•°ä¸­æ³¨å†Œçš„éƒ¨åˆ†ç‰¹æ®Šæƒ…å†µå’Œå¯¹åº”çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SIGALRMï¼šå·²åˆ°é€šè¿‡è°ƒç”¨ alarm å‡½æ•°æ³¨å†Œæ—¶é—´&lt;/li&gt;
&lt;li&gt;SIGINTï¼šè¾“å…¥ ctrl+c&lt;/li&gt;
&lt;li&gt;SIGCHLDï¼šå­è¿›ç¨‹ç»ˆæ­¢&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¥ä¸‹æ¥ç¼–å†™è°ƒç”¨ signal å‡½æ•°çš„è¯­å¥å®Œæˆå¦‚ä¸‹è¯·æ±‚ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ã€Œå­è¿›ç¨‹ç»ˆæ­¢åˆ™è°ƒç”¨ mychild å‡½æ•°ã€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ­¤æ—¶ mychild å‡½æ•°çš„å‚æ•°åº”ä¸º int ï¼Œè¿”å›å€¼ç±»å‹åº”ä¸º void ã€‚åªæœ‰è¿™æ ·æ‰èƒ½ç§°ä¸º signal å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚å¦å¤–ï¼Œå¸¸æ•° SIGCHLD å®šä¹‰äº†å­è¿›ç¨‹ç»ˆæ­¢çš„æƒ…å†µï¼Œåº”æˆä¸º signal å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œsignal å‡½æ•°è°ƒç”¨è¯­å¥å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;signal(SIGCHLD , mychild);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ¥ä¸‹æ¥ç¼–å†™ signal å‡½æ•°çš„è°ƒç”¨è¯­å¥ï¼Œåˆ†åˆ«å®Œæˆå¦‚ä¸‹ä¸¤ä¸ªè¯·æ±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å·²åˆ°é€šè¿‡ alarm å‡½æ•°æ³¨å†Œæ—¶é—´ï¼Œè¯·è°ƒç”¨ timeout å‡½æ•°&lt;/li&gt;
&lt;li&gt;è¾“å…¥ ctrl+c æ—¶è°ƒç”¨ keycontrol å‡½æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»£è¡¨è¿™ 2 ç§æƒ…å†µçš„å¸¸æ•°åˆ†åˆ«ä¸º SIGALRM å’Œ SIGINT ï¼Œå› æ­¤æŒ‰å¦‚ä¸‹æ–¹å¼è°ƒç”¨ signal å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;signal(SIGALRM , timeout);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;signal(SIGINT , keycontrol);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä»¥ä¸Šå°±æ˜¯ä¿¡å·æ³¨å†Œè¿‡ç¨‹ã€‚æ³¨å†Œå¥½ä¿¡å·ä¹‹åï¼Œå‘ç”Ÿæ³¨å†Œä¿¡å·æ—¶ï¼ˆæ³¨å†Œçš„æƒ…å†µå‘ç”Ÿæ—¶ï¼‰ï¼Œæ“ä½œç³»ç»Ÿå°†è°ƒç”¨è¯¥ä¿¡å·å¯¹åº”çš„å‡½æ•°ã€‚å…ˆä»‹ç» alarm å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;alarm&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; seconds);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;// è¿”å›0æˆ–ä»¥ç§’ä¸ºå•ä½çš„è· SIGALRM ä¿¡å·å‘ç”Ÿæ‰€å‰©æ—¶é—´
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¦‚æœè°ƒç”¨è¯¥å‡½æ•°çš„åŒæ—¶å‘å®ƒä¼ é€’ä¸€ä¸ªæ­£æ•´å‹å‚æ•°ï¼Œç›¸åº”æ—¶é—´åï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰å°†äº§ç”Ÿ SIGALRM ä¿¡å·ã€‚è‹¥å‘è¯¥å‡½æ•°ä¼ é€’ä¸º 0 ï¼Œåˆ™ä¹‹å‰å¯¹ SIGALRM ä¿¡å·çš„é¢„çº¦å°†å–æ¶ˆã€‚å¦‚æœé€šè¿‡æ”¹å‡½æ•°é¢„çº¦ä¿¡å·åæœªæŒ‡å®šè¯¥ä¿¡å·å¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œåˆ™ï¼ˆé€šè¿‡è°ƒç”¨ signal å‡½æ•°ï¼‰ç»ˆæ­¢è¿›ç¨‹ï¼Œä¸åšä»»ä½•å¤„ç†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/signal.c&#34;&gt;signal.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;25
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;26
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;27
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;signal.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;timeout&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sig) &lt;span style=&#34;color:#228b22&#34;&gt;//ä¿¡å·å¤„ç†å™¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (sig == SIGALRM)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Time out!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    alarm(&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;); &lt;span style=&#34;color:#228b22&#34;&gt;//ä¸ºäº†æ¯éš” 2 ç§’é‡å¤äº§ç”Ÿ SIGALRM ä¿¡å·ï¼Œåœ¨ä¿¡å·å¤„ç†å™¨ä¸­è°ƒç”¨ alarm å‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;keycontrol&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sig) &lt;span style=&#34;color:#228b22&#34;&gt;//ä¿¡å·å¤„ç†å™¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (sig == SIGINT)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;CTRL+C pressed&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; i;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    signal(SIGALRM, timeout); &lt;span style=&#34;color:#228b22&#34;&gt;//æ³¨å†Œä¿¡å·åŠç›¸åº”å¤„ç†å™¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    signal(SIGINT, keycontrol);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    alarm(&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;); &lt;span style=&#34;color:#228b22&#34;&gt;//é¢„çº¦ 2 ç§’å€™å‘ç”Ÿ SIGALRM ä¿¡å·
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#b452cd&#34;&gt;3&lt;/span&gt;; i++)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;wait...&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;100&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc signal.c -o signal
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./signal
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c446c877acb7.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°ç»“æœæ˜¯æ²¡æœ‰ä»»ä½•è¾“å…¥çš„è¿è¡Œç»“æœã€‚å½“è¾“å…¥ ctrl+c æ—¶:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/20/5c446ce0b1143.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å°±å¯ä»¥çœ‹åˆ° &lt;code&gt;CTRL+C pressed&lt;/code&gt; çš„å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å‘ç”Ÿä¿¡å·æ—¶å°†å”¤é†’ç”±äºè°ƒç”¨ sleep å‡½æ•°è€Œè¿›å…¥é˜»å¡çŠ¶æ€çš„è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è°ƒç”¨å‡½æ•°çš„ä¸»é¢˜çš„ç¡®æ˜¯æ“ä½œç³»ç»Ÿï¼Œä½†æ˜¯è¿›ç¨‹å¤„äºç¡çœ çŠ¶æ€æ—¶æ— æ³•è°ƒç”¨å‡½æ•°ï¼Œå› æ­¤ï¼Œäº§ç”Ÿä¿¡å·æ—¶ï¼Œä¸ºäº†è°ƒç”¨ä¿¡å·å¤„ç†å™¨ï¼Œå°†å”¤é†’ç”±äºè°ƒç”¨ sleep å‡½æ•°è€Œè¿›å…¥é˜»å¡çŠ¶æ€çš„è¿›ç¨‹ã€‚è€Œä¸”ï¼Œè¿›ç¨‹ä¸€æ—¦è¢«å”¤é†’ï¼Œå°±ä¸ä¼šå†è¿›å…¥ç¡çœ çŠ¶æ€ã€‚å³ä½¿è¿˜æœªåˆ° sleep ä¸­è§„å®šçš„æ—¶é—´ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ‰€ä»¥ä¸Šè¿°ç¤ºä¾‹è¿è¡Œä¸åˆ° 10 ç§’åå°±ä¼šç»“æŸï¼Œè¿ç»­è¾“å…¥ CTRL+C å¯èƒ½è¿ä¸€ç§’éƒ½ä¸åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç®€è¨€ä¹‹ï¼Œå°±æ˜¯æœ¬æ¥ç³»ç»Ÿè¦ç¡çœ 100ç§’ï¼Œä½†æ˜¯åˆ°äº† alarm(2) è§„å®šçš„ä¸¤ç§’ä¹‹åï¼Œå°±ä¼šå”¤é†’ç¡çœ çš„è¿›ç¨‹ï¼Œè¿›ç¨‹è¢«å”¤é†’äº†å°±ä¸ä¼šå†è¿›å…¥ç¡çœ çŠ¶æ€äº†ï¼Œæ‰€ä»¥å°±ä¸ç”¨ç­‰å¾…100ç§’ã€‚å¦‚æœæŠŠ timeout() å‡½æ•°ä¸­çš„ alarm(2) æ³¨é‡Šæ‰ï¼Œå°±ä¼šå…ˆè¾“å‡º&lt;code&gt;wait...&lt;/code&gt;ï¼Œç„¶åå†è¾“å‡º&lt;code&gt;Time out!&lt;/code&gt; (è¿™æ—¶å·²ç»è·³è¿‡äº†ç¬¬ä¸€æ¬¡çš„ sleep(100) ç§’),ç„¶åå°±çœŸçš„ä¼šç¡çœ 100ç§’ï¼Œå› ä¸ºæ²¡æœ‰å†å‘å‡º alarm(2)  çš„ä¿¡å·ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;1033-åˆ©ç”¨-sigaction-å‡½æ•°è¿›è¡Œä¿¡å·å¤„ç†&#34;&gt;10.3.3 åˆ©ç”¨ sigaction å‡½æ•°è¿›è¡Œä¿¡å·å¤„ç†&lt;/h4&gt;
&lt;p&gt;å‰é¢æ‰€å­¦çš„å†…å®¹å¯ä»¥é˜²æ­¢åƒµå°¸è¿›ç¨‹ï¼Œè¿˜æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå«åš sigaction å‡½æ•°ï¼Œä»–ç±»ä¼¼äº signal å‡½æ•°ï¼Œè€Œä¸”å¯ä»¥å®Œå…¨ä»£æ›¿åè€…ï¼Œä¹Ÿæ›´ç¨³å®šã€‚ä¹‹æ‰€ä»¥ç¨³å®šï¼Œæ˜¯å› ä¸ºï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;signal å‡½æ•°åœ¨ Unix ç³»åˆ—çš„ä¸åŒæ“ä½œç³»ç»Ÿå¯èƒ½å­˜åœ¨åŒºåˆ«ï¼Œä½† sigaction å‡½æ•°å®Œå…¨ç›¸åŒ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®é™…ä¸Šç°åœ¨å¾ˆå°‘ç”¨ signal å‡½æ•°ç¼–å†™ç¨‹åºï¼Œä»–åªæ˜¯ä¸ºäº†ä¿æŒå¯¹æ—§ç¨‹åºçš„å…¼å®¹ï¼Œä¸‹é¢ä»‹ç» sigaction å‡½æ•°ï¼Œåªè®²è§£å¯ä»¥æ›¿æ¢ signal å‡½æ•°çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;signal.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;sigaction&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; signo, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sigaction *act, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sigaction *oldact);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;act: å¯¹äºç¬¬ä¸€ä¸ªå‚æ•°çš„ä¿¡å·å¤„ç†å‡½æ•°ï¼ˆä¿¡å·å¤„ç†å™¨ï¼‰ä¿¡æ¯ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;oldact: é€šè¿‡æ­¤å‚æ•°è·å–ä¹‹å‰æ³¨å†Œçš„ä¿¡å·å¤„ç†å‡½æ•°æŒ‡é’ˆï¼Œè‹¥ä¸éœ€è¦åˆ™ä¼ é€’ 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å£°æ˜å¹¶åˆå§‹åŒ– sigaction ç»“æ„ä½“å˜é‡ä»¥è°ƒç”¨ä¸Šè¿°å‡½æ•°ï¼Œè¯¥ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sigaction
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; (*sa_handler)(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sigset_t sa_mask;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sa_flags;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ­¤ç»“æ„ä½“çš„æˆå‘˜ sa_handler ä¿å­˜ä¿¡å·å¤„ç†çš„å‡½æ•°æŒ‡é’ˆå€¼ï¼ˆåœ°å€å€¼ï¼‰ã€‚sa_mask å’Œ sa_flags çš„æ‰€æœ‰ä½åˆå§‹åŒ– 0 å³å¯ã€‚è¿™ 2 ä¸ªæˆå‘˜ç”¨äºæŒ‡å®šä¿¡å·ç›¸å…³çš„é€‰é¡¹å’Œç‰¹æ€§ï¼Œè€Œæˆ‘ä»¬çš„ç›®çš„ä¸»è¦æ˜¯é˜²æ­¢äº§ç”Ÿåƒµå°¸è¿›ç¨‹ï¼Œæ•…çœç•¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ç¤ºä¾‹æ˜¯å…³äº sigaction å‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/sigaction.c&#34;&gt;sigaction.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;25
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;26
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;27
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;28
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;signal.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;timeout&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sig)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (sig == SIGALRM)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Time out!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    alarm(&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; i;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sigaction act;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    act.sa_handler = timeout;    &lt;span style=&#34;color:#228b22&#34;&gt;//ä¿å­˜å‡½æ•°æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    sigemptyset(&amp;amp;act.sa_mask);   &lt;span style=&#34;color:#228b22&#34;&gt;//å°† sa_mask å‡½æ•°çš„æ‰€æœ‰ä½åˆå§‹åŒ–æˆ0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    act.sa_flags = &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;            &lt;span style=&#34;color:#228b22&#34;&gt;//sa_flags åŒæ ·åˆå§‹åŒ–æˆ 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    sigaction(SIGALRM, &amp;amp;act, &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;); &lt;span style=&#34;color:#228b22&#34;&gt;//æ³¨å†Œ SIGALRM ä¿¡å·çš„å¤„ç†å™¨ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    alarm(&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;); &lt;span style=&#34;color:#228b22&#34;&gt;//2 ç§’åå‘ç”Ÿ SIGALRM ä¿¡å·
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#b452cd&#34;&gt;3&lt;/span&gt;; i++)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;wait...&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;100&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc sigaction.c -o sigaction
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./sigaction
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wait...
Time out!
wait...
Time out!
wait...
Time out!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥å‘ç°ï¼Œç»“æœå’Œä¹‹å‰ç”¨ signal å‡½æ•°çš„ç»“æœæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä»¥ä¸Šå°±æ˜¯ä¿¡å·å¤„ç†çš„ç›¸å…³ç†è®ºã€‚&lt;/p&gt;
&lt;h4 id=&#34;1034-åˆ©ç”¨ä¿¡å·å¤„ç†æŠ€æœ¯æ¶ˆç­åƒµå°¸è¿›ç¨‹&#34;&gt;10.3.4 åˆ©ç”¨ä¿¡å·å¤„ç†æŠ€æœ¯æ¶ˆç­åƒµå°¸è¿›ç¨‹&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢åˆ©ç”¨å­è¿›ç¨‹ç»ˆæ­¢æ—¶äº§ç”Ÿ SIGCHLD ä¿¡å·è¿™ä¸€ç‚¹ï¼Œæ¥ç”¨ä¿¡å·å¤„ç†æ¥æ¶ˆç­åƒµå°¸è¿›ç¨‹ã€‚çœ‹ä»¥ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/remove_zomebie.c&#34;&gt;remove_zomebie.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;20
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;21
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;22
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;23
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;24
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;25
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;26
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;27
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;28
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;29
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;30
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;31
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;32
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;33
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;34
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;35
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;36
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;37
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;38
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;39
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;40
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;41
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;42
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;43
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;44
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;45
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;46
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;47
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;48
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;49
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;50
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;51
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;52
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;53
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;54
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;55
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;56
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;signal.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/wait.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;read_childproc&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sig)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; status;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t id = waitpid(-&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;, &amp;amp;status, WNOHANG);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (WIFEXITED(status))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Removed proc id: %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, id);             &lt;span style=&#34;color:#228b22&#34;&gt;//å­è¿›ç¨‹çš„ pid
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child send: %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, WEXITSTATUS(status)); &lt;span style=&#34;color:#228b22&#34;&gt;//å­è¿›ç¨‹çš„è¿”å›å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid_t pid;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sigaction act;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    act.sa_handler = read_childproc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sigemptyset(&amp;amp;act.sa_mask);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    act.sa_flags = &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sigaction(SIGCHLD, &amp;amp;act, &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pid = fork();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#228b22&#34;&gt;//å­è¿›ç¨‹æ‰§è¡Œé˜¶æ®µ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Hi I&amp;#39;m child process&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;10&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;12&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#228b22&#34;&gt;//çˆ¶è¿›ç¨‹æ‰§è¡Œé˜¶æ®µ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child proc id: %d&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, pid);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pid = fork();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (pid == &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Hi! I&amp;#39;m child process&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;10&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            exit(&lt;span style=&#34;color:#b452cd&#34;&gt;24&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; i;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Child proc id: %d &lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;, pid);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#b452cd&#34;&gt;5&lt;/span&gt;; i++)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                puts(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;wait&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                sleep(&lt;span style=&#34;color:#b452cd&#34;&gt;5&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc remove_zomebie.c -o zombie
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./zombie
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Child proc id: 11211
Hi I&amp;#39;m child process
Child proc id: 11212 
wait
Hi! I&amp;#39;m child process

wait

wait
Removed proc id: 11211 
Child send: 12 
wait
Removed proc id: 11212 
Child send: 24 
wait
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¯·è‡ªä¹ è§‚å¯Ÿç»“æœï¼Œç»“æœä¸­çš„æ¯ä¸€ä¸ªç©ºè¡Œä»£è¡¨é—´éš”äº†5 ç§’ï¼Œç¨‹åºæ˜¯å…ˆåˆ›å»ºäº†ä¸¤ä¸ªå­è¿›ç¨‹ï¼Œç„¶åå­è¿›ç¨‹ 10  ç§’ä¹‹åä¼šè¿”å›å€¼ï¼Œç¬¬ä¸€ä¸ª wait ç”±äºå­è¿›ç¨‹åœ¨æ‰§è¡Œï¼Œæ‰€ä»¥ç›´æ¥è¢«å”¤é†’ï¼Œç„¶åè¿™ä¸¤ä¸ªå­è¿›ç¨‹æ­£åœ¨ç¡ 10 ç§’ï¼Œæ‰€ä»¥ 5 ç§’ä¹‹åç¬¬äºŒä¸ª wait å¼€å§‹æ‰§è¡Œï¼Œåˆè¿‡äº† 5 ç§’ï¼Œä¸¤ä¸ªå­è¿›ç¨‹åŒæ—¶è¢«å”¤é†’ã€‚æ‰€ä»¥å‰©ä¸‹çš„ wait ä¹Ÿè¢«å”¤é†’ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥åœ¨æœ¬ç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œå½“å­è¿›ç¨‹ç»ˆæ­¢æ—¶å€™ï¼Œä¼šå‘ç³»ç»Ÿå‘é€ä¸€ä¸ªä¿¡å·ï¼Œç„¶åè°ƒç”¨æˆ‘ä»¬æå‰å†™å¥½çš„å¤„ç†å‡½æ•°ï¼Œåœ¨å¤„ç†å‡½æ•°ä¸­ä½¿ç”¨ waitpid æ¥å¤„ç†åƒµå°¸è¿›ç¨‹ï¼Œè·å–å­è¿›ç¨‹è¿”å›å€¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;104-åŸºäºå¤šä»»åŠ¡çš„å¹¶å‘æœåŠ¡å™¨&#34;&gt;10.4 åŸºäºå¤šä»»åŠ¡çš„å¹¶å‘æœåŠ¡å™¨&lt;/h3&gt;
&lt;h4 id=&#34;1041-åŸºäºè¿›ç¨‹çš„å¹¶å‘æœåŠ¡å™¨æ¨¡å‹&#34;&gt;10.4.1 åŸºäºè¿›ç¨‹çš„å¹¶å‘æœåŠ¡å™¨æ¨¡å‹&lt;/h4&gt;
&lt;p&gt;ä¹‹å‰çš„å›å£°æœåŠ¡å™¨æ¯æ¬¡åªèƒ½åŒäº‹å‘ 1 ä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚å› æ­¤ï¼Œéœ€è¦æ‰©å±•å›å£°æœåŠ¡å™¨ï¼Œä½¿å…¶å¯ä»¥åŒæ—¶å‘å¤šä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚ä¸‹å›¾æ˜¯åŸºäºå¤šè¿›ç¨‹çš„å›å£°æœåŠ¡å™¨çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/21/5c453664cde26.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯å½“æœ‰å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼ˆè¿æ¥è¯·æ±‚ï¼‰ï¼Œå›å£°æœåŠ¡å™¨éƒ½åˆ›å»ºå­è¿›ç¨‹ä»¥æä¾›æœåŠ¡ã€‚å¦‚æœè¯·æ±‚çš„å®¢æˆ·ç«¯æœ‰ 5 ä¸ªï¼Œåˆ™å°†åˆ›å»º 5 ä¸ªå­è¿›ç¨‹æ¥æä¾›æœåŠ¡ï¼Œä¸ºäº†å®Œæˆè¿™äº›ä»»åŠ¡ï¼Œéœ€è¦ç»è¿‡å¦‚ä¸‹è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€é˜¶æ®µï¼šå›å£°æœåŠ¡å™¨ç«¯ï¼ˆçˆ¶è¿›ç¨‹ï¼‰é€šè¿‡è°ƒç”¨ accept å‡½æ•°å—ç†è¿æ¥è¯·æ±‚&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒé˜¶æ®µï¼šæ­¤æ—¶è·å–çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦åˆ›å»ºå¹¶ä¼ é€’ç»™å­è¿›ç¨‹&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰é˜¶æ®µï¼šè¿›ç¨‹åˆ©ç”¨ä¼ é€’æ¥çš„æ–‡ä»¶æè¿°ç¬¦æä¾›æœåŠ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;1042-å®ç°å¹¶å‘æœåŠ¡å™¨&#34;&gt;10.4.2 å®ç°å¹¶å‘æœåŠ¡å™¨&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢æ˜¯åŸºäºå¤šè¿›ç¨‹å®ç°çš„å¹¶å‘çš„å›å£°æœåŠ¡å™¨çš„æœåŠ¡ç«¯ï¼Œå¯ä»¥ç»“åˆç¬¬å››ç« çš„ &lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch04/echo_client.c&#34;&gt;echo_client.c&lt;/a&gt; å›å£°å®¢æˆ·ç«¯æ¥è¿è¡Œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/echo_mpserv.c&#34;&gt;echo_mpserv.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc echo_mpserv.c -o eserver
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./eserver
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;å’Œç¬¬å››ç« çš„å‡ ä¹ä¸€æ ·ï¼Œå¯ä»¥è‡ªå·±æµ‹è¯•ï¼Œæ­¤æ—¶çš„æœåŠ¡ç«¯æ”¯æŒåŒæ—¶ç»™å¤šä¸ªå®¢æˆ·ç«¯è¿›è¡ŒæœåŠ¡ï¼Œæ¯æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯ï¼Œå°±ä¼šå¤šå¼€ä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ‰€ä»¥å¯ä»¥åŒæ—¶æä¾›æœåŠ¡ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1043-é€šè¿‡-fork-å‡½æ•°å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦&#34;&gt;10.4.3 é€šè¿‡ fork å‡½æ•°å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦&lt;/h4&gt;
&lt;p&gt;ç¤ºä¾‹ä¸­ç»™å‡ºäº†é€šè¿‡ fork å‡½æ•°å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦çš„è¿‡ç¨‹ã€‚çˆ¶è¿›ç¨‹å°† 2 ä¸ªå¥—æ¥å­—ï¼ˆä¸€ä¸ªæ˜¯æœåŠ¡ç«¯å¥—æ¥å­—å¦ä¸€ä¸ªæ˜¯å®¢æˆ·ç«¯å¥—æ¥å­—ï¼‰æ–‡ä»¶æè¿°ç¬¦å¤åˆ¶ç»™äº†å­è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è°ƒç”¨ fork å‡½æ•°æ—¶èµ‹å€¼çˆ¶è¿›ç¨‹çš„æ‰€æœ‰èµ„æºï¼Œä½†æ˜¯å¥—æ¥å­—ä¸æ˜¯å½’è¿›ç¨‹æ‰€æœ‰çš„ï¼Œè€Œæ˜¯å½’æ“ä½œç³»ç»Ÿæ‰€æœ‰ï¼Œåªæ˜¯è¿›ç¨‹æ‹¥æœ‰ä»£è¡¨ç›¸åº”å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/21/kP7Rjx.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼Œ1 ä¸ªå¥—æ¥å­—å­˜åœ¨ 2 ä¸ªæ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œåªæœ‰ 2 ä¸ªæ–‡ä»¶æè¿°ç¬¦éƒ½ç»ˆæ­¢ï¼ˆé”€æ¯ï¼‰åï¼Œæ‰èƒ½é”€æ¯å¥—æ¥å­—ã€‚å¦‚æœç»´æŒå›¾ä¸­çš„çŠ¶æ€ï¼Œå³ä½¿å­è¿›ç¨‹é”€æ¯äº†ä¸å®¢æˆ·ç«¯è¿æ¥çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ï¼Œä¹Ÿæ— æ³•é”€æ¯å¥—æ¥å­—ï¼ˆæœåŠ¡å™¨å¥—æ¥å­—åŒæ ·å¦‚æ­¤ï¼‰ã€‚å› æ­¤è°ƒç”¨ fork å‡½æ•°å€™ï¼Œè¦å°†æ— å…³ç´§è¦çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦å…³æ‰ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/21/kPH7ZT.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;105-åˆ†å‰²-tcp-çš„-io-ç¨‹åº&#34;&gt;10.5 åˆ†å‰² TCP çš„ I/O ç¨‹åº&lt;/h3&gt;
&lt;h4 id=&#34;1051-åˆ†å‰²-io-çš„ä¼˜ç‚¹&#34;&gt;10.5.1 åˆ†å‰² I/O çš„ä¼˜ç‚¹&lt;/h4&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»å®ç°çš„å›å£°å®¢æˆ·ç«¯çš„æ•°æ®å›å£°æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å‘æœåŠ¡å™¨ä¼ è¾“æ•°æ®ï¼Œå¹¶ç­‰å¾…æœåŠ¡å™¨ç«¯å›å¤ã€‚æ— æ¡ä»¶ç­‰å¾…ï¼Œç›´åˆ°æ¥æ”¶å®ŒæœåŠ¡å™¨ç«¯çš„å›å£°æ•°æ®åï¼Œæ‰èƒ½ä¼ è¾“ä¸‹ä¸€æ‰¹æ•°æ®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¼ è¾“æ•°æ®åè¦ç­‰å¾…æœåŠ¡å™¨ç«¯è¿”å›çš„æ•°æ®ï¼Œå› ä¸ºç¨‹åºä»£ç ä¸­é‡å¤è°ƒç”¨äº† read å’Œ write å‡½æ•°ã€‚åªèƒ½è¿™ä¹ˆå†™çš„åŸå› ä¹‹ä¸€æ˜¯ï¼Œç¨‹åºåœ¨ 1 ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼Œç°åœ¨å¯ä»¥åˆ›å»ºå¤šä¸ªè¿›ç¨‹ï¼Œå› æ­¤å¯ä»¥åˆ†å‰²æ•°æ®æ”¶å‘è¿‡ç¨‹ã€‚é»˜è®¤åˆ†å‰²è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/21/kPbhkD.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå®¢æˆ·ç«¯çš„çˆ¶è¿›ç¨‹è´Ÿè´£æ¥æ”¶æ•°æ®ï¼Œé¢å¤–åˆ›å»ºçš„å­è¿›ç¨‹è´Ÿè´£å‘é€æ•°æ®ï¼Œåˆ†å‰²åï¼Œä¸åŒè¿›ç¨‹åˆ†åˆ«è´Ÿè´£è¾“å…¥è¾“å‡ºï¼Œè¿™æ ·ï¼Œæ— è®ºå®¢æˆ·ç«¯æ˜¯å¦ä»æœåŠ¡å™¨ç«¯æ¥æ”¶å®Œæ•°æ®éƒ½å¯ä»¥è¿›ç¨‹ä¼ è¾“ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†å‰² I/O ç¨‹åºçš„å¦å¤–ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå¯ä»¥æé«˜é¢‘ç¹äº¤æ¢æ•°æ®çš„ç¨‹åºæ€§èƒ½ï¼Œå›¾ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/21/kPbvtg.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®ä¸Šå›¾æ˜¾ç¤ºå¯ä»¥çœ‹å‡ºï¼Œå†ç½‘ç»œä¸å¥½çš„æƒ…å†µä¸‹ï¼Œæ˜æ˜¾æå‡é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1052-å›å£°å®¢æˆ·ç«¯çš„-io-ç¨‹åºåˆ†å‰²&#34;&gt;10.5.2 å›å£°å®¢æˆ·ç«¯çš„ I/O ç¨‹åºåˆ†å‰²&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢æ˜¯å›å£°å®¢æˆ·ç«¯çš„ I/O åˆ†å‰²çš„ä»£ç å®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch10/echo_mpclient.c&#34;&gt;echo_mpclient.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯ä»¥é…åˆåˆšæ‰çš„å¹¶å‘æœåŠ¡å™¨è¿›è¡Œæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc echo_mpclient.c -o eclient
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./eclient 127.0.0.1 &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/21/kPOcXn.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼ŒåŸºæœ¬å’Œä»¥å‰çš„ä¸€æ ·ï¼Œä½†æ˜¯é‡Œé¢çš„å†…éƒ¨ç»“æ„å´å‘ç”Ÿäº†å¾ˆå¤§çš„å˜åŒ–&lt;/p&gt;
&lt;h3 id=&#34;106-ä¹ é¢˜&#34;&gt;10.6 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸‹åˆ—å…³äºè¿›ç¨‹çš„è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä»¥ä¸‹åŠ ç²—çš„å†…å®¹ä¸ºæ­£ç¡®çš„&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»æ“ä½œç³»ç»Ÿçš„è§’åº¦ä¸Šè¯´ï¼Œè¿›ç¨‹æ˜¯ç¨‹åºè¿è¡Œçš„å•ä½&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;è¿›ç¨‹æ ¹æ®åˆ›å»ºæ–¹å¼å»ºç«‹çˆ¶å­å…³ç³»&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿›ç¨‹å¯ä»¥åŒ…å«å…¶ä»–è¿›ç¨‹ï¼Œå³ä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜ç©ºé—´å¯ä»¥åŒ…å«å…¶ä»–è¿›ç¨‹&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­è¿›ç¨‹å¯ä»¥åˆ›å»ºå…¶ä»–å­è¿›ç¨‹ï¼Œè€Œåˆ›å»ºå‡ºæ¥çš„å­è¿›ç¨‹è¿˜å¯ä»¥åˆ›å»ºå…¶ä»–å­è¿›ç¨‹ï¼Œä½†æ‰€æœ‰è¿™äº›è¿›ç¨‹åªä¸ä¸€ä¸ªçˆ¶è¿›ç¨‹å»ºç«‹çˆ¶å­å…³ç³»ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è°ƒç”¨ fork å‡½æ•°å°†åˆ›å»ºå­è¿›ç¨‹ï¼Œä¸€ä¸‹å…³äºå­è¿›ç¨‹é”™è¯¯çš„æ˜¯ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä»¥ä¸‹åŠ ç²—çš„å†…å®¹ä¸ºæ­£ç¡®çš„&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;çˆ¶è¿›ç¨‹é”€æ¯æ—¶ä¹Ÿä¼šåŒæ—¶é”€æ¯å­è¿›ç¨‹&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­è¿›ç¨‹æ˜¯å¤åˆ¶çˆ¶è¿›ç¨‹æ‰€æœ‰èµ„æºåˆ›å»ºå‡ºçš„è¿›ç¨‹&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;çˆ¶å­è¿›ç¨‹å…±äº«å…¨å±€å˜é‡&lt;/li&gt;
&lt;li&gt;é€šè¿‡ fork å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹å°†æ‰§è¡Œä»å¼€å§‹åˆ° fork å‡½æ•°è°ƒç”¨ä¸ºæ­¢çš„ä»£ç ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åˆ›å»ºå­è¿›ç¨‹æ—¶å¤åˆ¶çˆ¶è¿›ç¨‹æ‰€æœ‰å†…å®¹ï¼Œæ­¤æ—¶å¤åˆ¶å¯¹è±¡ä¹ŸåŒ…å«å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ã€‚ç¼–å†™ç¨‹åºéªŒè¯èµ‹å€¼çš„æ–‡ä»¶æè¿°ç¬¦æ•´æ•°å€¼æ˜¯å¦ä¸åŸæ–‡ä»¶æè¿°ç¬¦æ•°å€¼ç›¸åŒã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä»£ç ä¸ºå¤šè¿›ç¨‹æœåŠ¡å™¨ä¿®æ”¹è€Œæ¥ï¼Œä»£ç ï¼š&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch10/test_server.c&#34;&gt;test_server.c&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿è¡Œæˆªå›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/01/21/kPj3Md.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œæ•°å€¼ç›¸åŒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯·è¯´æ˜è¿›ç¨‹å˜ä¸ºåƒµå°¸è¿›ç¨‹çš„è¿‡ç¨‹ä»¥åŠé¢„é˜²æªæ–½ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šå½“ä¸€ä¸ªçˆ¶è¿›ç¨‹ä»¥fork()ç³»ç»Ÿè°ƒç”¨å»ºç«‹ä¸€ä¸ªæ–°çš„å­è¿›ç¨‹åï¼Œæ ¸å¿ƒè¿›ç¨‹å°±ä¼šåœ¨è¿›ç¨‹è¡¨ä¸­ç»™è¿™ä¸ªå­è¿›ç¨‹åˆ†é…ä¸€ä¸ªè¿›å…¥ç‚¹ï¼Œç„¶åå°†ç›¸å…³ä¿¡æ¯å­˜å‚¨åœ¨è¯¥è¿›å…¥ç‚¹æ‰€å¯¹åº”çš„è¿›ç¨‹è¡¨å†…ã€‚è¿™äº›ä¿¡æ¯ä¸­æœ‰ä¸€é¡¹æ˜¯å…¶çˆ¶è¿›ç¨‹çš„è¯†åˆ«ç ã€‚è€Œå½“è¿™ä¸ªå­è¿›ç¨‹ç»“æŸçš„æ—¶å€™ï¼ˆæ¯”å¦‚è°ƒç”¨exitå‘½ä»¤ç»“æŸï¼‰ï¼Œå…¶å®ä»–å¹¶æ²¡æœ‰çœŸæ­£çš„è¢«é”€æ¯ï¼Œè€Œæ˜¯ç•™ä¸‹ä¸€ä¸ªç§°ä¸ºåƒµå°¸è¿›ç¨‹ï¼ˆZombieï¼‰çš„æ•°æ®ç»“æ„ï¼ˆç³»ç»Ÿè°ƒç”¨exitçš„ä½œç”¨æ˜¯ä½¿è¿›ç¨‹é€€å‡ºï¼Œä½†æ˜¯ä¹Ÿä»…ä»…é™äºä¸€ä¸ªæ­£å¸¸çš„è¿›ç¨‹å˜æˆäº†ä¸€ä¸ªåƒµå°¸è¿›ç¨‹ï¼Œå¹¶ä¸èƒ½å®Œå…¨å°†å…¶é”€æ¯ï¼‰ã€‚&lt;strong&gt;é¢„é˜²æªæ–½&lt;/strong&gt;ï¼šé€šè¿‡ wait å’Œ waitpid å‡½æ•°åŠ ä¸Šä¿¡å·å‡½æ•°å†™ä»£ç æ¥é¢„é˜²ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-10-%E7%AB%A0-%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 9 ç«  å¥—æ¥å­—çš„å¤šç§å¯é€‰é¡¹ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-9-%E7%AB%A0-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E5%A4%9A%E7%A7%8D%E5%8F%AF%E9%80%89%E9%A1%B9-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Tue, 29 Mar 2022 17:37:05 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-9-%E7%AB%A0-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E5%A4%9A%E7%A7%8D%E5%8F%AF%E9%80%89%E9%A1%B9-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-9-%E7%AB%A0-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E5%A4%9A%E7%A7%8D%E5%8F%AF%E9%80%89%E9%A1%B9-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-9-ç« -å¥—æ¥å­—çš„å¤šç§å¯é€‰é¡¹&#34;&gt;ç¬¬ 9 ç«  å¥—æ¥å­—çš„å¤šç§å¯é€‰é¡¹&lt;/h2&gt;
&lt;h3 id=&#34;91-å¥—æ¥å­—å¯é€‰é¡¹å’Œ-io-ç¼“å†²å¤§å°&#34;&gt;9.1 å¥—æ¥å­—å¯é€‰é¡¹å’Œ I/O ç¼“å†²å¤§å°&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬è¿›è¡Œå¥—æ¥å­—ç¼–ç¨‹æ—¶å¾€å¾€åªå…³æ³¨æ•°æ®é€šä¿¡ï¼Œè€Œå¿½ç•¥äº†å¥—æ¥å­—å…·æœ‰çš„ä¸åŒç‰¹æ€§ã€‚ä½†æ˜¯ï¼Œç†è§£è¿™äº›ç‰¹æ€§å¹¶æ ¹æ®å®é™…éœ€è¦è¿›è¡Œæ›´æ”¹ä¹Ÿå¾ˆé‡è¦&lt;/p&gt;
&lt;h4 id=&#34;911-å¥—æ¥å­—å¤šç§å¯é€‰é¡¹&#34;&gt;9.1.1 å¥—æ¥å­—å¤šç§å¯é€‰é¡¹&lt;/h4&gt;
&lt;p&gt;æˆ‘ä»¬ä¹‹å‰å†™å¾—ç¨‹åºéƒ½æ˜¯åˆ›å»ºå¥½å¥—æ¥å­—ä¹‹åç›´æ¥ä½¿ç”¨çš„ï¼Œæ­¤æ—¶é€šè¿‡é»˜è®¤çš„å¥—æ¥å­—ç‰¹æ€§è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œè¿™é‡Œåˆ—å‡ºäº†ä¸€äº›å¥—æ¥å­—å¯é€‰é¡¹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åè®®å±‚&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;é€‰é¡¹å&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è¯»å–&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è®¾ç½®&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_SNDBUF&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_RCVBUF&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_REUSEADDR&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_KEEPALIVE&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_BROADCAST&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_DONTROUTE&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_OOBINLINE&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_ERROR&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;X&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SOL_SOCKET&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SO_TYPE&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;X&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IPPROTO_IP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IP_TOS&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IPPROTO_IP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IP_TTL&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IPPROTO_IP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IP_MULTICAST_TTL&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IPPROTO_IP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IP_MULTICAST_LOOP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IPPROTO_IP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IP_MULTICAST_IF&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IPPROTO_TCP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;TCP_KEEPALIVE&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IPPROTO_TCP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;TCP_NODELAY&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;IPPROTO_TCP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;TCP_MAXSEG&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;O&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¥—æ¥å­—å¯é€‰é¡¹æ˜¯åˆ†å±‚çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;IPPROTO_IP å¯é€‰é¡¹æ˜¯IPåè®®ç›¸å…³äº‹é¡¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;IPPROTO_TCP å±‚å¯é€‰é¡¹æ˜¯ TCP åè®®çš„ç›¸å…³äº‹é¡¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SOL_SOCKET å±‚æ˜¯å¥—æ¥å­—çš„é€šç”¨å¯é€‰é¡¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;912-getsockopt--setsockopt&#34;&gt;9.1.2 &lt;code&gt;getsockopt&lt;/code&gt; &amp;amp; &lt;code&gt;setsockopt&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;å¯é€‰é¡¹çš„è¯»å–å’Œè®¾ç½®é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°æ¥å®Œæˆ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;getsockopt&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sock, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; level, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; optname, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; *optval, socklen_t *optlen);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;sock: ç”¨äºæŸ¥çœ‹é€‰é¡¹å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;level: è¦æŸ¥çœ‹çš„å¯é€‰é¡¹åè®®å±‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;optname: è¦æŸ¥çœ‹çš„å¯é€‰é¡¹å
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;optval: ä¿å­˜æŸ¥çœ‹ç»“æœçš„ç¼“å†²åœ°å€å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;optlen: å‘ç¬¬å››ä¸ªå‚æ•°ä¼ é€’çš„ç¼“å†²å¤§å°ã€‚è°ƒç”¨å‡½æ•°å€™ï¼Œè¯¥å˜é‡ä¸­ä¿å­˜é€šè¿‡ç¬¬å››ä¸ªå‚æ•°è¿”å›çš„å¯é€‰é¡¹ä¿¡æ¯çš„å­—èŠ‚æ•°ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸Šè¿°å‡½æ•°å¯ä»¥ç”¨æ¥è¯»å–å¥—æ¥å­—å¯é€‰é¡¹ï¼Œä¸‹é¢çš„å‡½æ•°å¯ä»¥æ›´æ”¹å¯é€‰é¡¹ï¼šd&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;setsockopt&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sock, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; level, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; optname, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; *optval, socklen_t optlen);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;sock: ç”¨äºæ›´æ”¹é€‰é¡¹å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;level: è¦æ›´æ”¹çš„å¯é€‰é¡¹åè®®å±‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;optname: è¦æ›´æ”¹çš„å¯é€‰é¡¹å
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;optval: ä¿å­˜æ›´æ”¹ç»“æœçš„ç¼“å†²åœ°å€å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;optlen: å‘ç¬¬å››ä¸ªå‚æ•°ä¼ é€’çš„ç¼“å†²å¤§å°ã€‚è°ƒç”¨å‡½æ•°å€™ï¼Œè¯¥å˜é‡ä¸­ä¿å­˜é€šè¿‡ç¬¬å››ä¸ªå‚æ•°è¿”å›çš„å¯é€‰é¡¹ä¿¡æ¯çš„å­—èŠ‚æ•°ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸‹é¢çš„ä»£ç å¯ä»¥çœ‹å‡º getsockopt çš„ä½¿ç”¨æ–¹æ³•ã€‚ä¸‹é¢ç¤ºä¾‹ç”¨åè®®å±‚ä¸º SOL_SOCKET ã€åä¸º SO_TYPE çš„å¯é€‰é¡¹æŸ¥çœ‹å¥—æ¥å­—ç±»å‹ï¼ˆTCP å’Œ UDP ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch09/sock_type.c&#34;&gt;sock_type.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc sock_type.c -o sock_type
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./sock_type
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;SOCK_STREAM: 1
SOCK_DGRAM: 2
Socket type one: 1
Socket type two: 2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª TCP å¥—æ¥å­—å’Œä¸€ä¸ª UDP å¥—æ¥å­—ã€‚ç„¶åé€šè¿‡è°ƒç”¨ getsockopt å‡½æ•°æ¥è·å¾—å½“å‰å¥—æ¥å­—çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;éªŒè¯å¥—æ¥ç±»å‹çš„ SO_TYPE æ˜¯åªè¯»å¯é€‰é¡¹ï¼Œå› ä¸º&lt;strong&gt;å¥—æ¥å­—ç±»å‹åªèƒ½åœ¨åˆ›å»ºæ—¶å†³å®šï¼Œä»¥åä¸èƒ½å†æ›´æ”¹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;913-so_sndbuf--so_rcvbuf&#34;&gt;9.1.3 &lt;code&gt;SO_SNDBUF&lt;/code&gt; &amp;amp; &lt;code&gt;SO_RCVBUF&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;åˆ›å»ºå¥—æ¥å­—çš„åŒæ—¶ä¼šç”Ÿæˆ I/O ç¼“å†²ã€‚å…³äº I/O ç¼“å†²ï¼Œå¯ä»¥å»çœ‹ç¬¬äº”ç« ã€‚&lt;/p&gt;
&lt;p&gt;SO_RCVBUF æ˜¯è¾“å…¥ç¼“å†²å¤§å°ç›¸å…³å¯é€‰é¡¹ï¼ŒSO_SNDBUF æ˜¯è¾“å‡ºç¼“å†²å¤§å°ç›¸å…³å¯é€‰é¡¹ã€‚ç”¨è¿™ 2 ä¸ªå¯é€‰é¡¹æ—¢å¯ä»¥è¯»å–å½“å‰ I/O å¤§å°ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæ›´æ”¹ã€‚é€šè¿‡ä¸‹åˆ—ç¤ºä¾‹è¯»å–åˆ›å»ºå¥—æ¥å­—æ—¶é»˜è®¤çš„ I/O ç¼“å†²å¤§å°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch09/get_buf.c&#34;&gt;get_buf.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc get_buf.c -o getbuf
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./getbuf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Input buffer size: 87380
Output buffer size: 16384
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥çœ‹å‡ºæœ¬æœºçš„è¾“å…¥ç¼“å†²å’Œè¾“å‡ºç¼“å†²å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†ï¼Œé€šè¿‡ç¨‹åºè®¾ç½® I/O ç¼“å†²åŒºçš„å¤§å°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch09/set_buf.c&#34;&gt;set_buf.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc get_buf.c -o setbuf
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./setbuf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœ:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Input buffer size: 6144
Output buffer size: 6144
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¾“å‡ºç»“æœå’Œæˆ‘ä»¬é¢„æƒ³çš„ä¸æ˜¯å¾ˆç›¸åŒï¼Œç¼“å†²å¤§å°çš„è®¾ç½®éœ€è°¨æ…å¤„ç†ï¼Œå› æ­¤ä¸ä¼šå®Œå…¨æŒ‰ç…§æˆ‘ä»¬çš„è¦æ±‚è¿›è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;92-so_reuseaddr&#34;&gt;9.2 &lt;code&gt;SO_REUSEADDR&lt;/code&gt;&lt;/h3&gt;
&lt;h4 id=&#34;921-å‘ç”Ÿåœ°å€åˆ†é…é”™è¯¯binding-error&#34;&gt;9.2.1 å‘ç”Ÿåœ°å€åˆ†é…é”™è¯¯ï¼ˆBinding Errorï¼‰&lt;/h4&gt;
&lt;p&gt;åœ¨å­¦ä¹  SO_REUSEADDR å¯é€‰é¡¹ä¹‹å‰ï¼Œåº”è¯¥å¥½å¥½ç†è§£ Time-wait çŠ¶æ€ã€‚çœ‹ä»¥ä¸‹ä»£ç çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch09/reuseadr_eserver.c&#34;&gt;reuseadr_eserver.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå›å£°æœåŠ¡å™¨çš„æœåŠ¡ç«¯ä»£ç ï¼Œå¯ä»¥é…åˆç¬¬å››ç« çš„ &lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch04/echo_client.c&#34;&gt;echo_client.c&lt;/a&gt; ä½¿ç”¨ï¼Œåœ¨è¿™ä¸ªä»£ç ä¸­ï¼Œå®¢æˆ·ç«¯é€šçŸ¥æœåŠ¡å™¨ç»ˆæ­¢ç¨‹åºã€‚åœ¨å®¢æˆ·ç«¯æ§åˆ¶å°è¾“å…¥ Q å¯ä»¥ç»“æŸç¨‹åºï¼Œå‘æœåŠ¡å™¨å‘é€ FIN æ¶ˆæ¯å¹¶ç»è¿‡å››æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚å½“ç„¶ï¼Œè¾“å…¥ CTRL+C ä¹Ÿä¼šå‘æœåŠ¡å™¨ä¼ é€’ FIN ä¿¡æ¯ã€‚å¼ºåˆ¶ç»ˆæ­¢ç¨‹åºæ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿå…³é—­æ–‡ä»¶å¥—æ¥å­—ï¼Œæ­¤è¿‡ç¨‹ç›¸å½“äºè°ƒç”¨ close å‡½æ•°ï¼Œä¹Ÿä¼šå‘æœåŠ¡å™¨å‘é€ FIN æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·çœ‹ä¸åˆ°æ˜¯ä»€ä¹ˆç‰¹æ®Šç°è±¡ï¼Œè€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯éƒ½å·²ç»å»ºç«‹è¿æ¥çš„çŠ¶æ€ä¸‹ï¼Œå‘æœåŠ¡å™¨æ§åˆ¶å°è¾“å…¥ CTRL+C ï¼Œå¼ºåˆ¶å…³é—­æœåŠ¡ç«¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœç”¨è¿™ç§æ–¹å¼ç»ˆæ­¢ç¨‹åºï¼Œå¦‚æœç”¨åŒä¸€ç«¯å£å·å†æ¬¡è¿è¡ŒæœåŠ¡ç«¯ï¼Œå°±ä¼šè¾“å‡ºã€Œbind() errorã€æ¶ˆæ¯ï¼Œå¹¶ä¸”æ— æ³•å†æ¬¡è¿è¡Œã€‚ä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†è¿‡å¤§çº¦ 3 åˆ†é’Ÿå°±å¯ä»¥é‡æ–°è¿è¡ŒæœåŠ¡ç«¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;922-time-wait-çŠ¶æ€&#34;&gt;9.2.2 &lt;code&gt;Time-wait&lt;/code&gt; çŠ¶æ€&lt;/h4&gt;
&lt;p&gt;è§‚å¯Ÿä»¥ä¸‹è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/19/5c42db182cade.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾å›¾ä¸­ä¸»æœº A æ˜¯æœåŠ¡å™¨ï¼Œå› ä¸ºæ˜¯ä¸»æœº A å‘ B å‘é€ FIN æ¶ˆæ¯ï¼Œæ•…å¯æƒ³è±¡æˆæœåŠ¡å™¨ç«¯åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ CTRL+C ã€‚ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå¥—æ¥å­—ç»è¿‡å››æ¬¡æ¡æ‰‹åå¹¶æ²¡æœ‰ç«‹å³æ¶ˆé™¤ï¼Œè€Œæ˜¯è¦ç»è¿‡ä¸€æ®µæ—¶é—´çš„ Time-wait çŠ¶æ€ã€‚å½“ç„¶ï¼Œåªæœ‰å…ˆæ–­å¼€è¿æ¥çš„ï¼ˆå…ˆå‘é€ FIN æ¶ˆæ¯çš„ï¼‰ä¸»æœºæ‰ç»è¿‡ Time-wait çŠ¶æ€ã€‚å› æ­¤ï¼Œè‹¥æœåŠ¡å™¨ç«¯å…ˆæ–­å¼€è¿æ¥ï¼Œåˆ™æ— æ³•ç«‹å³é‡æ–°è¿è¡Œã€‚å¥—æ¥å­—å¤„åœ¨ Time-wait è¿‡ç¨‹æ—¶ï¼Œç›¸åº”ç«¯å£æ˜¯æ­£åœ¨ä½¿ç”¨çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œå°±åƒä¹‹å‰éªŒè¯è¿‡çš„ï¼Œbind å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿé”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®é™…ä¸Šï¼Œä¸è®ºæ˜¯æœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œéƒ½è¦ç»è¿‡ä¸€æ®µæ—¶é—´çš„ Time-wait è¿‡ç¨‹ã€‚å…ˆæ–­å¼€è¿æ¥çš„å¥—æ¥å­—å¿…ç„¶ä¼šç»è¿‡ Time-wait è¿‡ç¨‹ï¼Œä½†æ˜¯ç”±äºå®¢æˆ·ç«¯å¥—æ¥å­—çš„ç«¯å£æ˜¯ä»»æ„åˆ¶å®šçš„ï¼Œæ‰€ä»¥æ— éœ€è¿‡å¤šå…³æ³¨ Time-wait çŠ¶æ€ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é‚£åˆ°åº•ä¸ºä»€ä¹ˆä¼šæœ‰ Time-wait çŠ¶æ€å‘¢ï¼Œåœ¨å›¾ä¸­å‡è®¾ï¼Œä¸»æœº A å‘ä¸»æœº B ä¼ è¾“ ACK æ¶ˆæ¯ï¼ˆSEQ 5001 , ACK 7502 ï¼‰åç«‹åˆ»æ¶ˆé™¤å¥—æ¥å­—ã€‚ä½†æ˜¯æœ€åè¿™æ¡ ACK æ¶ˆæ¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­ä¸¢å¤±ï¼Œæ²¡æœ‰ä¼ é€’ä¸»æœº B ï¼Œè¿™æ—¶ä¸»æœº B å°±ä¼šè¯•å›¾é‡ä¼ ã€‚ä½†æ˜¯æ­¤æ—¶ä¸»æœº A å·²ç»æ˜¯å®Œå…¨ç»ˆæ­¢çŠ¶æ€ï¼Œå› ä¸ºä¸»æœº B æ°¸è¿œæ— æ³•æ”¶åˆ°ä»ä¸»æœº A æœ€åä¼ æ¥çš„ ACK æ¶ˆæ¯ã€‚åŸºäºè¿™äº›é—®é¢˜çš„è€ƒè™‘ï¼Œæ‰€ä»¥è¦è®¾è®¡ Time-wait çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h4 id=&#34;923-åœ°å€å†åˆ†é…&#34;&gt;9.2.3 åœ°å€å†åˆ†é…&lt;/h4&gt;
&lt;p&gt;Time-wait çŠ¶æ€çœ‹ä¼¼é‡è¦ï¼Œä½†æ˜¯ä¸ä¸€å®šè®¨äººå–œæ¬¢ã€‚å¦‚æœç³»ç»Ÿå‘ç”Ÿæ•…éšœç´§æ€¥åœæ­¢ï¼Œè¿™æ—¶éœ€è¦å°½å¿«é‡å¯æœåŠ¡èµ·ä»¥æä¾›æœåŠ¡ï¼Œä½†å› å¤„äº Time-wait çŠ¶æ€è€Œå¿…é¡»ç­‰å¾…å‡ åˆ†é’Ÿã€‚å› æ­¤ï¼ŒTime-wait å¹¶éåªæœ‰ä¼˜ç‚¹ï¼Œè¿™äº›æƒ…å†µä¸‹å®¹æ˜“å¼•å‘å¤§é—®é¢˜ã€‚ä¸‹å›¾ä¸­å±•ç¤ºäº†å››æ¬¡æ¡æ‰‹æ—¶ä¸å¾—ä¸å»¶é•¿ Time-wait è¿‡ç¨‹çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/19/5c42dec2ba42b.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¸»æœº A å››æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ€åçš„æ•°æ®ä¸¢å¤±ï¼Œåˆ™ä¸»æœº B ä¼šè®¤ä¸ºä¸»æœº A æœªèƒ½æ”¶åˆ°è‡ªå·±å‘é€çš„ FIN ä¿¡æ¯ï¼Œå› æ­¤é‡ä¼ ã€‚è¿™æ—¶ï¼Œæ”¶åˆ°çš„ FIN æ¶ˆæ¯çš„ä¸»æœº A å°†é‡å¯  Time-wait è®¡æ—¶å™¨ã€‚å› æ­¤ï¼Œå¦‚æœç½‘ç»œçŠ¶å†µä¸ç†æƒ³ï¼Œ Time-wait å°†æŒç»­ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨å¥—æ¥å­—çš„å¯é€‰é¡¹ä¸­æ›´æ”¹ SO_REUSEADDR çš„çŠ¶æ€ã€‚é€‚å½“è°ƒæ•´è¯¥å‚æ•°ï¼Œå¯å°† Time-wait çŠ¶æ€ä¸‹çš„å¥—æ¥å­—ç«¯å£å·é‡æ–°åˆ†é…ç»™æ–°çš„å¥—æ¥å­—ã€‚SO_REUSEADDR çš„é»˜è®¤å€¼ä¸º 0.è¿™å°±æ„å‘³ç€æ— æ³•åˆ†é… Time-wait çŠ¶æ€ä¸‹çš„å¥—æ¥å­—ç«¯å£å·ã€‚å› æ­¤éœ€è¦å°†è¿™ä¸ªå€¼æ”¹æˆ 1 ã€‚å…·ä½“ä½œæ³•å·²åœ¨ç¤ºä¾‹ &lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch09/reuseadr_eserver.c&#34;&gt;reuseadr_eserver.c&lt;/a&gt; ç»™å‡ºï¼Œåªéœ€è¦æŠŠæ³¨é‡Šæ‰çš„ä¸œè¥¿æ¥è§£é™¤æ³¨é‡Šå³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;optlen = &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(option);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;option = TRUE;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;setsockopt(serv_sock, SOL_SOCKET, SO_REUSEADDR, (&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; *)&amp;amp;option, optlen);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ­¤æ—¶ï¼Œå·²ç»è§£å†³äº†ä¸Šè¿°é—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;93-tcp_nodelay&#34;&gt;9.3 &lt;code&gt;TCP_NODELAY&lt;/code&gt;&lt;/h3&gt;
&lt;h4 id=&#34;931-nagle-ç®—æ³•&#34;&gt;9.3.1 &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•&lt;/h4&gt;
&lt;p&gt;ä¸ºäº†é˜²æ­¢å› æ•°æ®åŒ…è¿‡å¤šè€Œå‘ç”Ÿç½‘ç»œè¿‡è½½ï¼Œ&lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•è¯ç”Ÿäº†ã€‚å®ƒåº”ç”¨äº TCP å±‚ã€‚å®ƒæ˜¯å¦ä½¿ç”¨ä¼šå¯¼è‡´å¦‚å›¾æ‰€ç¤ºçš„å·®å¼‚ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/19/5c42e12abc5b8.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å›¾ä¸­å±•ç¤ºäº†é€šè¿‡ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•å‘é€å­—ç¬¦ä¸² &lt;code&gt;Nagle&lt;/code&gt; å’Œæœªä½¿ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•çš„å·®åˆ«ã€‚å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åªæœ‰æ¥æ”¶åˆ°å‰ä¸€æ•°æ®çš„ ACK æ¶ˆæ¯ï¼Œ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•æ‰å‘é€ä¸‹ä¸€æ•°æ®ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;TCP å¥—æ¥å­—é»˜è®¤ä½¿ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•äº¤æ¢æ•°æ®ï¼Œå› æ­¤æœ€å¤§é™åº¦çš„è¿›è¡Œç¼“å†²ï¼Œç›´åˆ°æ”¶åˆ° ACK ã€‚å·¦å›¾ä¹Ÿå°±æ˜¯è¯´ä¸€å…±ä¼ é€’ 4 ä¸ªæ•°æ®åŒ…ä»¥ä¼ è¾“ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä»å³å›¾å¯ä»¥çœ‹å‡ºï¼Œå‘é€æ•°æ®åŒ…ä¸€å…±ä½¿ç”¨äº† 10 ä¸ªæ•°æ®åŒ…ã€‚ç”±æ­¤å¯çŸ¥ï¼Œä¸ä½¿ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•å°†å¯¹ç½‘ç»œæµé‡äº§ç”Ÿè´Ÿé¢å½±å“ã€‚å³ä½¿åªä¼ è¾“ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œå…¶å¤´ä¿¡æ¯éƒ½å¯èƒ½æ˜¯å‡ åä¸ªå­—èŠ‚ã€‚å› æ­¤ï¼Œä¸ºäº†æé«˜ç½‘ç»œä¼ è¾“æ•ˆç‡ï¼Œå¿…é¡»ä½¿ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•å¹¶ä¸æ˜¯ä»€ä¹ˆæƒ…å†µä¸‹éƒ½é€‚ç”¨ï¼Œç½‘ç»œæµé‡æœªå—å¤ªå¤§å½±å“æ—¶ï¼Œä¸ä½¿ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•è¦æ¯”ä½¿ç”¨å®ƒæ—¶ä¼ è¾“é€Ÿåº¦å¿«ã€‚æœ€å…¸å‹çš„å°±æ˜¯ã€Œä¼ è¾“å¤§æ–‡æ•°æ®ã€ã€‚å°†æ–‡ä»¶æ•°æ®ä¼ å…¥è¾“å‡ºç¼“å†²ä¸ä¼šèŠ±å¤ªå¤šæ—¶é—´ï¼Œå› æ­¤ï¼Œä¸ä½¿ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•ï¼Œä¹Ÿä¼šåœ¨è£…æ»¡è¾“å‡ºç¼“å†²æ—¶ä¼ è¾“æ•°æ®åŒ…ã€‚è¿™ä¸ä»…ä¸ä¼šå¢åŠ æ•°æ®åŒ…çš„æ•°é‡ï¼Œåè€Œåœ¨æ— éœ€ç­‰å¾… ACK çš„å‰æä¸‹è¿ç»­ä¼ è¾“ï¼Œå› æ­¤å¯ä»¥å¤§å¤§æé«˜ä¼ è¾“é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæœªå‡†ç¡®åˆ¤æ–­æ•°æ®æ€§è´¨æ—¶ä¸åº”ç¦ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•ã€‚&lt;/p&gt;
&lt;h4 id=&#34;932-ç¦ç”¨-nagle-ç®—æ³•&#34;&gt;9.3.2 ç¦ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•&lt;/h4&gt;
&lt;p&gt;ç¦ç”¨ &lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•åº”è¯¥ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; opt_val = &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;setsockopt(sock, IPPROTO_TCP, TCP_NODELAY, (&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; *)&amp;amp;opt_val, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(opt_val));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é€šè¿‡ TCP_NODELAY çš„å€¼æ¥æŸ¥çœ‹&lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•çš„è®¾ç½®çŠ¶æ€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;opt_len = &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(opt_val);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;getsockopt(sock, IPPROTO_TCP, TCP_NODELAY, (&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; *)&amp;amp;opt_val, opt_len);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¦‚æœæ­£åœ¨ä½¿ç”¨&lt;code&gt;Nagle&lt;/code&gt; ç®—æ³•ï¼Œé‚£ä¹ˆ opt_val å€¼ä¸º 0ï¼Œå¦‚æœç¦ç”¨åˆ™ä¸º 1.&lt;/p&gt;
&lt;p&gt;å…³äºè¿™ä¸ªç®—æ³•ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªå›ç­”ï¼š&lt;a href=&#34;https://www.zhihu.com/question/42308970/answer/246334766&#34;&gt;TCPè¿æ¥ä¸­å¯ç”¨å’Œç¦ç”¨TCP_NODELAYæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;94-åŸºäº-windows-çš„å®ç°&#34;&gt;9.4 åŸºäº Windows çš„å®ç°&lt;/h3&gt;
&lt;p&gt;æš‚ç•¥&lt;/p&gt;
&lt;h3 id=&#34;95-ä¹ é¢˜&#34;&gt;9.5 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸‹åˆ—å…³äº Time-wait çŠ¶æ€çš„è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä»¥ä¸‹å­—ä½“åŠ ç²—çš„ä»£è¡¨æ­£ç¡®ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Time-wait çŠ¶æ€åªåœ¨æœåŠ¡å™¨çš„å¥—æ¥å­—ä¸­å‘ç”Ÿ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–­å¼€è¿æ¥çš„å››æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­ï¼Œå…ˆä¼ è¾“ FIN æ¶ˆæ¯çš„å¥—æ¥å­—å°†è¿›å…¥ Time-wait çŠ¶æ€ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Time-wait çŠ¶æ€ä¸æ–­å¼€è¿æ¥çš„è¿‡ç¨‹æ— å…³ï¼Œè€Œä¸è¯·æ±‚è¿æ¥è¿‡ç¨‹ä¸­ SYN æ¶ˆæ¯çš„ä¼ è¾“é¡ºåºæœ‰å…³&lt;/li&gt;
&lt;li&gt;Time-wait çŠ¶æ€é€šå¸¸å¹¶éå¿…è¦ï¼Œåº”å°½å¯èƒ½é€šè¿‡æ›´æ”¹å¥—æ¥å­—å¯é€‰é¡¹æ¥é˜²æ­¢å…¶å‘ç”Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;TCP_NODELAY å¯é€‰é¡¹ä¸ Nagle ç®—æ³•æœ‰å…³ï¼Œå¯é€šè¿‡å®ƒç¦ç”¨ Nagle ç®—æ³•ã€‚è¯·é—®ä½•æ—¶åº”è€ƒè™‘ç¦ç”¨ Nagle ç®—æ³•ï¼Ÿç»“åˆæ”¶å‘æ•°æ®çš„ç‰¹æ€§ç»™å‡ºè¯´æ˜ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šå½“ç½‘ç»œæµé‡æœªå—å¤ªå¤§å½±å“æ—¶ï¼Œä¸ä½¿ç”¨ Nagle ç®—æ³•è¦æ¯”ä½¿ç”¨å®ƒæ—¶ä¼ è¾“é€Ÿåº¦å¿«ï¼Œæ¯”å¦‚è¯´åœ¨ä¼ è¾“å¤§æ–‡ä»¶æ—¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-9-%E7%AB%A0-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E5%A4%9A%E7%A7%8D%E5%8F%AF%E9%80%89%E9%A1%B9-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 8 ç«  åŸŸååŠç½‘ç»œåœ°å€ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-8-%E7%AB%A0-%E5%9F%9F%E5%90%8D%E5%8F%8A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Mon, 28 Mar 2022 18:09:27 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-8-%E7%AB%A0-%E5%9F%9F%E5%90%8D%E5%8F%8A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-8-%E7%AB%A0-%E5%9F%9F%E5%90%8D%E5%8F%8A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-8-ç« -åŸŸååŠç½‘ç»œåœ°å€&#34;&gt;ç¬¬ 8 ç«  åŸŸååŠç½‘ç»œåœ°å€&lt;/h2&gt;
&lt;h3 id=&#34;81-åŸŸåç³»ç»Ÿ&#34;&gt;8.1 åŸŸåç³»ç»Ÿ&lt;/h3&gt;
&lt;p&gt;DNS æ˜¯å¯¹IPåœ°å€å’ŒåŸŸåè¿›è¡Œç›¸äº’è½¬æ¢çš„ç³»ç»Ÿï¼Œå…¶æ ¸å¿ƒæ˜¯ DNS æœåŠ¡å™¨&lt;/p&gt;
&lt;h4 id=&#34;811-ä»€ä¹ˆæ˜¯åŸŸå&#34;&gt;8.1.1 ä»€ä¹ˆæ˜¯åŸŸå&lt;/h4&gt;
&lt;p&gt;åŸŸåå°±æ˜¯æˆ‘ä»¬å¸¸å¸¸åœ¨åœ°å€æ é‡Œé¢è¾“å…¥çš„åœ°å€ï¼Œå°†æ¯”è¾ƒéš¾è®°å¿†çš„IPåœ°å€å˜æˆäººç±»å®¹æ˜“ç†è§£çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;812-dns-æœåŠ¡å™¨&#34;&gt;8.1.2 DNS æœåŠ¡å™¨&lt;/h4&gt;
&lt;p&gt;ç›¸å½“äºä¸€ä¸ªå­—å…¸ï¼Œå¯ä»¥æŸ¥è¯¢å‡ºæŸä¸€ä¸ªåŸŸåå¯¹åº”çš„IPåœ°å€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c41854859ae3.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼Œæ˜¾ç¤ºäº† DNS æœåŠ¡å™¨çš„æŸ¥è¯¢è·¯å¾„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;82-ipåœ°å€å’ŒåŸŸåä¹‹é—´çš„è½¬æ¢&#34;&gt;8.2 IPåœ°å€å’ŒåŸŸåä¹‹é—´çš„è½¬æ¢&lt;/h3&gt;
&lt;h4 id=&#34;821-ç¨‹åºä¸­æœ‰å¿…è¦ä½¿ç”¨åŸŸåå—&#34;&gt;8.2.1 ç¨‹åºä¸­æœ‰å¿…è¦ä½¿ç”¨åŸŸåå—ï¼Ÿ&lt;/h4&gt;
&lt;p&gt;ä¸€å¥è¯ï¼Œéœ€è¦ï¼Œå› ä¸ºIPåœ°å€å¯èƒ½ç»å¸¸æ”¹å˜ï¼Œè€Œä¸”ä¹Ÿä¸å®¹æ˜“è®°å¿†ï¼Œé€šè¿‡åŸŸåå¯ä»¥éšæ—¶æ›´æ”¹è§£æï¼Œè¾¾åˆ°æ›´æ¢IPçš„ç›®çš„&lt;/p&gt;
&lt;h4 id=&#34;822-åˆ©ç”¨åŸŸåè·å–ipåœ°å€&#34;&gt;8.2.2 åˆ©ç”¨åŸŸåè·å–IPåœ°å€&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨ä»¥ä¸‹å‡½æ•°å¯ä»¥é€šè¿‡ä¼ é€’å­—ç¬¦ä¸²æ ¼å¼çš„åŸŸåè·å–IPåœ°å€&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;netdb.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; hostent *&lt;span style=&#34;color:#008b45&#34;&gt;gethostbyname&lt;/span&gt;(&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *hostname);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å› hostent ç»“æ„ä½“åœ°å€ï¼Œå¤±è´¥æ—¶è¿”å› NULL æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°ä½¿ç”¨æ–¹ä¾¿ï¼Œåªè¦ä¼ é€’å­—ç¬¦ä¸²ï¼Œå°±å¯ä»¥è¿”å›åŸŸåå¯¹åº”çš„IPåœ°å€ã€‚åªæ˜¯è¿”å›æ—¶ï¼Œåœ°å€ä¿¡æ¯è£…å…¥ hostent ç»“æ„ä½“ã€‚æ­¤ç»“æ„ä½“çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; hostent
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *h_name;       &lt;span style=&#34;color:#228b22&#34;&gt;/* Official name of host.  */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; **h_aliases;   &lt;span style=&#34;color:#228b22&#34;&gt;/* Alias list.  */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; h_addrtype;     &lt;span style=&#34;color:#228b22&#34;&gt;/* Host address type.  */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; h_length;       &lt;span style=&#34;color:#228b22&#34;&gt;/* Length of address.  */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; **h_addr_list; &lt;span style=&#34;color:#228b22&#34;&gt;/* List of addresses from name server.  */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä»ä¸Šè¿°ç»“æ„ä½“å¯ä»¥çœ‹å‡ºï¼Œä¸æ­¢è¿”å›IPä¿¡æ¯ï¼ŒåŒäº‹è¿˜å¸¦ç€å…¶ä»–ä¿¡æ¯ä¸€èµ·è¿”å›ã€‚åŸŸåè½¬æ¢æˆIPæ—¶åªéœ€è¦å…³æ³¨ h_addr_list ã€‚ä¸‹é¢ç®€è¦è¯´æ˜ä¸Šè¿°ç»“æ„ä½“çš„æˆå‘˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;h_nameï¼šè¯¥å˜é‡ä¸­å­˜æœ‰å®˜æ–¹åŸŸåï¼ˆOfficial domain nameï¼‰ã€‚å®˜æ–¹åŸŸåä»£è¡¨æŸä¸€ä¸»é¡µï¼Œä½†å®é™…ä¸Šï¼Œä¸€äº›è‘—åå…¬å¸çš„åŸŸåå¹¶æ²¡æœ‰ç”¨å®˜æ–¹åŸŸåæ³¨å†Œã€‚&lt;/li&gt;
&lt;li&gt;h_aliasesï¼šå¯ä»¥é€šè¿‡å¤šä¸ªåŸŸåè®¿é—®åŒä¸€ä¸»é¡µã€‚åŒä¸€IPå¯ä»¥ç»‘å®šå¤šä¸ªåŸŸåï¼Œå› æ­¤ï¼Œé™¤å®˜æ–¹åŸŸåå¤–è¿˜å¯ä»¥æŒ‡å®šå…¶ä»–åŸŸåã€‚è¿™äº›ä¿¡æ¯å¯ä»¥é€šè¿‡ h_aliases è·å¾—ã€‚&lt;/li&gt;
&lt;li&gt;h_addrtypeï¼šgethostbyname å‡½æ•°ä¸ä»…æ”¯æŒ IPV4 è¿˜æ”¯æŒ IPV6 ã€‚å› æ­¤å¯ä»¥é€šè¿‡æ­¤å˜é‡è·å–ä¿å­˜åœ¨ h_addr_list çš„IPåœ°å€æ—ä¿¡æ¯ã€‚è‹¥æ˜¯ IPV4 ï¼Œåˆ™æ­¤å˜é‡ä¸­å­˜æœ‰ AF_INETã€‚&lt;/li&gt;
&lt;li&gt;h_lengthï¼šä¿å­˜IPåœ°å€é•¿åº¦ã€‚è‹¥æ˜¯ IPV4 åœ°å€ï¼Œå› ä¸ºæ˜¯ 4 ä¸ªå­—èŠ‚ï¼Œåˆ™ä¿å­˜4ï¼›IPV6 æ—¶ï¼Œå› ä¸ºæ˜¯ 16 ä¸ªå­—èŠ‚ï¼Œæ•…ä¿å­˜ 16&lt;/li&gt;
&lt;li&gt;h_addr_listï¼šè¿™ä¸ªæ˜¯æœ€é‡è¦çš„çš„æˆå‘˜ã€‚é€šè¿‡æ­¤å˜é‡ä»¥æ•´æ•°å½¢å¼ä¿å­˜åŸŸåç›¸å¯¹åº”çš„IPåœ°å€ã€‚å¦å¤–ï¼Œç”¨æˆ·æ¯”è¾ƒå¤šçš„ç½‘ç«™æœ‰å¯èƒ½åˆ†é…å¤šä¸ªIPåœ°å€ç»™åŒä¸€ä¸ªåŸŸåï¼Œåˆ©ç”¨å¤šä¸ªæœåŠ¡å™¨åšè´Ÿè½½å‡è¡¡ï¼Œã€‚æ­¤æ—¶å¯ä»¥é€šè¿‡æ­¤å˜é‡è·å–IPåœ°å€ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è°ƒç”¨ gethostbyname å‡½æ•°åï¼Œè¿”å›çš„ç»“æ„ä½“å˜é‡å¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c41898ae45e8.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥æ¼”ç¤º gethostbyname çš„åº”ç”¨ï¼Œå¹¶è¯´æ˜ hostent ç»“æ„ä½“å˜é‡ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch08/gethostbyname.c&#34;&gt;gethostbyname.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc gethostbyname.c -o hostname
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./hostname www.baidu.com
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c418faf20495.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼Œæ˜¾ç¤ºå‡ºäº†å¯¹ç™¾åº¦çš„åŸŸåè§£æ&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œç™¾åº¦æœ‰ä¸€ä¸ªåŸŸåè§£ææ˜¯ CNAME è§£æçš„ï¼ŒæŒ‡å‘äº†&lt;code&gt;shifen.com&lt;/code&gt;ï¼Œå…³äºç™¾åº¦å…·ä½“çš„è§£æè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸€éƒ¨åˆ†ç‰µæ‰¯åˆ°äº†å¾ˆå¤šå…³äºDNSè§£æçš„è¿‡ç¨‹ï¼Œè¿˜æœ‰ Linux ä¸‹å…³äºåŸŸåè§£æçš„ä¸€äº›å‘½ä»¤ï¼Œæˆ‘æ‰¾äº†ä¸€éƒ¨åˆ†èµ„æ–™ï¼Œå¯ä»¥ç‚¹ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ¯”è¾ƒè¯¦ç»†çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://zhan.renren.com/starshen?gid=3602888498023142484&amp;amp;checked=true&#34;&gt;å…³äºç™¾åº¦DNSçš„è§£æè¿‡ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.zhihu.com/question/23042131/answer/66571369&#34;&gt;DNSè§£æçš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Œæ±‚è¯¦ç»†çš„ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/45535596&#34;&gt;Linux DNS æŸ¥è¯¢å‰–æ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.live-in.org/archives/1938.html&#34;&gt;Linux DNSæŸ¥è¯¢å‘½ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.csdn.net/shangdi1988/article/details/65713077&#34;&gt;Linuxä¸­DNSæœåŠ¡å™¨åœ°å€æŸ¥è¯¢å‘½ä»¤nslookupä½¿ç”¨æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.ruanyifeng.com/blog/2016/06/dns.html&#34;&gt;DNS åŸç†å…¥é—¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»”ç»†é˜…è¯»è¿™ä¸€æ®µä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;inet_ntoa(*(&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; in_addr *)host-&amp;gt;h_addr_list[i])
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è‹¥åªçœ‹ hostent çš„å®šä¹‰ï¼Œç»“æ„ä½“æˆå‘˜ h_addr_list æŒ‡å‘å­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ï¼ˆç”±å¤šä¸ªå­—ç¬¦ä¸²åœ°å€æ„æˆçš„æ•°ç»„ï¼‰ã€‚ä½†æ˜¯å­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ä¿å­˜çš„å…ƒç´ å®é™…æŒ‡å‘çš„æ˜¯ in_addr ç»“æ„ä½“å˜é‡ä¸­åœ°å€å€¼è€Œéå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´&lt;code&gt;(struct in_addr *)host-&amp;gt;h_addr_list[i]&lt;/code&gt;å…¶å®æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œç„¶åç”¨&lt;code&gt;*&lt;/code&gt;ç¬¦å·å–å…·ä½“çš„å€¼ã€‚å¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c419658a73b8.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;823-åˆ©ç”¨ipåœ°å€è·å–åŸŸå&#34;&gt;8.2.3 åˆ©ç”¨IPåœ°å€è·å–åŸŸå&lt;/h4&gt;
&lt;p&gt;è¯·çœ‹ä¸‹é¢çš„å‡½æ•°å®šä¹‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;netdb.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; hostent *&lt;span style=&#34;color:#008b45&#34;&gt;gethostbyaddr&lt;/span&gt;(&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;char&lt;/span&gt; *addr, socklen_t len, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; family);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å› hostent ç»“æ„ä½“å˜é‡åœ°å€å€¼ï¼Œå¤±è´¥æ—¶è¿”å› NULL æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;addr: å«æœ‰IPåœ°å€ä¿¡æ¯çš„ in_addr ç»“æ„ä½“æŒ‡é’ˆã€‚ä¸ºäº†åŒæ—¶ä¼ é€’ IPV4 åœ°å€ä¹‹å¤–çš„å…¨éƒ¨ä¿¡æ¯ï¼Œè¯¥å˜é‡çš„ç±»å‹å£°æ˜ä¸º char æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;len: å‘ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’çš„åœ°å€ä¿¡æ¯çš„å­—èŠ‚æ•°ï¼ŒIPV4æ—¶ä¸º 4 ï¼ŒIPV6 æ—¶ä¸º16.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;family: ä¼ é€’åœ°å€æ—ä¿¡æ¯ï¼Œipv4 æ˜¯ AF_INET ï¼ŒIPV6æ˜¯ AF_INET6
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸‹é¢çš„ä»£ç æ¼”ç¤ºä½¿ç”¨æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch08/gethostbyaddr.c&#34;&gt;gethostbyaddr.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc gethostbyaddr.c -o hostaddr
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./hostaddr 8.8.8.8
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c41a019085d4.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œ&lt;code&gt;8.8.8.8&lt;/code&gt;è¿™ä¸ªIPåœ°å€æ˜¯è°·æ­Œçš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;83-åŸºäº-windows-çš„å®ç°&#34;&gt;8.3 åŸºäº Windows çš„å®ç°&lt;/h3&gt;
&lt;p&gt;æš‚ç•¥&lt;/p&gt;
&lt;h3 id=&#34;84-ä¹ é¢˜&#34;&gt;8.4 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸‹åˆ—å…³äºDNSçš„è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šå­—ä½“åŠ ç²—çš„è¡¨ç¤ºæ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å› ä¸ºDNSä»å­˜åœ¨ï¼Œæ•…å¯ä»¥ä½¿ç”¨åŸŸåä»£æ›¿IP&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;DNSæœåŠ¡å™¨å®é™…ä¸Šæ˜¯è·¯ç”±å™¨ï¼Œå› ä¸ºè·¯ç”±å™¨æ ¹æ®åŸŸåå†³å®šæ•°æ®çš„è·¯å¾„&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰åŸŸåä¿¡æ¯å¹¶éé›†ä¸­ä¸ 1 å° DNS æœåŠ¡å™¨ï¼Œä½†å¯ä»¥è·å–æŸä¸€ DNS æœåŠ¡å™¨ä¸­æœªæ³¨å†Œçš„æ‰€æœ‰åœ°å€&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;DNS æœåŠ¡å™¨æ ¹æ®æ“ä½œç³»ç»Ÿè¿›è¡ŒåŒºåˆ†ï¼ŒWindows ä¸‹çš„ DNS æœåŠ¡å™¨å’Œ Linux ä¸‹çš„ DNS æœåŠ¡å™¨æ˜¯ä¸åŒçš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é˜…è¯»å¦‚ä¸‹å¯¹è¯ï¼Œå¹¶è¯´æ˜ä¸œç§€çš„æ–¹æ¡ˆæ˜¯å¦å¯è¡Œã€‚ï¼ˆå› ä¸ºå¯¹è¯çš„å­—å¤ªå¤šï¼Œç”¨å›¾ä»£æ›¿ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c41a22f35390.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šç­”æ¡ˆå°±æ˜¯å¯è¡Œï¼ŒDNS æœåŠ¡å™¨æ˜¯åˆ†å¸ƒå¼çš„ï¼Œä¸€å°åäº†å¯ä»¥æ‰¾å…¶ä»–çš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å†æµè§ˆå™¨åœ°å€è¾“å…¥ &lt;a href=&#34;https://www.orentec.co.kr&#34;&gt;www.orentec.co.kr&lt;/a&gt; ï¼Œå¹¶æ•´ç†å‡ºä¸»é¡µæ˜¾ç¤ºè¿‡ç¨‹ã€‚å‡è®¾æµè§ˆå™¨è®¿é—®é»˜è®¤ DNS æœåŠ¡å™¨ä¸­å¹¶æ²¡æœ‰å…³äº &lt;a href=&#34;https://www.orentec.co.kr&#34;&gt;www.orentec.co.kr&lt;/a&gt; çš„åœ°å€ä¿¡æ¯.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šå¯ä»¥å‚è€ƒä¸€ä¸‹çŸ¥ä¹å›ç­”ï¼Œ&lt;a href=&#34;https://www.zhihu.com/question/34873227/answer/518086565&#34;&gt;åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ä¸€ä¸ªURLåå›è½¦ï¼ŒèƒŒåä¼šè¿›è¡Œå“ªäº›æŠ€æœ¯æ­¥éª¤ï¼Ÿ&lt;/a&gt;,æˆ‘ç”¨æˆ‘è‡ªå·±çš„ç†è§£ï¼Œç®€å•è¯´ä¸€ä¸‹ï¼Œé¦–å…ˆä¼šå»å‘ä¸Šä¸€çº§çš„ DNS æœåŠ¡å™¨å»æŸ¥è¯¢ï¼Œé€šè¿‡è¿™ç§æ–¹å¼é€çº§å‘ä¸Šä¼ é€’ä¿¡æ¯ï¼Œä¸€ç›´åˆ°è¾¾æ ¹æœåŠ¡å™¨æ—¶ï¼Œå®ƒçŸ¥é“åº”è¯¥å‘å“ªä¸ª DNS æœåŠ¡å™¨å‘èµ·è¯¢é—®ã€‚å‘ä¸‹ä¼ é€’è§£æè¯·æ±‚ï¼Œå¾—åˆ°IPåœ°å€å€™åŸè·¯è¿”å›ï¼Œæœ€åä¼šå°†è§£æçš„IPåœ°å€ä¼ é€’åˆ°å‘èµ·è¯·æ±‚çš„ä¸»æœºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-8-%E7%AB%A0-%E5%9F%9F%E5%90%8D%E5%8F%8A%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 7 ç«  ä¼˜é›…çš„æ–­å¼€å¥—æ¥å­—çš„è¿æ¥ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-7-%E7%AB%A0-%E4%BC%98%E9%9B%85%E7%9A%84%E6%96%AD%E5%BC%80%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E8%BF%9E%E6%8E%A5-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Sat, 26 Mar 2022 11:25:41 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-7-%E7%AB%A0-%E4%BC%98%E9%9B%85%E7%9A%84%E6%96%AD%E5%BC%80%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E8%BF%9E%E6%8E%A5-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-7-%E7%AB%A0-%E4%BC%98%E9%9B%85%E7%9A%84%E6%96%AD%E5%BC%80%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E8%BF%9E%E6%8E%A5-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-7-ç« -ä¼˜é›…çš„æ–­å¼€å¥—æ¥å­—çš„è¿æ¥&#34;&gt;ç¬¬ 7 ç«  ä¼˜é›…çš„æ–­å¼€å¥—æ¥å­—çš„è¿æ¥&lt;/h2&gt;
&lt;p&gt;æœ¬ç« è®¨è®ºå¦‚ä½•ä¼˜é›…çš„æ–­å¼€å¥—æ¥å­—çš„è¿æ¥ï¼Œä¹‹å‰ç”¨çš„æ–¹æ³•ä¸å¤Ÿä¼˜é›…æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬æ˜¯è°ƒç”¨ close å‡½æ•°æˆ– closesocket å‡½æ•°å•æ–¹é¢æ–­å¼€è¿æ¥çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;71-åŸºäº-tcp-çš„åŠå…³é—­&#34;&gt;7.1 åŸºäº TCP çš„åŠå…³é—­&lt;/h3&gt;
&lt;p&gt;TCP çš„æ–­å¼€è¿æ¥è¿‡ç¨‹æ¯”å»ºç«‹è¿æ¥æ›´é‡è¦ï¼Œå› ä¸ºè¿æ¥è¿‡ç¨‹ä¸­ä¸€èˆ¬ä¸ä¼šå‡ºç°å¤§é—®é¢˜ï¼Œä½†æ˜¯æ–­å¼€è¿‡ç¨‹å¯èƒ½å‘ç”Ÿé¢„æƒ³ä¸åˆ°çš„æƒ…å†µã€‚å› æ­¤åº”è¯¥å‡†ç¡®æŒæ§ã€‚æ‰€ä»¥è¦&lt;strong&gt;æŒæ¡åŠå…³é—­ï¼ˆHalf-closeï¼‰&lt;/strong&gt;ï¼Œæ‰èƒ½æ˜ç¡®æ–­å¼€è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h4 id=&#34;711-å•æ–¹é¢æ–­å¼€è¿æ¥å¸¦æ¥çš„é—®é¢˜&#34;&gt;7.1.1 å•æ–¹é¢æ–­å¼€è¿æ¥å¸¦æ¥çš„é—®é¢˜&lt;/h4&gt;
&lt;p&gt;Linux å’Œ Windows çš„ closesocket å‡½æ•°æ„å‘³ç€å®Œå…¨æ–­å¼€è¿æ¥ã€‚å®Œå…¨æ–­å¼€ä¸ä»…æŒ‡æ— æ³•ä¼ è¾“æ•°æ®ï¼Œè€Œä¸”ä¹Ÿä¸èƒ½æ¥æ”¶æ•°æ®ã€‚å› æ­¤åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé€šä¿¡ä¸€æ–¹å•æ–¹é¢çš„æ–­å¼€å¥—æ¥å­—è¿æ¥ï¼Œæ˜¾å¾—ä¸å¤ªä¼˜é›…ã€‚å¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c412a8baa2d8.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å›¾ä¸­æè¿°çš„æ˜¯ 2 å°ä¸»æœºæ­£åœ¨è¿›è¡ŒåŒå‘é€šä¿¡ï¼Œä¸»æœº A å‘é€å®Œæœ€åçš„æ•°æ®åï¼Œè°ƒç”¨ close å‡½æ•°æ–­å¼€äº†æœ€åçš„è¿æ¥ï¼Œä¹‹åä¸»æœº A æ— æ³•å†æ¥å—ä¸»æœº B ä¼ è¾“çš„æ•°æ®ã€‚å®é™…ä¸Šï¼Œæ˜¯å®Œå…¨æ— æ³•è°ƒç”¨ä¸æ¥å—æ•°æ®ç›¸å…³çš„å‡½æ•°ã€‚æœ€ç»ˆï¼Œç”±ä¸»æœº B ä¼ è¾“çš„ã€ä¸»æœº A å¿…é¡»è¦æ¥å—çš„æ•°æ®ä¹Ÿé”€æ¯äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ç±»é—®é¢˜ï¼Œã€Œåªå…³é—­ä¸€éƒ¨åˆ†æ•°æ®äº¤æ¢ä¸­ä½¿ç”¨çš„æµã€çš„æ–¹æ³•åº”è¿è€Œç”Ÿã€‚æ–­å¼€ä¸€éƒ¨åˆ†è¿æ¥æ˜¯æŒ‡ï¼Œå¯ä»¥ä¼ è¾“æ•°æ®ä½†æ˜¯æ— æ³•æ¥æ”¶ï¼Œæˆ–å¯ä»¥æ¥å—æ•°æ®ä½†æ— æ³•ä¼ è¾“ã€‚é¡¾åæ€ä¹‰å°±æ˜¯åªå…³é—­æµçš„ä¸€åŠã€‚&lt;/p&gt;
&lt;h4 id=&#34;712-å¥—æ¥å­—å’Œæµstream&#34;&gt;7.1.2 å¥—æ¥å­—å’Œæµï¼ˆStreamï¼‰&lt;/h4&gt;
&lt;p&gt;ä¸¤å°ä¸»æœºé€šè¿‡å¥—æ¥å­—å»ºç«‹è¿æ¥åè¿›å…¥å¯äº¤æ¢æ•°æ®çš„çŠ¶æ€ï¼Œåˆç§°ã€Œæµå½¢æˆçš„çŠ¶æ€ã€ã€‚ä¹Ÿå°±æ˜¯æŠŠå»ºç«‹å¥—æ¥å­—åå¯äº¤æ¢æ•°æ®çš„çŠ¶æ€çœ‹ä½œä¸€ç§æµã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤„çš„æµå¯ä»¥æ¯”ä½œæ°´æµã€‚æ°´æœç€ä¸€ä¸ªæ–¹å‘æµåŠ¨ï¼ŒåŒæ ·ï¼Œåœ¨å¥—æ¥å­—çš„æµä¸­ï¼Œæ•°æ®ä¹Ÿæ­¢å‘•èƒ½å‘ä¸€ä¸ªæ–¹å‘æµåŠ¨ã€‚å› æ­¤ï¼Œä¸ºäº†è¿›è¡ŒåŒå‘é€šä¿¡ï¼Œéœ€è¦å¦‚å›¾æ‰€ç¤ºçš„ä¸¤ä¸ªæµï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c412c3ba25dd.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦ä¸¤å°ä¸»æœºä¹‹é—´å»ºç«‹äº†å¥—æ¥å­—è¿æ¥ï¼Œæ¯ä¸ªä¸»æœºå°±ä¼šæ‹¥æœ‰å•ç‹¬çš„è¾“å…¥æµå’Œè¾“å‡ºæµã€‚å½“ç„¶ï¼Œå…¶ä¸­ä¸€ä¸ªä¸»æœºçš„è¾“å…¥æµä¸å¦ä¸€ä¸ªä¸»æœºçš„è¾“å‡ºæµç›¸è¿ï¼Œè€Œè¾“å‡ºæµåˆ™ä¸å¦ä¸€ä¸ªä¸»æœºçš„è¾“å…¥æµç›¸è¿ã€‚å¦å¤–ï¼Œæœ¬ç« è®¨è®ºçš„ã€Œä¼˜é›…çš„æ–­å¼€è¿æ¥æ–¹å¼ã€åªæ–­å¼€å…¶ä¸­ 1 ä¸ªæµï¼Œè€ŒéåŒæ—¶æ–­å¼€ä¸¤ä¸ªæµã€‚Linux å’Œ Windows çš„ closesocket å‡½æ•°å°†åŒæ—¶æ–­å¼€è¿™ä¸¤ä¸ªæµï¼Œå› æ­¤ä¸ã€Œä¼˜é›…ã€äºŒå­—è¿˜æœ‰ä¸€æ®µè·ç¦»ã€‚&lt;/p&gt;
&lt;h4 id=&#34;713-é’ˆå¯¹ä¼˜é›…æ–­å¼€çš„-shutdown-å‡½æ•°&#34;&gt;7.1.3 é’ˆå¯¹ä¼˜é›…æ–­å¼€çš„ shutdown å‡½æ•°&lt;/h4&gt;
&lt;p&gt;shutdown ç”¨æ¥å…³é—­å…¶ä¸­ä¸€ä¸ªæµï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;shutdown&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sock, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; howto);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;sock: éœ€è¦æ–­å¼€å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;howto: ä¼ é€’æ–­å¼€æ–¹å¼ä¿¡æ¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è°ƒç”¨ä¸Šè¿°å‡½æ•°æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°å†³å®šæ–­å¼€è¿æ¥çš„æ–¹å¼ï¼Œå…¶å€¼å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SHUT_RD&lt;/code&gt; : æ–­å¼€è¾“å…¥æµ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SHUT_WR&lt;/code&gt; : æ–­å¼€è¾“å‡ºæµ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SHUT_RDWR&lt;/code&gt; : åŒæ—¶æ–­å¼€ I/O æµ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è‹¥å‘ shutdown çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’&lt;code&gt;SHUT_RD&lt;/code&gt;ï¼Œåˆ™æ–­å¼€è¾“å…¥æµï¼Œå¥—æ¥å­—æ— æ³•æ¥æ”¶æ•°æ®ã€‚å³ä½¿è¾“å…¥ç¼“å†²æ”¶åˆ°æ•°æ®ä¹Ÿå›æŠ¹å»ï¼Œè€Œä¸”æ— æ³•è°ƒç”¨ç›¸å…³å‡½æ•°ã€‚å¦‚æœå‘  shutdown çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’&lt;code&gt;SHUT_WR&lt;/code&gt;ï¼Œåˆ™ä¸­æ–­è¾“å‡ºæµï¼Œä¹Ÿå°±æ— æ³•ä¼ è¾“æ•°æ®ã€‚è‹¥å¦‚æœè¾“å‡ºç¼“å†²ä¸­è¿˜æœ‰æœªä¼ è¾“çš„æ•°æ®ï¼Œåˆ™å°†ä¼ é€’ç»™ç›®æ ‡ä¸»æœºã€‚æœ€åï¼Œè‹¥ä¼ é€’å…³é”®å­—&lt;code&gt;SHUT_RDWR&lt;/code&gt;ï¼Œåˆ™åŒæ—¶ä¸­æ–­ I/O æµã€‚è¿™ç›¸å½“äºåˆ† 2 æ¬¡è°ƒç”¨ shutdown ï¼Œå…¶ä¸­ä¸€æ¬¡ä»¥&lt;code&gt;SHUT_RD&lt;/code&gt;ä¸ºå‚æ•°ï¼Œå¦ä¸€æ¬¡ä»¥&lt;code&gt;SHUT_WR&lt;/code&gt;ä¸ºå‚æ•°ã€‚&lt;/p&gt;
&lt;h4 id=&#34;714-ä¸ºä½•è¦åŠå…³é—­&#34;&gt;7.1.4 ä¸ºä½•è¦åŠå…³é—­&lt;/h4&gt;
&lt;p&gt;è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€æ—¦å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†çº¦å®šçš„æ–‡ä»¶ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°åå‘é€å­—ç¬¦ä¸²ã€ŒThank youã€ç»™æœåŠ¡å™¨ç«¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ­¤å¤„ã€ŒThank youã€çš„ä¼ é€’æ˜¯å¤šä½™çš„ï¼Œè¿™åªæ˜¯ç”¨æ¥æ¨¡æ‹Ÿå®¢æˆ·ç«¯æ–­å¼€è¿æ¥å‰è¿˜æœ‰æ•°æ®è¦ä¼ è¾“çš„æƒ…å†µã€‚æ­¤æ—¶ç¨‹åºçš„è¿˜å«Œéš¾åº¦å¹¶ä¸å°ï¼Œå› ä¸ºä¼ è¾“æ–‡ä»¶çš„æœåŠ¡å™¨ç«¯åªéœ€è¿ç»­ä¼ è¾“æ–‡ä»¶æ•°æ®å³å¯ï¼Œè€Œå®¢æˆ·ç«¯æ— æ³•çŸ¥é“éœ€è¦æ¥æ”¶æ•°æ®åˆ°ä½•æ—¶ã€‚å®¢æˆ·ç«¯ä¹Ÿæ²¡åŠæ³•æ— ä¼‘æ­¢çš„è°ƒç”¨è¾“å…¥å‡½æ•°ï¼Œå› ä¸ºè¿™æœ‰å¯èƒ½å¯¼è‡´ç¨‹åº&lt;strong&gt;é˜»å¡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ˜¯å¦å¯ä»¥è®©æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çº¦å®šä¸€ä¸ªä»£è¡¨æ–‡ä»¶å°¾çš„å­—ç¬¦ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ç§æ–¹å¼ä¹Ÿæœ‰é—®é¢˜ï¼Œå› ä¸ºè¿™æ„å‘³è¿™æ–‡ä»¶ä¸­ä¸èƒ½æœ‰ä¸çº¦å®šå­—ç¬¦ç›¸åŒçš„å†…å®¹ã€‚ä¸ºäº†è§£å†³è¯¥é—®é¢˜ï¼ŒæœåŠ¡ç«¯åº”æœ€åå‘å®¢æˆ·ç«¯ä¼ é€’ EOF è¡¨ç¤ºæ–‡ä»¶ä¼ è¾“ç»“æŸã€‚å®¢æˆ·ç«¯é€šè¿‡å‡½æ•°è¿”å›å€¼æ¥å— EOF ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸æ–‡ä»¶å†…å®¹å†²çªã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒæœåŠ¡ç«¯å¦‚ä½•ä¼ é€’ EOF ï¼Ÿ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ–­å¼€è¾“å‡ºæµæ—¶å‘ä¸»æœºä¼ è¾“ EOFã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å½“ç„¶ï¼Œè°ƒç”¨ close å‡½æ•°çš„åŒæ—¶å…³é—­ I/O æµï¼Œè¿™æ ·ä¹Ÿä¼šå‘å¯¹æ–¹å‘é€ EOF ã€‚ä½†æ­¤æ—¶æ— æ³•å†æ¥å—å¯¹æ–¹ä¼ è¾“çš„æ•°æ®ã€‚æ¢è¨€ä¹‹ï¼Œè‹¥è°ƒç”¨ close å‡½æ•°å…³é—­æµï¼Œå°±æ— æ³•æ¥å—å®¢æˆ·ç«¯æœ€åå‘é€çš„å­—ç¬¦ä¸²ã€ŒThank youã€ã€‚è¿™æ—¶éœ€è¦è°ƒç”¨ shutdown å‡½æ•°ï¼Œåªå…³é—­æœåŠ¡å™¨çš„è¾“å‡ºæµã€‚è¿™æ ·æ—¢å¯ä»¥å‘é€ EOF ï¼ŒåŒæ—¶åˆä¿ç•™äº†è¾“å…¥æµã€‚ä¸‹é¢å®ç°æ”¶å‘æ–‡ä»¶çš„æœåŠ¡å™¨ç«¯/å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;715-åŸºäºåŠå…³é—­çš„æ–‡ä»¶ä¼ è¾“ç¨‹åº&#34;&gt;7.1.5 åŸºäºåŠå…³é—­çš„æ–‡ä»¶ä¼ è¾“ç¨‹åº&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿°æ–‡ä»¶ä¼ è¾“æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„æ•°æ®æµå¯ä»¥æ•´ç†å¦‚å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c41326280ab5.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç ä¸ºç¼–ç¨‹ç®€ä¾¿ï¼Œçœç•¥äº†å¤§é‡é”™è¯¯å¤„ç†ä»£ç ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch07/file_client.c&#34;&gt;file_client.c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch07/file_server.c&#34;&gt;file_server.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc file_client.c -o fclient
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc file_server.c -o fserver
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./fserver &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./fclient 127.0.0.1 &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/18/5c4140bc8db2f.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å®¢æˆ·ç«¯æ¥å—å®Œæˆåï¼ŒæœåŠ¡å™¨ä¼šæ¥æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„æ„Ÿè°¢ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;72-åŸºäº-windows-çš„å®ç°&#34;&gt;7.2 åŸºäº Windows çš„å®ç°&lt;/h3&gt;
&lt;p&gt;æš‚ç•¥&lt;/p&gt;
&lt;h3 id=&#34;73-ä¹ é¢˜&#34;&gt;7.3 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è§£é‡Š TCP ä¸­ã€Œæµã€çš„æ¦‚å¿µã€‚UDP ä¸­èƒ½å¦å½¢æˆæµï¼Ÿè¯·è¯´æ˜åŸå› ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä¸¤å°ä¸»æœºä¸­é€šè¿‡å¥—æ¥å­—å»ºç«‹è¿æ¥åè¿›å…¥å¯äº¤æ¢æ•°æ®çš„çŠ¶æ€ï¼Œåˆç§°ã€Œæµå½¢æˆçš„çŠ¶æ€ã€ã€‚ä¹Ÿå°±æ˜¯æŠŠå»ºç«‹å¥—æ¥å­—åå¯äº¤æ¢æ•°æ®çš„çŠ¶æ€çœ‹åšä¸€ç§æµã€‚UDP æ²¡æœ‰å»ºç«‹è¿æ¥çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ä¸èƒ½å½¢æˆæµã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Linux ä¸­çš„ close å‡½æ•°æˆ– Windows ä¸­çš„ closesocket å‡½æ•°å±äºå•æ–¹é¢æ–­å¼€è¿æ¥çš„æ–¹æ³•ï¼Œæœ‰å¯èƒ½å¸¦æ¥ä¸€äº›é—®é¢˜ã€‚ä»€ä¹ˆæ˜¯å•æ–¹é¢æ–­å¼€è¿æ¥ï¼Ÿä»€ä¹ˆæƒ…å½¢ä¸‹ä¼šå‡ºç°é—®é¢˜ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šå•æ–¹é¢æ–­å¼€è¿æ¥å°±æ˜¯ä¸¤å°ä¸»æœºæ­£åœ¨é€šä¿¡ï¼Œå…¶ä¸­ä¸€å°ä¸»æœºå…³é—­äº†æ‰€æœ‰è¿æ¥ï¼Œé‚£ä¹ˆä¸€å°ä¸»æœºå‘å¦ä¸€å°ä¸»æœºä¼ è¾“çš„æ•°æ®å¯èƒ½ä¼šæ²¡æœ‰æ¥æ”¶åˆ°è€ŒæŸæ¯ã€‚ä¼ è¾“æ–‡ä»¶çš„æœåŠ¡å™¨åªéœ€è¿ç»­ä¼ è¾“æ–‡ä»¶æ•°æ®å³å¯ï¼Œè€Œå®¢æˆ·ç«¯ä¸çŸ¥é“éœ€è¦æ¥æ”¶æ•°æ®åˆ°ä½•æ—¶ã€‚å®¢æˆ·ç«¯ä¹Ÿæ²¡æœ‰åŠæ³•æ— ä¼‘æ­¢çš„è°ƒç”¨è¾“å…¥å‡½æ•°ã€‚ç°åœ¨éœ€è¦ä¸€ä¸ª EOF ä»£è¡¨æ•°æ®å·²ç»ä¼ è¾“å®Œæ¯•ï¼Œé‚£ä¹ˆè¿™æ—¶å°±éœ€è¦åŠå…³é—­ï¼ŒæœåŠ¡ç«¯æŠŠè‡ªå·±çš„è¾“å‡ºæµå…³äº†ï¼Œè¿™æ—¶å®¢æˆ·ç«¯å°±çŸ¥æ•°æ®å·²ç»ä¼ è¾“å®Œæ¯•ï¼Œå› ä¸ºæœåŠ¡ç«¯çš„è¾“å…¥æµè¿˜æ²¡å…³ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç»™æœåŠ¡å™¨æ±‡æŠ¥ï¼Œæ¥æ”¶å®Œæ¯•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»€ä¹ˆæ˜¯åŠå…³é—­ï¼Ÿé’ˆå¯¹è¾“å‡ºæµæ‰§è¡ŒåŠå…³é—­çš„ä¸»æœºå¤„äºä½•ç§çŠ¶æ€ï¼ŸåŠå…³é—­ä¼šå¯¼è‡´å¯¹æ–¹ä¸»æœºæ¥æ”¶ä»€ä¹ˆæ¶ˆæ¯ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šåŠå…³é—­å°±æ˜¯æŠŠè¾“å…¥æµæˆ–è€…è¾“å‡ºæµå…³äº†ã€‚é’ˆå¯¹è¾“å‡ºæµæ‰§è¡ŒåŠå…³é—­çš„ä¸»æœºå¤„äºå¯ä»¥æ¥æ”¶æ•°æ®è€Œä¸èƒ½å‘é€æ•°æ®ã€‚åŠå…³é—­ä¼šå¯¼è‡´å¯¹æ–¹ä¸»æœºæ¥æ”¶ä¸€ä¸ª EOF æ–‡ä»¶ç»“æŸç¬¦ã€‚å¯¹æ–¹å°±çŸ¥é“ä½ çš„æ•°æ®å·²ç»ä¼ è¾“å®Œæ¯•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-7-%E7%AB%A0-%E4%BC%98%E9%9B%85%E7%9A%84%E6%96%AD%E5%BC%80%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E8%BF%9E%E6%8E%A5-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 6 ç«  åŸºäº UDP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-6-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-udp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Fri, 25 Mar 2022 16:10:00 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-6-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-udp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-6-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-udp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-6-ç« -åŸºäº-udp-çš„æœåŠ¡ç«¯å®¢æˆ·ç«¯&#34;&gt;ç¬¬ 6 ç«  åŸºäº UDP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯&lt;/h2&gt;
&lt;p&gt;TCP æ˜¯å†…å®¹è¾ƒå¤šçš„ä¸€ä¸ªåè®®ï¼Œè€Œæœ¬ç« ä¸­çš„ UDP å†…å®¹è¾ƒå°‘ï¼Œä½†æ˜¯ä¹Ÿå¾ˆé‡è¦ã€‚&lt;/p&gt;
&lt;h3 id=&#34;61-ç†è§£-udp&#34;&gt;6.1 ç†è§£ UDP&lt;/h3&gt;
&lt;h4 id=&#34;611-udp-å¥—æ¥å­—çš„ç‰¹ç‚¹&#34;&gt;6.1.1 UDP å¥—æ¥å­—çš„ç‰¹ç‚¹&lt;/h4&gt;
&lt;p&gt;é€šè¿‡å¯„ä¿¡æ¥è¯´æ˜ UDP çš„å·¥ä½œåŸç†ï¼Œè¿™æ˜¯è®²è§£ UDP æ—¶ä½¿ç”¨çš„ä¼ ç»Ÿç¤ºä¾‹ï¼Œå®ƒä¸ UDP çš„ç‰¹ç‚¹å®Œå…¨ç›¸åŒã€‚å¯„ä¿¡å‰åº”ç°åœ¨ä¿¡å°ä¸Šå¡«å¥½å¯„ä¿¡äººå’Œæ”¶ä¿¡äººçš„åœ°å€ï¼Œä¹‹åè´´ä¸Šé‚®ç¥¨æ”¾è¿›é‚®ç­’å³å¯ã€‚å½“ç„¶ï¼Œä¿¡ä»¶çš„ç‰¹ç‚¹ä½¿æˆ‘ä»¬æ— æ³•ç¡®è®¤ä¿¡ä»¶æ˜¯å¦è¢«æ”¶åˆ°ã€‚é‚®å¯„è¿‡ç¨‹ä¸­ä¹Ÿå¯èƒ½å‘ç”Ÿä¿¡ä»¶ä¸¢å¤±çš„æƒ…å†µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¿¡ä»¶æ˜¯ä¸€ç§ä¸å¯é çš„ä¼ è¾“æ–¹å¼ï¼ŒUDP ä¹Ÿæ˜¯ä¸€ç§ä¸å¯é çš„æ•°æ®ä¼ è¾“æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º UDP æ²¡æœ‰ TCP é‚£ä¹ˆå¤æ‚ï¼Œæ‰€ä»¥ç¼–ç¨‹éš¾åº¦æ¯”è¾ƒå°ï¼Œæ€§èƒ½ä¹Ÿæ¯” TCP é«˜ã€‚åœ¨æ›´é‡è§†æ€§èƒ½çš„æƒ…å†µä¸‹å¯ä»¥é€‰æ‹© UDP çš„ä¼ è¾“æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;TCP ä¸ UDP çš„åŒºåˆ«å¾ˆå¤§ä¸€éƒ¨åˆ†æ¥æºäºæµæ§åˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ TCP çš„ç”Ÿå‘½åœ¨äºæµæ§åˆ¶ã€‚&lt;/p&gt;
&lt;h4 id=&#34;612-udp-çš„å·¥ä½œåŸç†&#34;&gt;6.1.2 UDP çš„å·¥ä½œåŸç†&lt;/h4&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/17/5c3fd29c70bf2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒIP çš„ä½œç”¨å°±æ˜¯è®©ç¦»å¼€ä¸»æœº B çš„ UDP æ•°æ®åŒ…å‡†ç¡®ä¼ é€’åˆ°ä¸»æœº A ã€‚ä½†æ˜¯æŠŠ UDP æ•°æ®åŒ…æœ€ç»ˆäº¤ç»™ä¸»æœº A çš„æŸä¸€ UDP å¥—æ¥å­—çš„è¿‡ç¨‹æ˜¯ç”± UDP å®Œæˆçš„ã€‚UDP çš„æœ€é‡è¦çš„ä½œç”¨å°±æ˜¯æ ¹æ®ç«¯å£å·å°†ä¼ åˆ°ä¸»æœºçš„æ•°æ®åŒ…äº¤ä»˜ç»™æœ€ç»ˆçš„ UDP å¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;h4 id=&#34;613-udp-çš„é«˜æ•ˆä½¿ç”¨&#34;&gt;6.1.3 UDP çš„é«˜æ•ˆä½¿ç”¨&lt;/h4&gt;
&lt;p&gt;UDP ä¹Ÿå…·æœ‰ä¸€å®šçš„å¯é æ€§ã€‚å¯¹äºé€šè¿‡ç½‘ç»œå®æ—¶ä¼ é€’çš„è§†é¢‘æˆ–è€…éŸ³é¢‘æ—¶æƒ…å†µæœ‰æ‰€ä¸åŒã€‚å¯¹äºå¤šåª’ä½“æ•°æ®è€Œè¨€ï¼Œä¸¢å¤±ä¸€éƒ¨åˆ†æ•°æ®ä¹Ÿæ²¡æœ‰å¤ªå¤§é—®é¢˜ï¼Œè¿™åªæ˜¯ä¼šæš‚æ—¶å¼•èµ·ç”»é¢æŠ–åŠ¨ï¼Œæˆ–è€…å‡ºç°ç»†å¾®çš„æ‚éŸ³ã€‚ä½†æ˜¯è¦æä¾›å®æ—¶æœåŠ¡ï¼Œé€Ÿåº¦å°±æˆä¸ºäº†ä¸€ä¸ªå¾ˆé‡è¦çš„å› ç´ ã€‚å› æ­¤æµæ§åˆ¶å°±æ˜¾å¾—æœ‰ä¸€ç‚¹å¤šä½™ï¼Œè¿™æ—¶å°±è¦è€ƒè™‘ä½¿ç”¨ UDP ã€‚TCP æ¯” UDP æ…¢çš„åŸå› ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¶å‘æ•°æ®å‰åè¿›è¡Œçš„è¿æ¥è®¾ç½®åŠæ¸…æ¥šè¿‡ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;æ”¶å‘è¿‡ç¨‹ä¸­ä¸ºä¿è¯å¯é æ€§è€Œæ·»åŠ çš„æµæ§åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæ”¶å‘çš„æ•°æ®é‡å°ä½†æ˜¯éœ€è¦é¢‘ç¹è¿æ¥æ—¶ï¼ŒUDP æ¯” TCP æ›´é«˜æ•ˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;62-å®ç°åŸºäº-udp-çš„æœåŠ¡ç«¯å®¢æˆ·ç«¯&#34;&gt;6.2 å®ç°åŸºäº UDP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯&lt;/h3&gt;
&lt;h4 id=&#34;621-udp-ä¸­çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ²¡æœ‰è¿æ¥&#34;&gt;6.2.1 UDP ä¸­çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ²¡æœ‰è¿æ¥&lt;/h4&gt;
&lt;p&gt;UDP ä¸­çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸åƒ TCP é‚£æ ·åœ¨è¿æ¥çŠ¶æ€ä¸‹äº¤æ¢æ•°æ®ï¼Œå› æ­¤ä¸ TCP ä¸åŒï¼Œæ— éœ€ç»è¿‡è¿æ¥è¿‡ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¿…è°ƒç”¨ TCP è¿æ¥è¿‡ç¨‹ä¸­è°ƒç”¨çš„ listen å’Œ accept å‡½æ•°ã€‚UDP ä¸­åªæœ‰åˆ›å»ºå¥—æ¥å­—å’Œæ•°æ®äº¤æ¢çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h4 id=&#34;622-udp-æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å‡åªéœ€ä¸€ä¸ªå¥—æ¥å­—&#34;&gt;6.2.2 UDP æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å‡åªéœ€ä¸€ä¸ªå¥—æ¥å­—&lt;/h4&gt;
&lt;p&gt;TCP ä¸­ï¼Œå¥—æ¥å­—ä¹‹é—´åº”è¯¥æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚è‹¥è¦å‘ 10 ä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡ï¼Œé™¤äº†å®ˆé—¨çš„æœåŠ¡å™¨å¥—æ¥å­—ä¹‹å¤–ï¼Œè¿˜éœ€è¦ 10 ä¸ªæœåŠ¡å™¨å¥—æ¥å­—ã€‚ä½†åœ¨ UDP ä¸­ï¼Œä¸ç®¡äº‹æœåŠ¡å™¨ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯éƒ½åªéœ€è¦ 1 ä¸ªå¥—æ¥å­—ã€‚åªéœ€è¦ä¸€ä¸ª UDP å¥—æ¥å­—å°±å¯ä»¥å‘ä»»æ„ä¸»æœºä¼ è¾“æ•°æ®ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/17/5c3fd703f3c40.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å›¾ä¸­å±•ç¤ºäº† 1 ä¸ª UDP å¥—æ¥å­—ä¸ 2 ä¸ªä¸åŒä¸»æœºäº¤æ¢æ•°æ®çš„è¿‡ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªéœ€ 1 ä¸ª UDP å¥—æ¥å­—å°±èƒ½å’Œå¤šå°ä¸»æœºè¿›è¡Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;h4 id=&#34;623-åŸºäº-udp-çš„æ•°æ®-io-å‡½æ•°&#34;&gt;6.2.3 åŸºäº UDP çš„æ•°æ® I/O å‡½æ•°&lt;/h4&gt;
&lt;p&gt;åˆ›å»ºå¥½ TCP å¥—æ¥å­—ä»¥åï¼Œä¼ è¾“æ•°æ®æ—¶æ— éœ€åŠ ä¸Šåœ°å€ä¿¡æ¯ã€‚å› ä¸º TCP å¥—æ¥å­—å°†ä¿æŒä¸å¯¹æ–¹å¥—æ¥å­—çš„è¿æ¥ã€‚æ¢è¨€ä¹‹ï¼ŒTCP å¥—æ¥å­—çŸ¥é“ç›®æ ‡åœ°å€ä¿¡æ¯ã€‚ä½† UDP å¥—æ¥å­—ä¸ä¼šä¿æŒè¿æ¥çŠ¶æ€ï¼ˆUDP å¥—æ¥å­—åªæœ‰ç®€å•çš„é‚®ç­’åŠŸèƒ½ï¼‰ï¼Œå› æ­¤æ¯æ¬¡ä¼ è¾“æ•°æ®æ—¶éƒ½éœ€è¦æ·»åŠ ç›®æ ‡çš„åœ°å€ä¿¡æ¯ã€‚è¿™ç›¸å½“äºå¯„ä¿¡å‰åœ¨ä¿¡ä»¶ä¸­å¡«å†™åœ°å€ã€‚æ¥ä¸‹æ¥æ˜¯ UDP çš„ç›¸å…³å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;ssize_t &lt;span style=&#34;color:#008b45&#34;&gt;sendto&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sock, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; *buff, size_t nbytes, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; flags,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sockaddr *to, socklen_t addrlen);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å›ä¼ è¾“çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ˜¯è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;sock: ç”¨äºä¼ è¾“æ•°æ®çš„ UDP å¥—æ¥å­—
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;buff: ä¿å­˜å¾…ä¼ è¾“æ•°æ®çš„ç¼“å†²åœ°å€å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;nbytes: å¾…ä¼ è¾“çš„æ•°æ®é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;flags: å¯é€‰é¡¹å‚æ•°ï¼Œè‹¥æ²¡æœ‰åˆ™ä¼ é€’ 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;to: å­˜æœ‰ç›®æ ‡åœ°å€çš„ sockaddr ç»“æ„ä½“å˜é‡çš„åœ°å€å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;addrlen: ä¼ é€’ç»™å‚æ•° to çš„åœ°å€å€¼ç»“æ„ä½“å˜é‡é•¿åº¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸Šè¿°å‡½æ•°ä¸ä¹‹å‰çš„ TCP è¾“å‡ºå‡½æ•°æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œæ­¤å‡½æ•°éœ€è¦å‘å®ƒä¼ é€’ç›®æ ‡åœ°å€ä¿¡æ¯ã€‚æ¥ä¸‹æ¥ä»‹ç»æ¥æ”¶ UDP æ•°æ®çš„å‡½æ•°ã€‚UDP æ•°æ®çš„å‘é€å¹¶ä¸å›ºå®šï¼Œå› æ­¤è¯¥å‡½æ•°å®šä¹‰ä¸ºå¯æ¥å—å‘é€ç«¯ä¿¡æ¯çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯å°†åŒæ—¶è¿”å› UDP æ•°æ®åŒ…ä¸­çš„å‘é€ç«¯ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;ssize_t &lt;span style=&#34;color:#008b45&#34;&gt;recvfrom&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sock, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;void&lt;/span&gt; *buff, size_t nbytes, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; flags,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sockaddr *from, socklen_t *addrlen);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å›ä¼ è¾“çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ˜¯è¿”å› -1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;sock: ç”¨äºä¼ è¾“æ•°æ®çš„ UDP å¥—æ¥å­—
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;buff: ä¿å­˜å¾…ä¼ è¾“æ•°æ®çš„ç¼“å†²åœ°å€å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;nbytes: å¾…ä¼ è¾“çš„æ•°æ®é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;flags: å¯é€‰é¡¹å‚æ•°ï¼Œè‹¥æ²¡æœ‰åˆ™ä¼ é€’ 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;from: å­˜æœ‰å‘é€ç«¯åœ°å€ä¿¡æ¯çš„ sockaddr ç»“æ„ä½“å˜é‡çš„åœ°å€å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;addrlen: ä¿å­˜å‚æ•° from çš„ç»“æ„ä½“å˜é‡é•¿åº¦çš„å˜é‡åœ°å€å€¼ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¼–å†™ UDP ç¨‹åºçš„æœ€æ ¸å¿ƒçš„éƒ¨åˆ†å°±åœ¨äºä¸Šè¿°ä¸¤ä¸ªå‡½æ•°ï¼Œè¿™ä¹Ÿè¯´æ˜äºŒè€…åœ¨ UDP æ•°æ®ä¼ è¾“ä¸­çš„åœ°ä½ã€‚&lt;/p&gt;
&lt;h4 id=&#34;624-åŸºäº-udp-çš„å›å£°æœåŠ¡å™¨ç«¯å®¢æˆ·ç«¯&#34;&gt;6.2.4 åŸºäº UDP çš„å›å£°æœåŠ¡å™¨ç«¯/å®¢æˆ·ç«¯&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢æ˜¯å®ç°çš„åŸºäº UDP çš„å›å£°æœåŠ¡å™¨çš„æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ï¼š&lt;/p&gt;
&lt;p&gt;ä»£ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch06/uecho_client.c&#34;&gt;uecho_client.c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch06/uecho_server.c&#34;&gt;uecho_server.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc uecho_client.c -o uclient
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc uecho_server.c -o userver
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./server &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./uclient 127.0.0.1 &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/17/5c3feb85baa83.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;TCP å®¢æˆ·ç«¯å¥—æ¥å­—åœ¨è°ƒç”¨ connect å‡½æ•°æ—¶è‡ªåŠ¨åˆ†é…IPåœ°å€å’Œç«¯å£å·ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼ŒUDP å®¢æˆ·ç«¯ä½•æ—¶åˆ†é…IPåœ°å€å’Œç«¯å£å·ï¼Ÿ&lt;/p&gt;
&lt;h4 id=&#34;625-udp-å®¢æˆ·ç«¯å¥—æ¥å­—çš„åœ°å€åˆ†é…&#34;&gt;6.2.5 UDP å®¢æˆ·ç«¯å¥—æ¥å­—çš„åœ°å€åˆ†é…&lt;/h4&gt;
&lt;p&gt;ä»”ç»†è§‚å¯Ÿ UDP å®¢æˆ·ç«¯å¯ä»¥å‘ç°ï¼ŒUDP å®¢æˆ·ç«¯ç¼ºå°‘äº†æŠŠIPå’Œç«¯å£åˆ†é…ç»™å¥—æ¥å­—çš„è¿‡ç¨‹ã€‚TCP å®¢æˆ·ç«¯è°ƒç”¨ connect å‡½æ•°è‡ªåŠ¨å®Œæˆæ­¤è¿‡ç¨‹ï¼Œè€Œ UDP ä¸­è¿æ¥èƒ½æ‰¿æ‹…ç›¸åŒåŠŸèƒ½çš„å‡½æ•°è°ƒç”¨è¯­å¥éƒ½æ²¡æœ‰ã€‚ç©¶ç«Ÿåœ¨ä»€ä¹ˆæ—¶å€™åˆ†é…IPå’Œç«¯å£å·å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;UDP ç¨‹åºä¸­ï¼Œè°ƒç”¨ sendto å‡½æ•°ä¼ è¾“æ•°æ®å‰åº”è¯¥å®Œæˆå¯¹å¥—æ¥å­—çš„åœ°å€åˆ†é…å·¥ä½œï¼Œå› æ­¤è°ƒç”¨ bind å‡½æ•°ã€‚å½“ç„¶ï¼Œbind å‡½æ•°åœ¨ TCP ç¨‹åºä¸­å‡ºç°è¿‡ï¼Œä½† bind å‡½æ•°ä¸åŒºåˆ† TCP å’Œ UDPï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ UDP ç¨‹åºä¸­åŒæ ·å¯ä»¥è°ƒç”¨ã€‚å¦å¤–ï¼Œå¦‚æœè°ƒç”¨ sendto å‡½æ•°å°šæœªåˆ†é…åœ°å€ä¿¡æ¯ï¼Œåˆ™åœ¨é¦–æ¬¡è°ƒç”¨ sendto å‡½æ•°æ—¶ç»™ç›¸åº”å¥—æ¥å­—è‡ªåŠ¨åˆ†é… IP å’Œç«¯å£ã€‚è€Œä¸”æ­¤æ—¶åˆ†é…çš„åœ°å€ä¸€ç›´ä¿ç•™åˆ°ç¨‹åºç»“æŸä¸ºæ­¢ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç”¨æ¥å’Œå…¶ä»– UDP å¥—æ¥å­—è¿›è¡Œæ•°æ®äº¤æ¢ã€‚å½“ç„¶ï¼ŒIP ç”¨ä¸»æœºIPï¼Œç«¯å£å·ç”¨æœªé€‰ç”¨çš„ä»»æ„ç«¯å£å·ã€‚&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œè°ƒç”¨ sendto å‡½æ•°æ—¶è‡ªåŠ¨åˆ†é…IPå’Œç«¯å£å·ï¼Œå› æ­¤ï¼ŒUDP å®¢æˆ·ç«¯ä¸­é€šå¸¸æ— éœ€é¢å¤–çš„åœ°å€åˆ†é…è¿‡ç¨‹ã€‚æ‰€ä»¥ä¹‹å‰çš„ç¤ºä¾‹ä¸­çœç•¥äº†è¯¥è¿‡ç¨‹ã€‚è¿™ä¹Ÿæ˜¯æ™®éçš„å®ç°æ–¹å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;63-udp-çš„æ•°æ®ä¼ è¾“ç‰¹æ€§å’Œè°ƒç”¨-connect-å‡½æ•°&#34;&gt;6.3 UDP çš„æ•°æ®ä¼ è¾“ç‰¹æ€§å’Œè°ƒç”¨ connect å‡½æ•°&lt;/h3&gt;
&lt;h4 id=&#34;631-å­˜åœ¨æ•°æ®è¾¹ç•Œçš„-udp-å¥—æ¥å­—&#34;&gt;6.3.1 å­˜åœ¨æ•°æ®è¾¹ç•Œçš„ UDP å¥—æ¥å­—&lt;/h4&gt;
&lt;p&gt;å‰é¢è¯´å¾— TCP æ•°æ®ä¼ è¾“ä¸­ä¸å­˜åœ¨æ•°æ®è¾¹ç•Œï¼Œè¿™è¡¨ç¤ºã€Œæ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­è°ƒç”¨ I/O å‡½æ•°çš„æ¬¡æ•°ä¸å…·æœ‰ä»»ä½•æ„ä¹‰ã€&lt;/p&gt;
&lt;p&gt;ç›¸åï¼ŒUDP æ˜¯å…·æœ‰æ•°æ®è¾¹ç•Œçš„ä¸‹ä¸€ï¼Œä¼ è¾“ä¸­è°ƒç”¨ I/O å‡½æ•°çš„æ¬¡æ•°éå¸¸é‡è¦ã€‚å› æ­¤ï¼Œè¾“å…¥å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°å’Œè¾“å‡ºå‡½æ•°çš„è°ƒç”¨æ¬¡æ•°å®Œå…¨ä¸€è‡´ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯æ¥æ”¶å…¨éƒ¨å·²ç»å‘é€çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œè°ƒç”¨ 3 æ¬¡è¾“å‡ºå‡½æ•°å‘é€çš„æ•°æ®å¿…é¡»é€šè¿‡è°ƒç”¨ 3 æ¬¡è¾“å…¥å‡½æ•°æ‰èƒ½æ¥æ”¶å®Œã€‚é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¿›è¡ŒéªŒè¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch06/bound_host1.c&#34;&gt;bound_host1.c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch06/bound_host2.c&#34;&gt;bound_host2.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc bound_host1.c -o host1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc bound_host2.c -o host2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./host1 &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./host2 127.0.0.1 &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/17/5c3ff966a8d34.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;host1 æ˜¯æœåŠ¡ç«¯ï¼Œhost2 æ˜¯å®¢æˆ·ç«¯ï¼Œhost2 ä¸€æ¬¡æ€§æŠŠæ•°æ®å‘ç»™æœåŠ¡ç«¯åï¼Œç»“æŸç¨‹åºã€‚ä½†æ˜¯å› ä¸ºæœåŠ¡ç«¯æ¯éš”äº”ç§’æ‰æ¥æ”¶ä¸€æ¬¡ï¼Œæ‰€ä»¥æœåŠ¡ç«¯æ¯éš”äº”ç§’æ¥æ”¶ä¸€æ¬¡æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä»è¿è¡Œç»“æœä¹Ÿå¯ä»¥è¯æ˜ UDP é€šä¿¡è¿‡ç¨‹ä¸­ I/O çš„è°ƒç”¨æ¬¡æ•°å¿…é¡»ä¿æŒä¸€è‡´&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;632-å·²è¿æ¥connectudp-å¥—æ¥å­—ä¸æœªè¿æ¥unconnectedudp-å¥—æ¥å­—&#34;&gt;6.3.2 å·²è¿æ¥ï¼ˆconnectï¼‰UDP å¥—æ¥å­—ä¸æœªè¿æ¥ï¼ˆunconnectedï¼‰UDP å¥—æ¥å­—&lt;/h4&gt;
&lt;p&gt;TCP å¥—æ¥å­—ä¸­éœ€æ³¨å†Œå¾…ä¼ ä¼ è¾“æ•°æ®çš„ç›®æ ‡IPå’Œç«¯å£å·ï¼Œè€Œåœ¨ UDP ä¸­æ— éœ€æ³¨å†Œã€‚å› æ­¤é€šè¿‡ sendto å‡½æ•°ä¼ è¾“æ•°æ®çš„è¿‡ç¨‹å¤§æ¦‚å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ 3 ä¸ªé˜¶æ®µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ 1 é˜¶æ®µï¼šå‘ UDP å¥—æ¥å­—æ³¨å†Œç›®æ ‡ IP å’Œç«¯å£å·&lt;/li&gt;
&lt;li&gt;ç¬¬ 2 é˜¶æ®µï¼šä¼ è¾“æ•°æ®&lt;/li&gt;
&lt;li&gt;ç¬¬ 3 é˜¶æ®µï¼šåˆ é™¤ UDP å¥—æ¥å­—ä¸­æ³¨å†Œçš„ç›®æ ‡åœ°å€ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯æ¬¡è°ƒç”¨ sendto å‡½æ•°æ—¶é‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚æ¯æ¬¡éƒ½å˜æ›´ç›®æ ‡åœ°å€ï¼Œå› æ­¤å¯ä»¥é‡å¤åˆ©ç”¨åŒä¸€ UDP å¥—æ¥å­—å‘ä¸åŒç›®æ ‡ä¼ é€’æ•°æ®ã€‚è¿™ç§æœªæ³¨å†Œç›®æ ‡åœ°å€ä¿¡æ¯çš„å¥—æ¥å­—ç§°ä¸ºæœªè¿æ¥å¥—æ¥å­—ï¼Œåä¹‹ï¼Œæ³¨å†Œäº†ç›®æ ‡åœ°å€çš„å¥—æ¥å­—ç§°ä¸ºè¿æ¥ connected å¥—æ¥å­—ã€‚æ˜¾ç„¶ï¼ŒUDP å¥—æ¥å­—é»˜è®¤å±äºæœªè¿æ¥å¥—æ¥å­—ã€‚å½“ä¸€å°ä¸»æœºå‘å¦ä¸€å°ä¸»æœºä¼ è¾“å¾ˆå¤šä¿¡æ¯æ—¶ï¼Œä¸Šè¿°çš„ä¸‰ä¸ªé˜¶æ®µä¸­ï¼Œç¬¬ä¸€ä¸ªé˜¶æ®µå’Œç¬¬ä¸‰ä¸ªé˜¶æ®µå æ•´ä¸ªé€šä¿¡è¿‡ç¨‹ä¸­è¿‘ä¸‰åˆ†ä¹‹ä¸€çš„æ—¶é—´ï¼Œç¼©çŸ­è¿™éƒ¨åˆ†çš„æ—¶é—´å°†ä¼šå¤§å¤§æé«˜æ•´ä½“æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h4 id=&#34;633-åˆ›å»ºå·²è¿æ¥-udp-å¥—æ¥å­—&#34;&gt;6.3.3 åˆ›å»ºå·²è¿æ¥ UDP å¥—æ¥å­—&lt;/h4&gt;
&lt;p&gt;åˆ›å»ºå·²è¿æ¥ UDP å¥—æ¥å­—è¿‡ç¨‹æ ¼å¤–ç®€å•ï¼Œåªéœ€é’ˆå¯¹ UDP å¥—æ¥å­—è°ƒç”¨ connect å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sock = socket(PF_INET, SOCK_DGRAM, &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;memset(&amp;amp;adr, &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(adr));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;adr.sin_family = AF_INET;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;adr.sin_addr.s_addr = inet_addr(argv[&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;adr.sin_port = htons(atoi(argv[&lt;span style=&#34;color:#b452cd&#34;&gt;2&lt;/span&gt;]));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;connect(sock, (&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sockaddr *)&amp;amp;adr, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(adr));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸Šè¿°ä»£ç çœ‹ä¼¼ä¸ TCP å¥—æ¥å­—åˆ›å»ºè¿‡ç¨‹ä¸€è‡´ï¼Œä½† socket å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°åˆ†æ˜æ˜¯ SOCK_DGRAM ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ›å»ºçš„çš„ç¡®æ˜¯ UDP å¥—æ¥å­—ã€‚å½“ç„¶é’ˆå¯¹ UDP è°ƒç”¨ connect å‡½æ•°å¹¶ä¸æ˜¯æ„å‘³ç€è¦ä¸å¯¹æ–¹ UDP å¥—æ¥å­—è¿æ¥ï¼Œè¿™åªæ˜¯å‘ UDP å¥—æ¥å­—æ³¨å†Œç›®æ ‡IPå’Œç«¯å£ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åå°±ä¸ TCP å¥—æ¥å­—ä¸€è‡´ï¼Œæ¯æ¬¡è°ƒç”¨ sendto å‡½æ•°æ—¶åªéœ€ä¼ é€’ä¿¡æ¯æ•°æ®ã€‚å› ä¸ºå·²ç»æŒ‡å®šäº†æ”¶å‘å¯¹è±¡ï¼Œæ‰€ä»¥ä¸ä»…å¯ä»¥ä½¿ç”¨ sendtoã€recvfrom å‡½æ•°ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ writeã€read å‡½æ•°è¿›è¡Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ä¾‹å­æŠŠä¹‹å‰çš„ &lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/master/ch06/uecho_client.c&#34;&gt;uecho_client.c&lt;/a&gt; ç¨‹åºæ”¹æˆäº†åŸºäºå·²è¿æ¥ UDP çš„å¥—æ¥å­—çš„ç¨‹åºï¼Œå› æ­¤å¯ä»¥ç»“åˆ &lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch06/uecho_server.c&#34;&gt;uecho_server.c&lt;/a&gt; ç¨‹åºè¿è¡Œã€‚ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch06/uecho_con_client.c&#34;&gt;uecho_con_client.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘è¿è¡Œè¿‡ç¨‹ä¸ä¸Šé¢ä¸€æ ·ï¼Œæ•…çœç•¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„ä»£ç ä¸­ç”¨ writeã€read å‡½æ•°ä»£æ›¿äº† sendtoã€recvfrom å‡½æ•°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;64-åŸºäº-windows-çš„å®ç°&#34;&gt;6.4 åŸºäº Windows çš„å®ç°&lt;/h3&gt;
&lt;p&gt;æš‚ç•¥&lt;/p&gt;
&lt;h3 id=&#34;65-ä¹ é¢˜&#34;&gt;6.5 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UDP ä¸ºä»€ä¹ˆæ¯” TCP å¿«ï¼Ÿä¸ºä»€ä¹ˆ TCP ä¼ è¾“å¯é è€Œ TCP ä¼ è¾“ä¸å¯é ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šä¸ºäº†æä¾›å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ŒTCP åœ¨ä¸å¯é çš„IPå±‚è¿›è¡Œæµæ§åˆ¶ï¼Œè€Œ UDP ç¼ºå°‘è¿™ç§æµæ§åˆ¶ã€‚æ‰€ä»¥ UDP æ˜¯ä¸å¯é çš„è¿æ¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸‹é¢ä¸å±äº UDP ç‰¹ç‚¹çš„æ˜¯ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢åŠ ç²—çš„ä»£è¡¨æ­¤å¥è¯æ­£ç¡®&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;UDP ä¸åŒäº TCP ï¼Œä¸å­˜åœ¨è¿æ¥æ¦‚å¿µï¼Œæ‰€ä»¥ä¸åƒ TCP é‚£æ ·åªèƒ½è¿›è¡Œä¸€å¯¹ä¸€çš„æ•°æ®ä¼ è¾“ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨ UDP ä¼ è¾“æ•°æ®æ—¶ï¼Œå¦‚æœæœ‰ 2 ä¸ªç›®æ ‡ï¼Œåˆ™éœ€è¦ 2 ä¸ªå¥—æ¥å­—ã€‚&lt;/li&gt;
&lt;li&gt;UDP å¥—æ¥å­—ä¸­æ— æ³•ä½¿ç”¨å·²åˆ†é…ç»™ TCP çš„åŒä¸€ç«¯å£å·&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;UDP å¥—æ¥å­—å’Œ TCP å¥—æ¥å­—å¯ä»¥å…±å­˜ã€‚è‹¥éœ€è¦ï¼Œå¯ä»¥åŒæ—¶åœ¨åŒä¸€ä¸»æœºè¿›è¡Œ TCP å’Œ UDP æ•°æ®ä¼ è¾“ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;é’ˆå¯¹ UDP å‡½æ•°ä¹Ÿå¯ä»¥è°ƒç”¨ connect å‡½æ•°ï¼Œæ­¤æ—¶ UDP å¥—æ¥å­—è·Ÿ TCP å¥—æ¥å­—ç›¸åŒï¼Œä¹Ÿéœ€è¦ç»è¿‡ 3 æ¬¡æ¡æ‰‹é˜¶æ®µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UDP æ•°æ®æŠ¥å‘å¯¹æ–¹ä¸»æœºçš„ UDP å¥—æ¥å­—ä¼ é€’è¿‡ç¨‹ä¸­ï¼ŒIP å’Œ UDP åˆ†åˆ«è´Ÿè´£å“ªäº›éƒ¨åˆ†ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šIPçš„ä½œç”¨å°±æ˜¯è®©ç¦»å¼€ä¸»æœºçš„ UDP æ•°æ®åŒ…å‡†ç¡®ä¼ é€’åˆ°å¦ä¸€ä¸ªä¸»æœºã€‚ä½†æŠŠ UDP åŒ…æœ€ç»ˆäº¤ç»™ä¸»æœºçš„æŸä¸€ UDP å¥—æ¥å­—çš„è¿‡ç¨‹åˆ™æ˜¯ç”± UDP å®Œæˆçš„ã€‚UDP çš„æœ€é‡è¦çš„ä½œç”¨å°±æ˜¯æ ¹æ®ç«¯å£å·å°†ä¼ åˆ°ä¸»æœºçš„æ•°æ®åŒ…äº¤ä»˜ç»™æœ€ç»ˆçš„ UDP å¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UDP ä¸€èˆ¬æ¯” TCP å¿«ï¼Œä½†æ ¹æ®äº¤æ¢æ•°æ®çš„ç‰¹ç‚¹ï¼Œå…¶å·®å¼‚å¯å¤§å¯å°ã€‚è¯·ä½ è¯´æ˜ä½•ç§æƒ…å†µä¸‹ UDP çš„æ€§èƒ½ä¼˜äº TCPï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šå¦‚æœæ”¶å‘æ•°æ®é‡å°ä½†éœ€è¦é¢‘ç¹è¿æ¥æ—¶ï¼ŒUDP æ¯” TCP æ›´é«˜æ•ˆã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®¢æˆ·ç«¯ TCP å¥—æ¥å­—è°ƒç”¨ connect å‡½æ•°æ—¶è‡ªåŠ¨åˆ†é…IPå’Œç«¯å£å·ã€‚UDP ä¸­ä¸è°ƒç”¨ bind å‡½æ•°ï¼Œé‚£ä½•æ—¶åˆ†é…IPå’Œç«¯å£å·ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šåœ¨é¦–æ¬¡è°ƒç”¨ sendto å‡½æ•°æ—¶è‡ªåŠ¨ç»™ç›¸åº”çš„å¥—æ¥å­—åˆ†é…IPå’Œç«¯å£å·ã€‚è€Œä¸”æ­¤æ—¶åˆ†é…çš„åœ°å€ä¸€ç›´ä¿ç•™åˆ°ç¨‹åºç»“æŸä¸ºæ­¢ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;TCP å®¢æˆ·ç«¯å¿…é¡»è°ƒç”¨ connect å‡½æ•°ï¼Œè€Œ UDP å¯ä»¥é€‰æ‹©æ€§è°ƒç”¨ã€‚è¯·é—®ï¼Œåœ¨ UDP ä¸­è°ƒç”¨ connect å‡½æ•°æœ‰å“ªäº›å¥½å¤„ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šè¦ä¸åŒä¸€ä¸ªä¸»æœºè¿›è¡Œé•¿æ—¶é—´é€šä¿¡æ—¶ï¼Œå°† UDP å¥—æ¥å­—å˜æˆå·²è¿æ¥å¥—æ¥å­—ä¼šæé«˜æ•ˆç‡ã€‚å› ä¸ºä¸‰ä¸ªé˜¶æ®µä¸­ï¼Œç¬¬ä¸€ä¸ªé˜¶æ®µå’Œç¬¬ä¸‰ä¸ªé˜¶æ®µå ç”¨äº†ä¸€å¤§éƒ¨åˆ†æ—¶é—´ï¼Œè°ƒç”¨ connect å‡½æ•°å¯ä»¥èŠ‚çœè¿™äº›æ—¶é—´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;7.å®ç°æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯è½®æµæ”¶å‘æ¶ˆæ¯ï¼ˆä½¿ç”¨UDPï¼‰ï¼Œæ”¶å‘çš„æ¶ˆæ¯å‡è¦è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch06/homework/uchar_server.c&#34;&gt;uchar_server.c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch06/homework/uchar_client.c&#34;&gt;uchar_client.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»“æœå°±æ˜¯å’Œé¢„æœŸçš„ä¸€æ ·ï¼&lt;/p&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-6-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-udp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 5 ç«  åŸºäº TCP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯ï¼ˆ2ï¼‰ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-5-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-tcp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF2-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Thu, 24 Mar 2022 15:57:00 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-5-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-tcp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF2-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-5-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-tcp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF2-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-5-ç« -åŸºäº-tcp-çš„æœåŠ¡ç«¯å®¢æˆ·ç«¯2&#34;&gt;ç¬¬ 5 ç«  åŸºäº TCP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯ï¼ˆ2ï¼‰&lt;/h2&gt;
&lt;p&gt;ä¸Šä¸€ç« ä»…ä»…æ˜¯ä»ç¼–ç¨‹è§’åº¦å­¦ä¹ å®ç°æ–¹æ³•ï¼Œå¹¶æœªè¯¦ç»†è®¨è®º TCP çš„å·¥ä½œåŸç†ã€‚å› æ­¤ï¼Œæœ¬ç« å°†æƒ³æ¬¡è®²è§£ TCP ä¸­å¿…è¦çš„ç†è®ºçŸ¥è¯†ï¼Œè¿˜å°†ç»™å‡ºç¬¬ 4 ç« å®¢æˆ·ç«¯é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;51-å›å£°å®¢æˆ·ç«¯çš„å®Œç¾å®ç°&#34;&gt;5.1 å›å£°å®¢æˆ·ç«¯çš„å®Œç¾å®ç°&lt;/h3&gt;
&lt;h4 id=&#34;511-å›å£°æœåŠ¡å™¨æ²¡æœ‰é—®é¢˜åªæœ‰å›å£°å®¢æˆ·ç«¯æœ‰é—®é¢˜&#34;&gt;5.1.1 å›å£°æœåŠ¡å™¨æ²¡æœ‰é—®é¢˜ï¼Œåªæœ‰å›å£°å®¢æˆ·ç«¯æœ‰é—®é¢˜ï¼Ÿ&lt;/h4&gt;
&lt;p&gt;é—®é¢˜ä¸åœ¨æœåŠ¡å™¨ç«¯ï¼Œè€Œåœ¨å®¢æˆ·ç«¯ï¼Œåªçœ‹ä»£ç å¯èƒ½ä¸å¥½ç†è§£ï¼Œå› ä¸º I/O ä¸­ä½¿ç”¨äº†ç›¸åŒçš„å‡½æ•°ã€‚å…ˆå›é¡¾ä¸€ä¸‹æœåŠ¡å™¨ç«¯çš„ I/O ç›¸å…³ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;while&lt;/span&gt; ((str_len = read(clnt_sock, message, BUF_SIZE)) != &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    write(clnt_sock, message, str_len);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ¥ç€æ˜¯å®¢æˆ·ç«¯ä»£ç :&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;write(sock, message, strlen(message));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;str_len = read(sock, message, BUF_SIZE - &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;äºŒè€…éƒ½åœ¨æ‘æ¢è°ƒç”¨ read å’Œ write å‡½æ•°ã€‚å®é™…ä¸Šä¹‹å‰çš„å›å£°å®¢æˆ·ç«¯å°† 100% æ¥å—å­—èŠ‚ä¼ è¾“çš„æ•°æ®ï¼Œåªä¸è¿‡æ¥å—æ•°æ®æ—¶çš„å•ä½æœ‰äº›é—®é¢˜ã€‚æ‰©å±•å®¢æˆ·ç«¯ä»£ç å›é¡¾èŒƒå›´ï¼Œä¸‹é¢æ˜¯ï¼Œå®¢æˆ·ç«¯çš„ä»£ç :&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    fputs(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Input message(Q to quit): &amp;#34;&lt;/span&gt;, stdout);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    fgets(message, BUF_SIZE, stdin);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;if&lt;/span&gt; (!strcmp(message, &lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;q&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;) || !strcmp(message, &lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Q&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    write(sock, message, strlen(message));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    str_len = read(sock, message, BUF_SIZE - &lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    message[str_len] = &lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#cd5555&#34;&gt;&amp;#34;Message from server: %s&amp;#34;&lt;/span&gt;, message);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç°åœ¨åº”è¯¥ç†è§£äº†é—®é¢˜ï¼Œå›å£°å®¢æˆ·ç«¯ä¼ è¾“çš„æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œä¸”æ˜¯é€šè¿‡è°ƒç”¨ write å‡½æ•°ä¸€æ¬¡æ€§å‘é€çš„ã€‚ä¹‹åè¿˜è°ƒç”¨ä¸€æ¬¡ read å‡½æ•°ï¼ŒæœŸå¾…ç€æ¥å—è‡ªå·±ä¼ è¾“çš„å­—ç¬¦ä¸²ï¼Œè¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ã€‚&lt;/p&gt;
&lt;h4 id=&#34;512-å›å£°å®¢æˆ·ç«¯é—®é¢˜çš„è§£å†³åŠæ³•&#34;&gt;5.1.2 å›å£°å®¢æˆ·ç«¯é—®é¢˜çš„è§£å†³åŠæ³•&lt;/h4&gt;
&lt;p&gt;è¿™ä¸ªé—®é¢˜å…¶å®å¾ˆå®¹æ˜“è§£å†³ï¼Œå› ä¸ºå¯ä»¥æå‰æ¥å—æ•°æ®çš„å¤§å°ã€‚è‹¥ä¹‹å‰ä¼ è¾“äº†20å­—èŠ‚é•¿çš„å­—ç¬¦ä¸²ï¼Œåˆ™å†æ¥æ”¶æ—¶å¾ªç¯è°ƒç”¨ read å‡½æ•°è¯»å– 20 ä¸ªå­—èŠ‚å³å¯ã€‚æ—¢ç„¶æœ‰äº†è§£å†³åŠæ³•ï¼Œé‚£ä¹ˆä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch05/echo_client2.c&#34;&gt;echo_client2.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ ·ä¿®æ”¹ä¸ºäº†æ¥æ”¶æ‰€æœ‰ä¼ è¾“æ•°æ®è€Œå¾ªç¯è°ƒç”¨ read å‡½æ•°ã€‚æµ‹è¯•åŠè¿è¡Œç»“æœå¯å‚è€ƒç¬¬å››ç« ã€‚&lt;/p&gt;
&lt;h4 id=&#34;513-å¦‚æœé—®é¢˜ä¸åœ¨äºå›å£°å®¢æˆ·ç«¯å®šä¹‰åº”ç”¨å±‚åè®®&#34;&gt;5.1.3 å¦‚æœé—®é¢˜ä¸åœ¨äºå›å£°å®¢æˆ·ç«¯ï¼šå®šä¹‰åº”ç”¨å±‚åè®®&lt;/h4&gt;
&lt;p&gt;å›å£°å®¢æˆ·ç«¯å¯ä»¥æå‰çŸ¥é“æ¥æ”¶æ•°æ®çš„é•¿åº¦ï¼Œè¿™åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ä¸å¯èƒ½çš„ã€‚é‚£ä¹ˆæ­¤æ—¶æ— æ³•é¢„çŸ¥æ¥æ”¶æ•°æ®é•¿åº¦æ—¶åº”è¯¥å¦‚ä½•æ‰‹æ³•æ•°æ®ï¼Ÿè¿™æ˜¯éœ€è¦çš„æ˜¯&lt;strong&gt;åº”ç”¨å±‚åè®®&lt;/strong&gt;çš„å®šä¹‰ã€‚åœ¨æ”¶å‘è¿‡ç¨‹ä¸­å®šå¥½è§„åˆ™ï¼ˆåè®®ï¼‰ä»¥è¡¨ç¤ºæ•°æ®è¾¹ç•Œï¼Œæˆ–è€…æå‰å‘ŠçŸ¥éœ€è¦å‘é€çš„æ•°æ®çš„å¤§å°ã€‚æœåŠ¡ç«¯/å®¢æˆ·ç«¯å®ç°è¿‡ç¨‹ä¸­é€æ­¥å®šä¹‰çš„è§„åˆ™é›†åˆå°±æ˜¯åº”ç”¨å±‚åè®®ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å†™ä¸€ä¸ªå°ç¨‹åºæ¥ä½“éªŒåº”ç”¨å±‚åè®®çš„å®šä¹‰è¿‡ç¨‹ã€‚è¦æ±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æœåŠ¡å™¨ä»å®¢æˆ·ç«¯è·å¾—å¤šä¸ªæ•°ç»„å’Œè¿ç®—ç¬¦ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨æ¥æ”¶åˆ°æ•°å­—å€™å¯¹é½è¿›è¡ŒåŠ å‡ä¹˜è¿ç®—ï¼Œç„¶åæŠŠç»“æœä¼ å›å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¾‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‘æœåŠ¡å™¨ä¼ é€’3,5,9çš„åŒäº‹è¯·æ±‚åŠ æ³•è¿ç®—ï¼ŒæœåŠ¡å™¨è¿”å›3+5+9çš„ç»“æœ&lt;/li&gt;
&lt;li&gt;è¯·æ±‚åšä¹˜æ³•è¿ç®—ï¼Œå®¢æˆ·ç«¯ä¼šæ”¶åˆ°&lt;code&gt;3*5*9&lt;/code&gt;çš„ç»“æœ&lt;/li&gt;
&lt;li&gt;å¦‚æœå‘æœåŠ¡å™¨ä¼ é€’4,3,2çš„åŒæ—¶è¦æ±‚åšå‡æ³•ï¼Œåˆ™è¿”å›4-3-2çš„è¿ç®—ç»“æœã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¯·è‡ªå·±å®ç°ä¸€ä¸ªç¨‹åºæ¥å®ç°åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¹¦ä¸Šçš„å®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch05/op_client.c&#34;&gt;op_client.c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch05/op_server.c&#34;&gt;op_server.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é˜…è¯»ä»£ç è¦æ³¨æ„ä¸€ä¸‹ï¼Œ&lt;code&gt;int*&lt;/code&gt;ä¸&lt;code&gt;char&lt;/code&gt;ä¹‹é—´çš„è½¬æ¢ã€‚TCP ä¸­ä¸å­˜åœ¨æ•°æ®è¾¹ç•Œã€‚&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc op_client.c -o opclient
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc op_server.c -o opserver
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿è¡Œ:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./opserver &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./opclient 127.0.0.1 &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/16/5c3ea297c7649.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;52-tcp-åŸç†&#34;&gt;5.2 TCP åŸç†&lt;/h3&gt;
&lt;h4 id=&#34;521-tcp-å¥—æ¥å­—ä¸­çš„-io-ç¼“å†²&#34;&gt;5.2.1 TCP å¥—æ¥å­—ä¸­çš„ I/O ç¼“å†²&lt;/h4&gt;
&lt;p&gt;TCP å¥—æ¥å­—çš„æ•°æ®æ”¶å‘æ— è¾¹ç•Œã€‚æœåŠ¡å™¨å³ä½¿è°ƒç”¨ 1 æ¬¡ write å‡½æ•°ä¼ è¾“ 40 å­—èŠ‚çš„æ•°æ®ï¼Œå®¢æˆ·ç«¯ä¹Ÿæœ‰å¯èƒ½é€šè¿‡ 4 æ¬¡ read å‡½æ•°è°ƒç”¨æ¯æ¬¡è¯»å– 10 å­—èŠ‚ã€‚ä½†æ­¤å¤„ä¹Ÿæœ‰ä¸€äº›ç–‘é—®ï¼ŒæœåŠ¡å™¨ä¸€æ¬¡æ€§ä¼ è¾“äº† 40 å­—èŠ‚ï¼Œè€Œå®¢æˆ·ç«¯ç«Ÿç„¶å¯ä»¥ç¼“æ…¢çš„åˆ†æ‰¹æ¥å—ã€‚å®¢æˆ·ç«¯æ¥å— 10 å­—èŠ‚åï¼Œå‰©ä¸‹çš„ 30 å­—èŠ‚åœ¨ä½•å¤„ç­‰å€™å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œwrite å‡½æ•°è°ƒç”¨åå¹¶éç«‹å³ä¼ è¾“æ•°æ®ï¼Œ read å‡½æ•°è°ƒç”¨åä¹Ÿå¹¶éé©¬ä¸Šæ¥æ”¶æ•°æ®ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œwrite å‡½æ•°è°ƒç”¨ç¬é—´ï¼Œæ•°æ®å°†ç§»è‡³è¾“å‡ºç¼“å†²ï¼›read å‡½æ•°è°ƒç”¨ç¬é—´ï¼Œä»è¾“å…¥ç¼“å†²è¯»å–æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/16/5c3ea41cd93c6.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;I/O ç¼“å†²ç‰¹æ€§å¯ä»¥æ•´ç†å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I/O ç¼“å†²åœ¨æ¯ä¸ª TCP å¥—æ¥å­—ä¸­å•ç‹¬å­˜åœ¨&lt;/li&gt;
&lt;li&gt;I/O ç¼“å†²åœ¨åˆ›å»ºå¥—æ¥å­—æ—¶è‡ªåŠ¨ç”Ÿæˆ&lt;/li&gt;
&lt;li&gt;å³ä½¿å…³é—­å¥—æ¥å­—ä¹Ÿä¼šç»§ç»­ä¼ é€’è¾“å‡ºç¼“å†²ä¸­é—ç•™çš„æ•°æ®&lt;/li&gt;
&lt;li&gt;å…³é—­å¥—æ¥å­—å°†ä¸¢å¤±è¾“å…¥ç¼“å†²ä¸­çš„æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‡è®¾å‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯è¾“å…¥ç¼“å†²ä¸º 50 å­—èŠ‚ï¼Œè€ŒæœåŠ¡å™¨ç«¯ä¼ è¾“äº† 100 å­—èŠ‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å› ä¸º TCP ä¸ä¼šå‘ç”Ÿè¶…è¿‡è¾“å…¥ç¼“å†²å¤§å°çš„æ•°æ®ä¼ è¾“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ ¹æœ¬ä¸ä¼šå‘ç”Ÿè¿™ç±»é—®é¢˜ï¼Œå› ä¸º TCP ä¼šæ§åˆ¶æ•°æ®æµã€‚TCP ä¸­æœ‰æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰åè®®ï¼Œç”¨å¯¹è¯æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Aï¼šä½ å¥½ï¼Œæœ€å¤šå¯ä»¥å‘æˆ‘ä¼ é€’ 50 å­—èŠ‚&lt;/li&gt;
&lt;li&gt;Bï¼šå¥½çš„&lt;/li&gt;
&lt;li&gt;Aï¼šæˆ‘è…¾å‡ºäº† 20 å­—èŠ‚çš„ç©ºé—´ï¼Œæœ€å¤šå¯ä»¥æ¥å— 70 å­—èŠ‚&lt;/li&gt;
&lt;li&gt;Bï¼šå¥½çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ•°æ®æ”¶å‘ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå› æ­¤ TCP ä¸­ä¸ä¼šå› ä¸ºç¼“å†²æº¢å‡ºè€Œä¸¢å¤±æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;write å‡½æ•°åœ¨æ•°æ®ä¼ è¾“å®Œæˆæ—¶è¿”å›ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;522-tcp-å†…éƒ¨å·¥ä½œåŸç†-1ä¸å¯¹æ–¹å¥—æ¥å­—çš„è¿æ¥&#34;&gt;5.2.2 TCP å†…éƒ¨å·¥ä½œåŸç† 1ï¼šä¸å¯¹æ–¹å¥—æ¥å­—çš„è¿æ¥&lt;/h4&gt;
&lt;p&gt;TCP å¥—æ¥å­—ä»åˆ›å»ºåˆ°æ¶ˆå¤±æ‰€ç»è¿‡çš„è¿‡ç¨‹åˆ†ä¸ºå¦‚ä¸‹ä¸‰æ­¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯¹æ–¹å¥—æ¥å­—å»ºç«‹è¿æ¥&lt;/li&gt;
&lt;li&gt;ä¸å¯¹æ–¹å¥—æ¥å­—è¿›è¡Œæ•°æ®äº¤æ¢&lt;/li&gt;
&lt;li&gt;æ–­å¼€ä¸å¯¹æ–¹å¥—æ¥å­—çš„è¿æ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é¦–å…ˆè®²è§£ä¸å¯¹æ–¹å¥—æ¥å­—å»ºç«‹è¿æ¥çš„è¿‡ç¨‹ã€‚è¿æ¥è¿‡ç¨‹ä¸­ï¼Œå¥—æ¥å­—çš„å¯¹è¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¥—æ¥å­—Aï¼šä½ å¥½ï¼Œå¥—æ¥å­— Bã€‚æˆ‘è¿™é‡Œæœ‰æ•°æ®ç»™ä½ ï¼Œå»ºç«‹è¿æ¥å§&lt;/li&gt;
&lt;li&gt;å¥—æ¥å­—Bï¼šå¥½çš„ï¼Œæˆ‘è¿™è¾¹å·²å°±ç»ª&lt;/li&gt;
&lt;li&gt;å¥—æ¥å­—Aï¼šè°¢è°¢ä½ å—ç†æˆ‘çš„è¯·æ±‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TCP åœ¨å®é™…é€šä¿¡ä¸­ä¹Ÿä¼šç»è¿‡ä¸‰æ¬¡å¯¹è¯è¿‡ç¨‹ï¼Œå› æ­¤ï¼Œè¯¥è¿‡ç¨‹åˆè¢«ç§°ä¸º &lt;strong&gt;Three-way handshakingï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰&lt;/strong&gt;ã€‚æ¥ä¸‹æ¥ç»™å‡ºè¿æ¥è¿‡ç¨‹ä¸­å®é™…äº¤æ¢çš„ä¿¡æ¯æ–¹å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/16/5c3ecdec9fc04.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¥—æ¥å­—æ˜¯å…¨åŒå·¥æ–¹å¼å·¥ä½œçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¯ä»¥åŒå‘ä¼ é€’æ•°æ®ã€‚å› æ­¤ï¼Œæ”¶å‘æ•°æ®å‰è¦åšä¸€äº›å‡†å¤‡ã€‚é¦–å…ˆè¯·æ±‚è¿æ¥çš„ä¸»æœº A è¦ç»™ä¸»æœº B ä¼ é€’ä»¥ä¸‹ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[SYN] SEQ : 1000 , ACK:-&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¯¥æ¶ˆæ¯ä¸­çš„ SEQ ä¸º 1000 ï¼ŒACK ä¸ºç©ºï¼Œè€Œ SEQ ä¸º1000 çš„å«ä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç°åœ¨ä¼ é€’çš„æ•°æ®åŒ…çš„åºå·ä¸º 1000ï¼Œå¦‚æœæ¥æ”¶æ— è¯¯ï¼Œè¯·é€šçŸ¥æˆ‘å‘æ‚¨ä¼ é€’ 1001 å·æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ˜¯é¦–æ¬¡è¯·æ±‚è¿æ¥æ—¶ä½¿ç”¨çš„æ¶ˆæ¯ï¼Œåˆç§°ä¸º SYNã€‚SYN æ˜¯ Synchronization çš„ç®€å†™ï¼Œè¡¨ç¤ºæ”¶å‘æ•°æ®å‰ä¼ è¾“çš„åŒæ­¥æ¶ˆæ¯ã€‚æ¥ä¸‹æ¥ä¸»æœº B å‘ A ä¼ é€’ä»¥ä¸‹ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[SYN+ACK] SEQ: 2000, ACK: 1001&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ­¤æ—¶ SEQ ä¸º 2000ï¼ŒACK ä¸º 1001ï¼Œè€Œ SEQ ä¸º 2000 çš„å«ä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç°ä¼ é€’çš„æ•°æ®åŒ…å·ä¸º 2000 ï¼Œå¦‚æœæ¥å—æ— è¯¯ï¼Œè¯·é€šçŸ¥æˆ‘å‘æ‚¨ä¼ é€’ 2001 å·æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è€Œ ACK 1001 çš„å«ä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆšæ‰ä¼ è¾“çš„ SEQ ä¸º 1000 çš„æ•°æ®åŒ…æ¥å—æ— è¯¯ï¼Œç°åœ¨è¯·ä¼ é€’ SEQ ä¸º 1001 çš„æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹äºä¸»æœº A é¦–æ¬¡ä¼ è¾“çš„æ•°æ®åŒ…çš„ç¡®è®¤æ¶ˆæ¯ï¼ˆACK 1001ï¼‰å’Œä¸ºä¸»æœº B ä¼ è¾“æ•°æ®åšå‡†å¤‡çš„åŒæ­¥æ¶ˆæ¯ï¼ˆSEQ 2000ï¼‰æ†ç»‘å‘é€ã€‚å› æ­¤ï¼Œæ­¤ç§ç±»æ¶ˆæ¯åˆç§°ä¸º SYN+ACKã€‚&lt;/p&gt;
&lt;p&gt;æ”¶å‘æ•°æ®å‰å‘æ•°æ®åŒ…åˆ†é…åºå·ï¼Œå¹¶å‘å¯¹æ–¹é€šæŠ¥æ­¤åºå·ï¼Œè¿™éƒ½æ˜¯ä¸ºäº†é˜²æ­¢æ•°æ®ä¸¢å¤±åšçš„å‡†å¤‡ã€‚é€šè¿‡é¡¹æ•°æ®åŒ…åˆ†é…åºå·å¹¶ç¡®è®¤ï¼Œå¯ä»¥åœ¨æ•°æ®åŒ…ä¸¢å¤±æ—¶é©¬ä¸ŠæŸ¥çœ‹å¹¶é‡ä¼ ä¸¢å¤±çš„æ•°æ®åŒ…ã€‚å› æ­¤ TCP å¯ä»¥ä¿è¯å¯é çš„æ•°æ®ä¼ è¾“ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¿™ä¸‰ä¸ªè¿‡ç¨‹ï¼Œè¿™æ ·ä¸»æœº A å’Œä¸»æœº B å°±ç¡®è®¤äº†å½¼æ­¤å·²ç»å‡†å¤‡å°±ç»ªã€‚&lt;/p&gt;
&lt;h4 id=&#34;523-tcp-å†…éƒ¨å·¥ä½œåŸç†-2ä¸å¯¹æ–¹ä¸»æœºçš„æ•°æ®äº¤æ¢&#34;&gt;5.2.3 TCP å†…éƒ¨å·¥ä½œåŸç† 2ï¼šä¸å¯¹æ–¹ä¸»æœºçš„æ•°æ®äº¤æ¢&lt;/h4&gt;
&lt;p&gt;é€šè¿‡ç¬¬ä¸€æ­¥ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹å®Œæˆäº†æ•°æ®äº¤æ¢å‡†å¤‡ï¼Œä¸‹é¢å°±å¼€å§‹æ­£å¼æ”¶å‘æ•°æ®ï¼Œå…¶é»˜è®¤æ–¹å¼å¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/16/5c3ed1a97ce2b.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å›¾ä¸Šç»™å‡ºäº†ä¸»æœº A åˆ†æˆ 2 ä¸ªæ•°æ®åŒ…å‘ä¸»æœº B ä¼ è¾“ 200 å­—èŠ‚çš„è¿‡ç¨‹ã€‚é¦–å…ˆï¼Œä¸»æœº A é€šè¿‡ 1 ä¸ªæ•°æ®åŒ…å‘é€ 100 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œæ•°æ®åŒ…çš„ SEQ ä¸º 1200 ã€‚ä¸»æœº B ä¸ºäº†ç¡®è®¤è¿™ä¸€ç‚¹ï¼Œå‘ä¸»æœº A å‘é€ ACK 1301 æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶çš„ ACK å·ä¸º 1301 è€Œä¸æ˜¯ 1201ï¼ŒåŸå› åœ¨äº ACK å·çš„å¢é‡ä¸ºä¼ è¾“çš„æ•°æ®å­—èŠ‚æ•°ã€‚å‡è®¾æ¯æ¬¡ ACK å·ä¸åŠ ä¼ è¾“çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·è™½ç„¶å¯ä»¥ç¡®è®¤æ•°æ®åŒ…çš„ä¼ è¾“ï¼Œä½†æ— æ³•æ˜ç¡® 100 ä¸ªå­—èŠ‚å…¨éƒ½æ­£ç¡®ä¼ é€’è¿˜æ˜¯ä¸¢å¤±äº†ä¸€éƒ¨åˆ†ï¼Œæ¯”å¦‚åªä¼ é€’äº† 80 å­—èŠ‚ã€‚å› æ­¤æŒ‰ç…§å¦‚ä¸‹å…¬å¼ä¼ é€’ ACK ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ACK å· = SEQ å· + ä¼ é€’çš„å­—èŠ‚æ•° + 1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸ä¸‰æ¬¡æ¡æ‰‹åè®®ç›¸åŒï¼Œæœ€å + 1 æ˜¯ä¸ºäº†å‘ŠçŸ¥å¯¹æ–¹ä¸‹æ¬¡è¦ä¼ é€’çš„ SEQ å·ã€‚ä¸‹é¢åˆ†æä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®åŒ…ä¸¢å¤±çš„æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/16/5c3ed371187a6.png&#34; alt=&#34;&#34;&gt;&#39;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾è¡¨ç¤ºäº†é€šè¿‡ SEQ 1301 æ•°æ®åŒ…å‘ä¸»æœº B ä¼ é€’ 100 å­—èŠ‚æ•°æ®ã€‚ä½†ä¸­é—´å‘ç”Ÿäº†é”™è¯¯ï¼Œä¸»æœº B æœªæ”¶åˆ°ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œä¸»æœº A ä»ç„¶æœªæ”¶åˆ°å¯¹äº SEQ 1301 çš„ ACK çš„ç¡®è®¤ï¼Œå› æ­¤è¯•ç€é‡ä¼ è¯¥æ•°æ®åŒ…ã€‚ä¸ºäº†å®Œæˆè¯¥æ•°æ®åŒ…çš„é‡ä¼ ï¼ŒTCP å¥—æ¥å­—å¯åŠ¨è®¡æ—¶å™¨ä»¥ç­‰å¾… ACK åº”ç­”ã€‚è‹¥ç›¸åº”è®¡æ—¶å™¨å‘ç”Ÿè¶…æ—¶ï¼ˆTime-out!ï¼‰åˆ™é‡ä¼ ã€‚&lt;/p&gt;
&lt;h4 id=&#34;524-tcp-å†…éƒ¨å·¥ä½œåŸç†-3æ–­å¼€å¥—æ¥å­—çš„è¿æ¥&#34;&gt;5.2.4 TCP å†…éƒ¨å·¥ä½œåŸç† 3ï¼šæ–­å¼€å¥—æ¥å­—çš„è¿æ¥&lt;/h4&gt;
&lt;p&gt;TCP å¥—æ¥å­—çš„ç»“æŸè¿‡ç¨‹ä¹Ÿéå¸¸ä¼˜é›…ã€‚å¦‚æœå¯¹æ–¹è¿˜æœ‰æ•°æ®éœ€è¦ä¼ è¾“æ—¶ç›´æ¥æ–­æ‰è¯¥è¿æ¥ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥æ–­å¼€è¿æ¥æ—¶éœ€è¦åŒæ–¹åå•†ï¼Œæ–­å¼€è¿æ¥æ—¶åŒæ–¹çš„å¯¹è¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å¥—æ¥å­—Aï¼šæˆ‘å¸Œæœ›æ–­å¼€è¿æ¥&lt;/li&gt;
&lt;li&gt;å¥—æ¥å­—Bï¼šå“¦ï¼Œæ˜¯å—ï¼Ÿè¯·ç¨åã€‚&lt;/li&gt;
&lt;li&gt;å¥—æ¥å­—Aï¼šæˆ‘ä¹Ÿå‡†å¤‡å°±ç»ªï¼Œå¯ä»¥æ–­å¼€è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;å¥—æ¥å­—Bï¼šå¥½çš„ï¼Œè°¢è°¢åˆä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…ˆç”±å¥—æ¥å­— A å‘å¥—æ¥å­— B ä¼ é€’æ–­å¼€è¿æ¥çš„ä¿¡æ¯ï¼Œå¥—æ¥å­— B å‘å‡ºç¡®è®¤æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œç„¶åå‘å¥—æ¥å­— A ä¼ é€’å¯ä»¥æ–­å¼€è¿æ¥çš„æ¶ˆæ¯ï¼Œå¥—æ¥å­— A åŒæ ·å‘å‡ºç¡®è®¤æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/16/5c3ed7503c18c.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å›¾ä¸­æ•°æ®åŒ…å†…çš„ FIN è¡¨ç¤ºæ–­å¼€è¿æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒæ–¹å„å‘é€ 1 æ¬¡ FIN æ¶ˆæ¯åæ–­å¼€è¿æ¥ã€‚æ­¤è¿‡è¿‡ç¨‹ç»å† 4 ä¸ªé˜¶æ®µï¼Œå› æ­¤åˆç§°å››æ¬¡æ¡æ‰‹ï¼ˆFour-way handshakingï¼‰ã€‚SEQ å’Œ ACK çš„å«ä¹‰ä¸ä¹‹å‰è®²è§£çš„å†…å®¹ä¸€è‡´ï¼Œçœç•¥ã€‚å›¾ä¸­ï¼Œä¸»æœº A ä¼ é€’äº†ä¸¤æ¬¡ ACK 5001ï¼Œä¹Ÿè®¸è¿™é‡Œä¼šæœ‰å›°æƒ‘ã€‚å…¶å®ï¼Œç¬¬äºŒæ¬¡ FIN æ•°æ®åŒ…ä¸­çš„ ACK 5001 åªæ˜¯å› ä¸ºæ¥æ”¶äº† ACK æ¶ˆæ¯åæœªæ¥æ”¶åˆ°çš„æ•°æ®é‡ä¼ çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;53-åŸºäº-windows-çš„å®ç°&#34;&gt;5.3 åŸºäº Windows çš„å®ç°&lt;/h3&gt;
&lt;p&gt;æš‚ç•¥&lt;/p&gt;
&lt;h3 id=&#34;54-ä¹ é¢˜&#34;&gt;5.4 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯·è¯´æ˜ TCP å¥—æ¥å­—è¿æ¥è®¾ç½®çš„ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚å°¤å…¶æ˜¯ 3 æ¬¡æ•°æ®äº¤æ¢è¿‡ç¨‹æ¯æ¬¡æ”¶å‘çš„æ•°æ®å†…å®¹ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šTCPå¥—æ¥å­—çš„ç”Ÿå‘½å‘¨æœŸä¸»è¦å¯åˆ†ä¸º3ä¸ªéƒ¨åˆ†: â‘ ä¸å¯¹æ–¹å¥—æ¥å­—å»ºç«‹è¿æ¥ â‘¡ä¸å¯¹æ–¹å¥—æ¥å­—è¿›è¡Œæ•°æ®äº¤æ¢ â‘¢æ–­å¼€ä¸å¯¹æ–¹å¥—æ¥å­—çš„è¿æ¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…¶ä¸­,åœ¨ç¬¬ä¸€æ­¥å»ºç«‹è¿æ¥çš„é˜¶æ®µ,åˆå¯ç»†åˆ†ä¸º3ä¸ªæ­¥éª¤(å³&lt;code&gt;ä¸‰æ¬¡æ¡æ‰‹&lt;/code&gt;)ï¼šâ‘ ç”±ä¸»æœº1ç»™ä¸»æœº2å‘é€åˆå§‹çš„SEQï¼Œé¦–æ¬¡è¿æ¥è¯·æ±‚æ˜¯å…³é”®å­—æ˜¯SYNï¼Œè¡¨ç¤ºæ”¶å‘æ•°æ®å‰åŒæ­¥ä¼ è¾“çš„æ¶ˆæ¯,æ­¤æ—¶æŠ¥æ–‡çš„ACKä¸€èˆ¬ä¸ºç©ºã€‚â‘¡ä¸»æœº2æ”¶åˆ°æŠ¥æ–‡ä»¥åï¼Œç»™ä¸»æœº 1 ä¼ é€’ä¿¡æ¯ï¼Œç”¨ä¸€ä¸ªæ–°çš„SEQè¡¨ç¤ºè‡ªå·±çš„åºå·ï¼Œç„¶åACKä»£è¡¨å·²ç»æ¥å—åˆ°ä¸»æœº1çš„æ¶ˆæ¯ï¼Œå¸Œæœ›æ¥å—ä¸‹ä¸€ä¸ªæ¶ˆæ¯â‘¢ä¸»æœº1æ”¶åˆ°ä¸»æœº2çš„ç¡®è®¤ä»¥åï¼Œè¿˜éœ€è¦ç»™ä¸»æœº2ç»™å‡ºç¡®è®¤ï¼Œæ­¤æ—¶å†å‘é€ä¸€æ¬¡SEQå’ŒACKã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;TCP æ˜¯å¯é çš„æ•°æ®ä¼ è¾“åè®®ï¼Œä½†åœ¨é€šè¿‡ç½‘ç»œé€šä¿¡çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¸¢å¤±æ•°æ®ã€‚è¯·é€šè¿‡ ACK å’Œ SEQ è¯´æ˜ TCP é€šè¿‡å’Œä½•ç§æœºåˆ¶ä¿è¯ä¸¢å¤±æ•°æ®çš„å¯é ä¼ è¾“ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šé€šè¿‡è¶…æ—¶é‡ä¼ æœºåˆ¶æ¥ä¿è¯ï¼Œå¦‚æœæŠ¥æ–‡å‘å‡ºå»çš„ç‰¹å®šæ—¶é—´å†…ï¼Œå‘é€æ¶ˆæ¯çš„ä¸»æœºæ²¡æœ‰æ”¶åˆ°å¦ä¸€ä¸ªä¸»æœºçš„å›å¤ï¼Œé‚£ä¹ˆå°±ç»§ç»­å‘é€è¿™æ¡æ¶ˆæ¯ï¼Œç›´åˆ°æ”¶åˆ°å›å¤ä¸ºæ­¢ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;TCP å¥—æ¥å­—ä¸­è°ƒç”¨ write å’Œ read å‡½æ•°æ—¶æ•°æ®å¦‚ä½•ç§»åŠ¨ï¼Ÿç»“åˆ I/O ç¼“å†²è¿›è¡Œè¯´æ˜ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šTCP å¥—æ¥å­—è°ƒç”¨ write å‡½æ•°æ—¶ï¼Œæ•°æ®å°†ç§»è‡³è¾“å‡ºç¼“å†²ï¼Œåœ¨é€‚å½“çš„æ—¶å€™ï¼Œä¼ åˆ°å¯¹æ–¹è¾“å…¥ç¼“å†²ã€‚è¿™æ—¶å¯¹æ–¹å°†è°ƒç”¨ read å‡½æ•°ä»è¾“å…¥ç¼“å†²ä¸­è¯»å–æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯¹æ–¹ä¸»æœºçš„è¾“å…¥ç¼“å†²å‰©ä½™ 50 å­—èŠ‚ç©ºé—´æ—¶ï¼Œè‹¥æœ¬ä¸»æœºé€šè¿‡ write å‡½æ•°è¯·æ±‚ä¼ è¾“ 70 å­—èŠ‚ï¼Œè¯·é—® TCP å¦‚ä½•å¤„ç†è¿™ç§æƒ…å†µï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šTCP ä¸­æœ‰æ»‘åŠ¨çª—å£æ§åˆ¶åè®®ï¼Œæ‰€ä»¥ä¼ è¾“çš„æ—¶å€™ä¼šä¿è¯ä¼ è¾“çš„å­—èŠ‚æ•°å°äºç­‰äºè‡ªå·±èƒ½æ¥å—çš„å­—èŠ‚æ•°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-5-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-tcp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF2-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
    
        <item>
        <title>ã€ŠTCP/IPç½‘ç»œç¼–ç¨‹ã€‹ç¬¬ 4 ç«  åŸºäº TCP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯ï¼ˆ1ï¼‰ ç¬”è®°</title>
        <link>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-4-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-tcp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF1-%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Sun, 20 Mar 2022 13:10:00 +0800</pubDate>
        
        <guid>https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-4-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-tcp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF1-%E7%AC%94%E8%AE%B0/</guid>
        <description>ğŸŒ€Jarson Cai&#39;s Blog https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-4-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-tcp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF1-%E7%AC%94%E8%AE%B0/ -&lt;h2 id=&#34;ç¬¬-4-ç« -åŸºäº-tcp-çš„æœåŠ¡ç«¯å®¢æˆ·ç«¯1&#34;&gt;ç¬¬ 4 ç«  åŸºäº TCP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯ï¼ˆ1ï¼‰&lt;/h2&gt;
&lt;h3 id=&#34;41-ç†è§£-tcp-å’Œ-udp&#34;&gt;4.1 ç†è§£ TCP å’Œ UDP&lt;/h3&gt;
&lt;p&gt;æ ¹æ®æ•°æ®ä¼ è¾“æ–¹å¼çš„ä¸åŒï¼ŒåŸºäºç½‘ç»œåè®®çš„å¥—æ¥å­—ä¸€èˆ¬åˆ†ä¸º TCP å¥—æ¥å­—å’Œ UDP å¥—æ¥å­—ã€‚å› ä¸º TCP å¥—æ¥å­—æ˜¯é¢å‘è¿æ¥çš„ï¼Œå› æ­¤åˆè¢«ç§°ä¸ºåŸºäºæµï¼ˆstreamï¼‰çš„å¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;p&gt;TCP æ˜¯ Transmission Control Protocol ï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰çš„ç®€å†™ï¼Œæ„ä¸ºã€Œå¯¹æ•°æ®ä¼ è¾“è¿‡ç¨‹çš„æ§åˆ¶ã€ã€‚å› æ­¤ï¼Œå­¦ä¹ æ§åˆ¶æ–¹æ³•åŠèŒƒå›´æœ‰åŠ©äºæ­£ç¡®ç†è§£ TCP å¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;h4 id=&#34;411-tcpip-åè®®æ ˆ&#34;&gt;4.1.1 TCP/IP åè®®æ ˆ&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/14/5c3c21889db06.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;TCP/IP åè®®æ ˆå…±åˆ†ä¸º 4 å±‚ï¼Œå¯ä»¥ç†è§£ä¸ºæ•°æ®æ”¶å‘åˆ†æˆäº† 4 ä¸ªå±‚æ¬¡åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡å±‚æ¬¡åŒ–çš„æ–¹å¼æ¥è§£å†³é—®é¢˜&lt;/p&gt;
&lt;h4 id=&#34;412-é“¾è·¯å±‚&#34;&gt;4.1.2 é“¾è·¯å±‚&lt;/h4&gt;
&lt;p&gt;é“¾è·¯å±‚æ˜¯ç‰©ç†é“¾æ¥é¢†åŸŸæ ‡å‡†åŒ–çš„ç»“æœï¼Œä¹Ÿæ˜¯æœ€åŸºæœ¬çš„é¢†åŸŸï¼Œä¸“é—¨å®šä¹‰LANã€WANã€MANç­‰ç½‘ç»œæ ‡å‡†ã€‚è‹¥ä¸¤å°ä¸»æœºé€šè¿‡ç½‘ç»œè¿›è¡Œæ•°æ®äº¤æ¢ï¼Œåˆ™éœ€è¦ç‰©ç†è¿æ¥ï¼Œé“¾è·¯å±‚å°±è´Ÿè´£è¿™äº›æ ‡å‡†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;413-ip-å±‚&#34;&gt;4.1.3 IP å±‚&lt;/h4&gt;
&lt;p&gt;è½¬å¤‡å¥½ç‰©ç†è¿æ¥å€™å°±è¦ä¼ è¾“æ•°æ®ã€‚ä¸ºäº†å†å¤æ‚ç½‘ç»œä¸­ä¼ è¾“æ•°æ®ï¼Œé¦–å…ˆè¦è€ƒè™‘è·¯å¾„çš„é€‰æ‹©ã€‚å‘ç›®æ ‡ä¼ è¾“æ•°æ®éœ€è¦ç»è¿‡å“ªæ¡è·¯å¾„ï¼Ÿè§£å†³æ­¤é—®é¢˜çš„å°±æ˜¯IPå±‚ï¼Œè¯¥å±‚ä½¿ç”¨çš„åè®®å°±æ˜¯IPã€‚&lt;/p&gt;
&lt;p&gt;IP æ˜¯é¢å‘æ¶ˆæ¯çš„ã€ä¸å¯é çš„åè®®ã€‚æ¯æ¬¡ä¼ è¾“æ•°æ®æ—¶ä¼šå¸®æˆ‘ä»¬é€‰æ‹©è·¯å¾„ï¼Œä½†å¹¶ä¸ä¸€è‡´ã€‚å¦‚æœä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œåˆ™é€‰æ‹©å…¶ä»–è·¯å¾„ï¼Œä½†æ˜¯å¦‚æœå‘ç”Ÿæ•°æ®ä¸¢å¤±æˆ–é”™è¯¯ï¼Œåˆ™æ— æ³•è§£å†³ã€‚æ¢è¨€ä¹‹ï¼ŒIPåè®®æ— æ³•åº”å¯¹æ•°æ®é”™è¯¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;414-tcpudp-å±‚&#34;&gt;4.1.4 TCP/UDP å±‚&lt;/h4&gt;
&lt;p&gt;IP å±‚è§£å†³æ•°æ®ä¼ è¾“ä¸­çš„è·¯å¾„é€‰æ‹©é—®é¢˜ï¼Œç§©åºç…§æ­¤è·¯å¾„ä¼ è¾“æ•°æ®å³å¯ã€‚TCP å’Œ UDP å±‚ä»¥ IP å±‚æä¾›çš„è·¯å¾„ä¿¡æ¯ä¸ºåŸºç¡€å®Œæˆå®é™…çš„æ•°æ®ä¼ è¾“ï¼Œæ•…è¯¥å±‚åˆç§°ä¸ºä¼ è¾“å±‚ã€‚UDP æ¯” TCP ç®€å•ï¼Œç°åœ¨æˆ‘ä»¬åªè§£é‡Š TCP ã€‚ TCP å¯ä»¥ä¿è¯æ•°æ®çš„å¯é ä¼ è¾“ï¼Œä½†æ˜¯å®ƒå‘é€æ•°æ®æ—¶ä»¥ IP å±‚ä¸ºåŸºç¡€ï¼ˆè¿™ä¹Ÿæ˜¯åè®®æ ˆå±‚æ¬¡åŒ–çš„åŸå› ï¼‰&lt;/p&gt;
&lt;p&gt;IP å±‚åªå…³æ³¨ä¸€ä¸ªæ•°æ®åŒ…ï¼ˆæ•°æ®ä¼ è¾“åŸºæœ¬å•ä½ï¼‰çš„ä¼ è¾“è¿‡ç¨‹ã€‚å› æ­¤ï¼Œå³ä½¿ä¼ è¾“å¤šä¸ªæ•°æ®åŒ…ï¼Œæ¯ä¸ªæ•°æ®åŒ…ä¹Ÿæ˜¯ç”± IP å±‚å®é™…ä¼ è¾“çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ è¾“é¡ºåºåŠä¼ è¾“æœ¬èº«æ˜¯ä¸å¯é çš„ã€‚è‹¥åªåˆ©ç”¨IPå±‚ä¼ è¾“æ•°æ®ï¼Œåˆ™å¯èƒ½å¯¼è‡´åä¼ è¾“çš„æ•°æ®åŒ…Bæ¯”å…ˆä¼ è¾“çš„æ•°æ®åŒ…Aææ—©åˆ°è¾¾ã€‚å¦å¤–ï¼Œä¼ è¾“çš„æ•°æ®åŒ…Aã€Bã€Cä¸­å¯èƒ½åªæ”¶åˆ°Aå’ŒCï¼Œç”šè‡³æ”¶åˆ°çš„Cå¯èƒ½å·²ç»æŸæ¯ ã€‚åä¹‹ï¼Œè‹¥æ·»åŠ  TCP åè®®åˆ™æŒ‰ç…§å¦‚ä¸‹å¯¹è¯æ–¹å¼è¿›è¡Œæ•°æ®äº¤æ¢ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸»æœºAï¼šæ­£ç¡®æ¥å—ç¬¬äºŒä¸ªæ•°æ®åŒ…&lt;/p&gt;
&lt;p&gt;ä¸»æœºBï¼šæ©ï¼ŒçŸ¥é“äº†&lt;/p&gt;
&lt;p&gt;ä¸»æœºAï¼šæ­£ç¡®æ”¶åˆ°ç¬¬ä¸‰ä¸ªæ•°æ®åŒ…&lt;/p&gt;
&lt;p&gt;ä¸»æœºBï¼šå¯æˆ‘å·²ç»å‘é€ç¬¬å››ä¸ªæ•°æ®åŒ…äº†å•Šï¼å“¦ï¼Œæ‚¨æ²¡æ”¶åˆ°å§ï¼Œæˆ‘ç»™ä½ é‡æ–°å‘ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™å°±æ˜¯ TCP çš„ä½œç”¨ã€‚å¦‚æœäº¤æ¢æ•°æ®çš„è¿‡ç¨‹ä¸­å¯ä»¥ç¡®è®¤å¯¹æ–¹å·²ç»æ”¶åˆ°æ•°æ®ï¼Œå¹¶é‡ä¼ ä¸¢å¤±çš„æ•°æ®ï¼Œé‚£ä¹ˆå³ä¾¿IPå±‚ä¸ä¿è¯æ•°æ®ä¼ è¾“ï¼Œè¿™ç±»é€šä¿¡ä¹Ÿæ˜¯å¯é çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/14/5c3c268b40be6.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;415-åº”ç”¨å±‚&#34;&gt;4.1.5 åº”ç”¨å±‚&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿°å†…å®¹æ˜¯å¥—æ¥å­—é€šä¿¡è¿‡ç¨‹ä¸­è‡ªåŠ¨å¤„ç†çš„ã€‚é€‰æ‹©æ•°æ®ä¼ è¾“è·¯å¾„ã€æ•°æ®ç¡®è®¤è¿‡ç¨‹éƒ½è¢«éšè—åˆ°å¥—æ¥å­—å†…éƒ¨ã€‚å‘ç¨‹åºå‘˜æä¾›çš„å·¥å…·å°±æ˜¯å¥—æ¥å­—ï¼Œåªéœ€è¦åˆ©ç”¨å¥—æ¥å­—ç¼–å‡ºç¨‹åºå³å¯ã€‚ç¼–å†™è½¯ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ ¹æ®ç¨‹åºçš„ç‰¹ç‚¹æ¥å†³å®šæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„æ•°æ®ä¼ è¾“è§„åˆ™ï¼Œè¿™ä¾¿æ˜¯åº”ç”¨å±‚åè®®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;42-å®ç°åŸºäº-tcp-çš„æœåŠ¡å™¨å®¢æˆ·ç«¯&#34;&gt;4.2 å®ç°åŸºäº TCP çš„æœåŠ¡å™¨/å®¢æˆ·ç«¯&lt;/h3&gt;
&lt;h4 id=&#34;421-tcp-æœåŠ¡ç«¯çš„é»˜è®¤å‡½æ•°çš„è°ƒç”¨ç¨‹åº&#34;&gt;4.2.1 TCP æœåŠ¡ç«¯çš„é»˜è®¤å‡½æ•°çš„è°ƒç”¨ç¨‹åº&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/14/5c3c2782a7810.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;è°ƒç”¨ socket å‡½æ•°åˆ›å»ºå¥—æ¥å­—ï¼Œå£°æ˜å¹¶åˆå§‹åŒ–åœ°å€ä¿¡æ¯çš„ç»“æ„ä½“å˜é‡ï¼Œè°ƒç”¨ bind å‡½æ•°å‘å¥—æ¥å­—åˆ†é…åœ°å€ã€‚&lt;/p&gt;
&lt;h4 id=&#34;422-è¿›å…¥ç­‰å¾…è¿æ¥è¯·æ±‚çŠ¶æ€&#34;&gt;4.2.2 è¿›å…¥ç­‰å¾…è¿æ¥è¯·æ±‚çŠ¶æ€&lt;/h4&gt;
&lt;p&gt;å·²ç»è°ƒç”¨äº† bind å‡½æ•°ç»™ä»–è¦å€Ÿèµ„åˆ†é…åœ°å€ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦é€šè¿‡è°ƒç”¨ listen å‡½æ•°è¿›å…¥ç­‰å¾…é“¾æ¥è¯·æ±‚çŠ¶æ€ã€‚åªæœ‰è°ƒç”¨äº† listen å‡½æ•°ï¼Œå®¢æˆ·ç«¯æ‰èƒ½è¿›å…¥å¯å‘å‡ºè¿æ¥è¯·æ±‚çš„çŠ¶æ€ã€‚æ¢è¨€ä¹‹ï¼Œè¿™æ—¶å®¢æˆ·ç«¯æ‰èƒ½è°ƒç”¨ connect å‡½æ•°&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;listen&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sockfd, &lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; backlog);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;//æˆåŠŸæ—¶è¿”å›0ï¼Œå¤±è´¥æ—¶è¿”å›-1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;//sock: å¸Œæœ›è¿›å…¥ç­‰å¾…è¿æ¥è¯·æ±‚çŠ¶æ€çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ï¼Œä¼ é€’çš„æè¿°ç¬¦å¥—æ¥å­—å‚æ•°ç§°ä¸ºæœåŠ¡ç«¯å¥—æ¥å­—
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;//backlog: è¿æ¥è¯·æ±‚ç­‰å¾…é˜Ÿåˆ—çš„é•¿åº¦ï¼Œè‹¥ä¸º5ï¼Œåˆ™é˜Ÿåˆ—é•¿åº¦ä¸º5ï¼Œè¡¨ç¤ºæœ€å¤šä½¿5ä¸ªè¿æ¥è¯·æ±‚è¿›å…¥é˜Ÿåˆ—            
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;423-å—ç†å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚&#34;&gt;4.2.3 å—ç†å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚&lt;/h4&gt;
&lt;p&gt;è°ƒç”¨ listen å‡½æ•°åï¼Œåˆ™åº”è¯¥æŒ‰åºå—ç†ã€‚å—ç†è¯·æ±‚æ„å‘³ç€å¯æ¥å—æ•°æ®çš„çŠ¶æ€ã€‚è¿›å…¥è¿™ç§çŠ¶æ€æ‰€éœ€çš„éƒ¨ä»¶æ˜¯&lt;strong&gt;å¥—æ¥å­—&lt;/strong&gt;ï¼Œä½†æ˜¯æ­¤æ—¶ä½¿ç”¨çš„ä¸æ˜¯æœåŠ¡ç«¯å¥—æ¥å­—ï¼Œæ­¤æ—¶éœ€è¦å¦ä¸€ä¸ªå¥—æ¥å­—ï¼Œä½†æ˜¯æ²¡å¿…è¦äº²è‡ªåˆ›å»ºï¼Œä¸‹é¢çš„å‡½æ•°å°†è‡ªåŠ¨åˆ›å»ºå¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;accept&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sockfd, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sockaddr *addr, socklen_t *addrlen);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥æ—¶è¿”å›-1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;sock: æœåŠ¡ç«¯å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;addr: ä¿å­˜å‘èµ·è¿æ¥è¯·æ±‚çš„å®¢æˆ·ç«¯åœ°å€ä¿¡æ¯çš„å˜é‡åœ°å€å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;addrlen: çš„ç¬¬äºŒä¸ªå‚æ•°addrç»“æ„ä½“çš„é•¿åº¦ï¼Œä½†æ˜¯å­˜æ”¾æœ‰é•¿åº¦çš„å˜é‡åœ°å€ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;sccept å‡½æ•°å—ç†è¿æ¥è¯·æ±‚é˜Ÿåˆ—ä¸­å¾…å¤„ç†çš„å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚ã€‚å‡½æ•°è°ƒç”¨æˆåŠŸåï¼Œaccept å†…éƒ¨å°†äº§ç”Ÿç”¨äºæ•°æ® I/O çš„å¥—æ¥å­—ï¼Œå¹¶è¿”å›å…¶æ–‡ä»¶æè¿°ç¬¦ã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯å¥—æ¥å­—æ˜¯è‡ªåŠ¨åˆ›å»ºçš„ï¼Œå¹¶è‡ªåŠ¨ä¸å‘èµ·è¿æ¥è¯·æ±‚çš„å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ã€‚&lt;/p&gt;
&lt;h4 id=&#34;424-å›é¡¾-hello-world-æœåŠ¡ç«¯&#34;&gt;4.2.4 å›é¡¾ Hello World æœåŠ¡ç«¯&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç ï¼š&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch04/hello_server.c&#34;&gt;hello_server.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‡æ–°æ•´ç†ä¸€ä¸‹ä»£ç çš„æ€è·¯&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æœåŠ¡ç«¯å®ç°è¿‡ç¨‹ä¸­é¦–å…ˆè¦åˆ›å»ºå¥—æ¥å­—ï¼Œæ­¤æ—¶çš„å¥—æ¥å­—å¹¶éæ˜¯çœŸæ­£çš„æœåŠ¡ç«¯å¥—æ¥å­—&lt;/li&gt;
&lt;li&gt;ä¸ºäº†å®Œæˆå¥—æ¥å­—åœ°å€çš„åˆ†é…ï¼Œåˆå§‹åŒ–ç»“æ„ä½“å˜é‡å¹¶è°ƒç”¨ bind å‡½æ•°ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒç”¨ listen å‡½æ•°è¿›å…¥ç­‰å¾…è¿æ¥è¯·æ±‚çŠ¶æ€ã€‚è¿æ¥è¯·æ±‚çŠ¶æ€é˜Ÿåˆ—çš„é•¿åº¦è®¾ç½®ä¸º5.æ­¤æ—¶çš„å¥—æ¥å­—æ‰æ˜¯æœåŠ¡ç«¯å¥—æ¥å­—ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒç”¨ accept å‡½æ•°ä»é˜Ÿå¤´å– 1 ä¸ªè¿æ¥è¯·æ±‚ä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œå¹¶è¿”å›åˆ›å»ºçš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ã€‚å¦å¤–ï¼Œè°ƒç”¨ accept å‡½æ•°æ—¶è‹¥ç­‰å¾…é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™ accept å‡½æ•°ä¸ä¼šè¿”å›ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­å‡ºç°æ–°çš„å®¢æˆ·ç«¯è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒç”¨ write å‡½æ•°å‘å®¢æˆ·ç«¯ä¼ é€æ•°æ®ï¼Œè°ƒç”¨ close å…³é—­è¿æ¥&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;425-tcp-å®¢æˆ·ç«¯çš„é»˜è®¤å‡½æ•°è°ƒç”¨é¡ºåº&#34;&gt;4.2.5 TCP å®¢æˆ·ç«¯çš„é»˜è®¤å‡½æ•°è°ƒç”¨é¡ºåº&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/14/5c3c31d77e86c.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸æœåŠ¡ç«¯ç›¸æ¯”ï¼ŒåŒºåˆ«å°±åœ¨äºã€Œè¯·æ±‚è¿æ¥ã€ï¼Œä»–æ˜¯åˆ›å»ºå®¢æˆ·ç«¯å¥—æ¥å­—åå‘æœåŠ¡ç«¯å‘èµ·çš„è¿æ¥è¯·æ±‚ã€‚æœåŠ¡ç«¯è°ƒç”¨ listen å‡½æ•°ååˆ›å»ºè¿æ¥è¯·æ±‚ç­‰å¾…é˜Ÿåˆ—ï¼Œä¹‹åå®¢æˆ·ç«¯å³å¯è¯·æ±‚è¿æ¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#1e889b&#34;&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#1e889b&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#008b45&#34;&gt;connect&lt;/span&gt;(&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;int&lt;/span&gt; sock, &lt;span style=&#34;color:#8b008b;font-weight:bold&#34;&gt;struct&lt;/span&gt; sockaddr *servaddr, socklen_t addrlen);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;æˆåŠŸæ—¶è¿”å›0ï¼Œå¤±è´¥è¿”å›-1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;sock:å®¢æˆ·ç«¯å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;servaddr: ä¿å­˜ç›®æ ‡æœåŠ¡å™¨ç«¯åœ°å€ä¿¡æ¯çš„å˜é‡åœ°å€å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;addrlen: ä»¥å­—èŠ‚ä¸ºå•ä½ä¼ é€’ç»™ç¬¬äºŒä¸ªç»“æ„ä½“å‚æ•° servaddr çš„å˜é‡åœ°å€é•¿åº¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å®¢æˆ·ç«¯è°ƒç”¨ connect å‡½æ•°å€™ï¼Œå‘ç”Ÿä»¥ä¸‹å‡½æ•°ä¹‹ä¸€æ‰ä¼šè¿”å›ï¼ˆå®Œæˆå‡½æ•°è°ƒç”¨ï¼‰:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡ç«¯æ¥å—è¿æ¥è¯·æ±‚&lt;/li&gt;
&lt;li&gt;å‘ç”Ÿæ–­ç½‘ç­‰ä¸€åœºçŠ¶å†µè€Œä¸­æ–­è¿æ¥è¯·æ±‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨æ„ï¼š&lt;strong&gt;æ¥å—è¿æ¥&lt;/strong&gt;ä¸ä»£è¡¨æœåŠ¡ç«¯è°ƒç”¨ accept å‡½æ•°ï¼Œå…¶å®åªæ˜¯æœåŠ¡å™¨ç«¯æŠŠè¿æ¥è¯·æ±‚ä¿¡æ¯è®°å½•åˆ°ç­‰å¾…é˜Ÿåˆ—ã€‚å› æ­¤ connect å‡½æ•°è¿”å›åå¹¶ä¸åº”è¯¥ç«‹å³è¿›è¡Œæ•°æ®äº¤æ¢ã€‚&lt;/p&gt;
&lt;h4 id=&#34;426-å›é¡¾-hello-world-å®¢æˆ·ç«¯&#34;&gt;4.2.6 å›é¡¾ Hello World å®¢æˆ·ç«¯&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç ï¼š&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch04/hello_client.c&#34;&gt;hello_client.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‡æ–°ç†è§£è¿™ä¸ªç¨‹åºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºå‡†å¤‡è¿æ¥æœåŠ¡å™¨çš„å¥—æ¥å­—ï¼Œæ­¤æ—¶åˆ›å»ºçš„æ˜¯ TCP å¥—æ¥å­—&lt;/li&gt;
&lt;li&gt;ç»“æ„ä½“å˜é‡ serv_addr ä¸­åˆå§‹åŒ–IPå’Œç«¯å£ä¿¡æ¯ã€‚åˆå§‹åŒ–å€¼ä¸ºç›®æ ‡æœåŠ¡å™¨ç«¯å¥—æ¥å­—çš„IPå’Œç«¯å£ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒç”¨ connect å‡½æ•°å‘æœåŠ¡ç«¯å‘èµ·è¿æ¥è¯·æ±‚&lt;/li&gt;
&lt;li&gt;å®Œæˆè¿æ¥åï¼Œæ¥æ”¶æœåŠ¡ç«¯ä¼ è¾“çš„æ•°æ®&lt;/li&gt;
&lt;li&gt;æ¥æ”¶æ•°æ®åè°ƒç”¨ close å‡½æ•°å…³é—­å¥—æ¥å­—ï¼Œç»“æŸä¸æœåŠ¡å™¨ç«¯çš„è¿æ¥ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;427-åŸºäº-tcp-çš„æœåŠ¡ç«¯å®¢æˆ·ç«¯å‡½æ•°è°ƒç”¨å…³ç³»&#34;&gt;4.2.7 åŸºäº TCP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯å‡½æ•°è°ƒç”¨å…³ç³»&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/14/5c3c35a773b8c.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å…³ç³»å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;h3 id=&#34;43-å®ç°è¿­ä»£æœåŠ¡ç«¯å®¢æˆ·ç«¯&#34;&gt;4.3 å®ç°è¿­ä»£æœåŠ¡ç«¯/å®¢æˆ·ç«¯&lt;/h3&gt;
&lt;p&gt;ç¼–å†™ä¸€ä¸ªå›å£°ï¼ˆechoï¼‰æœåŠ¡å™¨/å®¢æˆ·ç«¯ã€‚é¡¾åæ€ä¹‰ï¼ŒæœåŠ¡ç«¯å°†å®¢æˆ·ç«¯ä¼ è¾“çš„å­—ç¬¦ä¸²æ•°æ®åŸå°ä¸åŠ¨çš„ä¼ å›å®¢æˆ·ç«¯ï¼Œå°±åƒå›å£°ä¸€æ ·ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦è§£é‡Šä¸€ä¸‹è¿­ä»£æœåŠ¡å™¨ç«¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;431-å®ç°è¿­ä»£æœåŠ¡å™¨ç«¯&#34;&gt;4.3.1 å®ç°è¿­ä»£æœåŠ¡å™¨ç«¯&lt;/h4&gt;
&lt;p&gt;åœ¨ Hello World çš„ä¾‹å­ä¸­ï¼Œç­‰å¾…é˜Ÿåˆ—çš„ä½œç”¨æ²¡æœ‰å¤ªå¤§æ„ä¹‰ã€‚å¦‚æœæƒ³ç»§ç»­å¤„ç†å¥½åé¢çš„å®¢æˆ·ç«¯è¯·æ±‚åº”è¯¥æ€æ ·æ‰©å±•ä»£ç ï¼Ÿæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æ’å…¥å¾ªç¯åå¤è°ƒç”¨ accept å‡½æ•°ï¼Œå¦‚å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.loli.net/2019/01/15/5c3d3c8a283ad.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œè°ƒç”¨ accept å‡½æ•°åï¼Œç´§æ¥ç€è°ƒç”¨ I/O ç›¸å…³çš„ read write å‡½æ•°ï¼Œç„¶åè°ƒç”¨ close å‡½æ•°ã€‚è¿™å¹¶éé’ˆå¯¹æœåŠ¡å™¨å¥—æ¥å­—ï¼Œè€Œæ˜¯é’ˆå¯¹ accept å‡½æ•°è°ƒç”¨æ—¶åˆ›å»ºçš„å¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;h4 id=&#34;432-è¿­ä»£å›å£°æœåŠ¡å™¨ç«¯å®¢æˆ·ç«¯&#34;&gt;4.3.2 è¿­ä»£å›å£°æœåŠ¡å™¨ç«¯/å®¢æˆ·ç«¯&lt;/h4&gt;
&lt;p&gt;ç¨‹åºè¿è¡Œçš„åŸºæœ¬æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨ç«¯åœ¨åŒä¸€æ—¶åˆ»åªä¸ä¸€ä¸ªå®¢æˆ·ç«¯ç›¸è¿ï¼Œå¹¶æä¾›å›å£°æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ç«¯ä¾æ¬¡å‘ 5 ä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡å¹¶é€€å‡ºã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯æ¥å—ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²å¹¶å‘é€åˆ°æœåŠ¡å™¨ç«¯ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ç«¯å°†æ¥å—çš„å­—ç¬¦ä¸²æ•°æ®ä¼ å›å®¢æˆ·ç«¯ï¼Œå³ã€Œå›å£°ã€&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„å­—ç¬¦ä¸²å›å£°ä¸€ç›´æ‰§è¡Œåˆ°å®¢æˆ·ç«¯è¾“å…¥ Q ä¸ºæ­¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„ä»£ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch04/echo_server.c&#34;&gt;echo_server.c&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caixiongjiang/TCPIP/blob/master/ch04/echo_client.c&#34;&gt;echo_client.c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼–è¯‘:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc echo_client.c -o eclient
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc echo_server.c -o eserver
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åˆ†åˆ«è¿è¡Œ:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./eserver &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./eclient 127.0.0.1 &lt;span style=&#34;color:#b452cd&#34;&gt;9190&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿‡ç¨‹å’Œç»“æœï¼š&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªæœåŠ¡ç«¯å¼€å¯åï¼Œç”¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£å¼€å¯å®¢æˆ·ç«¯ï¼Œç„¶åç¨‹åºä¼šè®©ä½ è¾“å…¥å­—ç¬¦ä¸²ï¼Œç„¶åå®¢æˆ·ç«¯è¾“å…¥ä»€ä¹ˆå­—ç¬¦ä¸²ï¼Œå®¢æˆ·ç«¯å°±ä¼šè¿”å›ä»€ä¹ˆå­—ç¬¦ä¸²ï¼ŒæŒ‰ q é€€å‡ºã€‚è¿™æ—¶æœåŠ¡ç«¯çš„è¿è¡Œå¹¶æ²¡æœ‰ç»“æŸï¼ŒæœåŠ¡ç«¯ä¸€å…±è¦å¤„ç† 5 ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ï¼Œæ‰€ä»¥å¦å¤–å¼€å¤šä¸ªç»ˆç«¯çª—å£åŒæ—¶å¼€å¯å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨æŒ‰ç…§é¡ºåºè¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;server:
&lt;img src=&#34;https://i.loli.net/2019/01/15/5c3d523d0a675.png&#34; alt=&#34;server.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;client:
&lt;img src=&#34;https://i.loli.net/2019/01/15/5c3d523d336e7.png&#34; alt=&#34;client.png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;433-å›å£°å®¢æˆ·ç«¯å­˜åœ¨çš„é—®é¢˜&#34;&gt;4.3.3 å›å£°å®¢æˆ·ç«¯å­˜åœ¨çš„é—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä»¥ä¸Šä»£ç æœ‰ä¸€ä¸ªå‡è®¾ã€Œæ¯æ¬¡è°ƒç”¨ readã€writeå‡½æ•°æ—¶éƒ½ä¼šä»¥å­—ç¬¦ä¸²ä¸ºå•ä½æ‰§è¡Œå®é™… I/O æ“ä½œã€&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ã€Œç¬¬äºŒç« ã€ä¸­è¯´è¿‡ã€ŒTCP ä¸å­˜åœ¨æ•°æ®è¾¹ç•Œã€ï¼Œä¸Šè¿°å®¢æˆ·ç«¯æ˜¯åŸºäº TCP çš„ï¼Œå› æ­¤å¤šæ¬¡è°ƒç”¨ write å‡½æ•°ä¼ é€’çš„å­—ç¬¦ä¸²æœ‰å¯èƒ½ä¸€æ¬¡æ€§ä¼ é€’åˆ°æœåŠ¡ç«¯ã€‚æ­¤æ—¶å®¢æˆ·ç«¯æœ‰å¯èƒ½ä»æœåŠ¡ç«¯æ”¶åˆ°å¤šä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚è¿˜éœ€è¦è€ƒè™‘æœåŠ¡å™¨çš„å¦‚ä¸‹æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;ã€Œå­—ç¬¦ä¸²å¤ªé•¿ï¼Œéœ€è¦åˆ† 2 ä¸ªåŒ…å‘é€ï¼ã€&lt;/p&gt;
&lt;p&gt;æœåŠ¡ç«¯å¸Œæœ›é€šè¿‡è°ƒç”¨ 1 æ¬¡ write å‡½æ•°ä¼ è¾“æ•°æ®ï¼Œä½†æ˜¯å¦‚æœæ•°æ®å¤ªå¤§ï¼Œæ“ä½œç³»ç»Ÿå°±æœ‰å¯èƒ½æŠŠæ•°æ®åˆ†æˆå¤šä¸ªæ•°æ®åŒ…å‘é€åˆ°å®¢æˆ·ç«¯ã€‚å¦å¤–ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å¯èƒ½åœ¨å°šæœªæ”¶åˆ°å…¨éƒ¨æ•°æ®åŒ…æ—¶å°±è°ƒç”¨ read å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šçš„é—®é¢˜éƒ½æ˜¯æºè‡ª TCP çš„ä¼ è¾“ç‰¹æ€§ï¼Œè§£å†³æ–¹æ³•åœ¨ç¬¬ 5 ç« ã€‚&lt;/p&gt;
&lt;h3 id=&#34;44-åŸºäº-windows-çš„å®ç°&#34;&gt;4.4 åŸºäº Windows çš„å®ç°&lt;/h3&gt;
&lt;p&gt;æš‚ç•¥&lt;/p&gt;
&lt;h3 id=&#34;45-ä¹ é¢˜&#34;&gt;4.5 ä¹ é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œä¸ä¸€å®šæ˜¯æ­£ç¡®ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯·ä½ è¯´æ˜ TCP/IP çš„ 4 å±‚åè®®æ ˆï¼Œå¹¶è¯´æ˜ TCP å’Œ UDP å¥—æ¥å­—ç»è¿‡çš„å±‚çº§ç»“æ„å·®å¼‚ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šTCP/IP çš„å››å±‚åè®®åˆ†ä¸ºï¼šåº”ç”¨å±‚ã€TCP/UDP å±‚ã€IPå±‚ã€é“¾è·¯å±‚ã€‚å·®å¼‚æ˜¯ä¸€ä¸ªç»è¿‡ TCP å±‚ï¼Œä¸€ä¸ªç»è¿‡ UDP å±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯·è¯´å‡º TCP/IP åè®®æ ˆä¸­é“¾è·¯å±‚å’ŒIPå±‚çš„ä½œç”¨ï¼Œå¹¶ç»™å‡ºäºŒè€…å…³ç³»&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šé“¾è·¯å±‚æ˜¯ç‰©ç†é“¾æ¥é¢†åŸŸæ ‡å‡†åŒ–çš„ç»“æœï¼Œä¸“é—¨å®šä¹‰ç½‘ç»œæ ‡å‡†ã€‚è‹¥ä¸¤å°ä¸»æœºé€šè¿‡ç½‘ç»œè¿›è¡Œæ•°æ®äº¤æ¢ï¼Œåˆ™é¦–å…ˆè¦åšåˆ°çš„å°±æ˜¯è¿›è¡Œç‰©ç†é“¾æ¥ã€‚IPå±‚ï¼šä¸ºäº†åœ¨å¤æ‚çš„ç½‘ç»œä¸­ä¼ è¾“æ•°æ®ï¼Œé¦–å…ˆéœ€è¦è€ƒè™‘è·¯å¾„çš„é€‰æ‹©ã€‚å…³ç³»ï¼šé“¾è·¯å±‚è´Ÿè´£è¿›è¡Œä¸€ç³»åˆ—ç‰©ç†è¿æ¥ï¼Œè€ŒIPå±‚è´Ÿè´£é€‰æ‹©æ­£ç¡®å¯è¡Œçš„ç‰©ç†è·¯å¾„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºä½•éœ€è¦æŠŠ TCP/IP åè®®æ ˆåˆ†æˆ 4 å±‚ï¼ˆæˆ–7å±‚ï¼‰ï¼Ÿå¼€æ”¾å¼å›ç­”ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šARPANET çš„ç ”åˆ¶ç»éªŒè¡¨æ˜ï¼Œå¯¹äºå¤æ‚çš„è®¡ç®—æœºç½‘ç»œåè®®ï¼Œå…¶ç»“æ„åº”è¯¥æ˜¯å±‚æ¬¡å¼çš„ã€‚åˆ†å†Œçš„å¥½å¤„ï¼šâ‘ éš”å±‚ä¹‹é—´æ˜¯ç‹¬ç«‹çš„â‘¡çµæ´»æ€§å¥½â‘¢ç»“æ„ä¸Šå¯ä»¥åˆ†éš”å¼€â‘£æ˜“äºå®ç°å’Œç»´æŠ¤â‘¤èƒ½ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®¢æˆ·ç«¯è°ƒç”¨ connect å‡½æ•°å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚ã€‚æœåŠ¡å™¨ç«¯è°ƒç”¨å“ªä¸ªå‡½æ•°åï¼Œå®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨ connect å‡½æ•°ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šæœåŠ¡ç«¯è°ƒç”¨ listen å‡½æ•°åï¼Œå®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨ connect å‡½æ•°ã€‚å› ä¸ºï¼ŒæœåŠ¡ç«¯è°ƒç”¨ listen å‡½æ•°åï¼ŒæœåŠ¡ç«¯å¥—æ¥å­—æ‰æœ‰èƒ½åŠ›æ¥å—è¯·æ±‚è¿æ¥çš„ä¿¡å·ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»€ä¹ˆæ—¶å€™åˆ›å»ºè¿æ¥è¯·æ±‚ç­‰å¾…é˜Ÿåˆ—ï¼Ÿå®ƒæœ‰ä½•ç§ä½œç”¨ï¼Ÿä¸ accept æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šæœåŠ¡ç«¯è°ƒç”¨ listen å‡½æ•°åï¼Œacceptå‡½æ•°æ­£åœ¨å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œ æ›´å¤šçš„å®¢æˆ·ç«¯å‘æ¥äº†è¯·æ±‚è¿æ¥çš„æ•°æ®ï¼Œæ­¤æ—¶ï¼Œå°±éœ€è¦åˆ›å»ºè¿æ¥è¯·æ±‚ç­‰å¾…é˜Ÿåˆ—ã€‚ä»¥ä¾¿äºåœ¨acceptå‡½æ•°å¤„ç†å®Œæ‰‹å¤´çš„è¯·æ±‚ä¹‹åï¼ŒæŒ‰ç…§æ­£ç¡®çš„é¡ºåºå¤„ç†åé¢æ­£åœ¨æ’é˜Ÿçš„å…¶ä»–è¯·æ±‚ã€‚ä¸acceptå‡½æ•°çš„å…³ç³»ï¼šacceptå‡½æ•°å—ç†è¿æ¥è¯·æ±‚ç­‰å¾…é˜Ÿåˆ—ä¸­å¾…å¤„ç†çš„å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®¢æˆ·ç«¯ä¸­ä¸ºä½•ä¸éœ€è¦è°ƒç”¨ bind å‡½æ•°åˆ†é…åœ°å€ï¼Ÿå¦‚æœä¸è°ƒç”¨ bind å‡½æ•°ï¼Œé‚£ä½•æ—¶ã€å¦‚ä½•å‘å¥—æ¥å­—åˆ†é…IPåœ°å€å’Œç«¯å£å·ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç­”ï¼šåœ¨è°ƒç”¨ connect å‡½æ•°æ—¶åˆ†é…äº†åœ°å€ï¼Œå®¢æˆ·ç«¯IPåœ°å€å’Œç«¯å£åœ¨è°ƒç”¨ connect å‡½æ•°æ—¶è‡ªåŠ¨åˆ†é…ï¼Œæ— éœ€è°ƒç”¨æ ‡è®°çš„ bind å‡½æ•°è¿›è¡Œåˆ†é…ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
- https://caixiongjiang.github.io/blog/2022/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/tcp-ip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%AC%AC-4-%E7%AB%A0-%E5%9F%BA%E4%BA%8E-tcp-%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF1-%E7%AC%94%E8%AE%B0/ - </description>
        </item>
    
    
  </channel>
</rss> 